<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content='A package for population size estimation based on single-source capture-recapture methods using zero-truncated, zero-one truncated and zero-truncated one-inflated Poisson, Geometric and Negative Binomial regression as well as Zeltermans and Chaos regression. Package includes point and interval estimators for the population size with variances estimated using analytical or bootstrap method. Details can be found in: van der Heijden et al. (2003) &lt;doi:10.1191/1471082X03st057oa&gt;, B{\"o}hning and van der Heijden (2019) &lt;doi:10.1214/18-AOAS1232&gt;, B{\"o}hning et al. (2020) Capture-Recapture Methods for the Social and Medical Sciences or B{\"o}hning and Friedl (2021) &lt;doi:10.1007/s10260-021-00556-8&gt;.'>
<title>A package for single-source capture-recapture models • singleRcapture</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="A package for single-source capture-recapture models">
<meta property="og:description" content='A package for population size estimation based on single-source capture-recapture methods using zero-truncated, zero-one truncated and zero-truncated one-inflated Poisson, Geometric and Negative Binomial regression as well as Zeltermans and Chaos regression. Package includes point and interval estimators for the population size with variances estimated using analytical or bootstrap method. Details can be found in: van der Heijden et al. (2003) &lt;doi:10.1191/1471082X03st057oa&gt;, B{\"o}hning and van der Heijden (2019) &lt;doi:10.1214/18-AOAS1232&gt;, B{\"o}hning et al. (2020) Capture-Recapture Methods for the Social and Medical Sciences or B{\"o}hning and Friedl (2021) &lt;doi:10.1007/s10260-021-00556-8&gt;.'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">singleRcapture</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ncn-foreigners/singleRcapture/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h1></div>
<!-- badges: start -->

<p>Capture-recapture type experiments are used to estimate the total population size in situations when observing only a part of such population is feasible. In recent years these types of experiments have seen more interest.</p>
<p>Single source models are distinct from other capture-recapture models because we cannot estimate the population size based on how many units were observed in two or three sources which is the standard approach.</p>
<p>Instead in single source models we utilise count data regression models on positive distributions (i.e. on counts greater than 0) where the dependent variable is the number of times a particular unit was observed in source data.</p>
<p>This package aims to implement already existing and introduce new methods of estimating population size from single source to simplify the research process.</p>
<p>Currently we’ve implemented most of the frequentist approaches used in literature such as:</p>
<ul>
<li>Zero truncated poisson, geometric and negative binomial regression.</li>
<li>Zero truncated one inflated and one inflated zero truncated poisson and gemetric models. (Negative binomial is currently in development.)</li>
<li>Zero one truncated poisson geometric and negative binomial models.</li>
<li>Generalised Chao and Zelterman’s models based on logistic regression.</li>
<li>Three types of bootstrap parametric, semi-parametric and non parametric.</li>
<li>And a wide range of additional functionalities associated with (vector) generalised linear models relevant to the topic.</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of singleRcapture from <a href="https://github.com/ncn-foreigners/singleRcapture" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ncn-foreigners/singleRcapture"</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>The main function of this package is <code>estimatePopsize</code> which fitts regression on specified distribution and then uses fitted regression to estimate the population size.</p>
<p>Lets look at a model from 2003 publication : Point and interval estimation of the population size using the truncated Poisson regression model Heijden, Peter GM van der et al. The call to <code>estimatePopsize</code> will look very simmilar to anyone who used the <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ncn-foreigners/singleRcapture" class="external-link">singleRcapture</a></span><span class="op">)</span>
<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimatePopsize.html">estimatePopsize</a></span><span class="op">(</span>
  formula <span class="op">=</span> <span class="va">capture</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">nation</span> <span class="op">+</span> <span class="va">reason</span>, <span class="co"># specify formula</span>
  data <span class="op">=</span> <span class="va">netherlandsimmigrant</span>,
  popVar <span class="op">=</span> <span class="st">"analytic"</span>, <span class="co"># specify </span>
  model <span class="op">=</span> <span class="st">"ztpoisson"</span>, <span class="co"># distribution used</span>
  method <span class="op">=</span> <span class="st">"IRLS"</span> <span class="co"># fitting method one of three currently supported</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="co"># a summary method for singleR class with standard glm-like output and population size estimation resutls</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; estimatePopsize(formula = capture ~ gender + age + nation + reason, </span>
<span class="co">#&gt;     data = netherlandsimmigrant, model = "ztpoisson", method = "IRLS", </span>
<span class="co">#&gt;     popVar = "analytic")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Pearson Residuals:</span>
<span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="co">#&gt; -0.488779 -0.486085 -0.297859  0.002075 -0.210439 13.921578 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; -----------------------</span>
<span class="co">#&gt; For linear predictors associated with: lambda </span>
<span class="co">#&gt;                      Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)          -1.33179    0.25486  -5.226 1.74e-07 ***</span>
<span class="co">#&gt; gendermale            0.39741    0.16305   2.437 0.014796 *  </span>
<span class="co">#&gt; age&gt;40yrs            -0.97463    0.40824  -2.387 0.016969 *  </span>
<span class="co">#&gt; nationAsia           -1.09241    0.30164  -3.622 0.000293 ***</span>
<span class="co">#&gt; nationNorth Africa    0.18997    0.19400   0.979 0.327471    </span>
<span class="co">#&gt; nationRest of Africa -0.91129    0.30097  -3.028 0.002463 ** </span>
<span class="co">#&gt; nationSurinam        -2.33665    1.01357  -2.305 0.021146 *  </span>
<span class="co">#&gt; nationTurkey         -1.67453    0.60291  -2.777 0.005479 ** </span>
<span class="co">#&gt; reasonOther reason   -0.01093    0.16153  -0.068 0.946048    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; AIC: 1714.896</span>
<span class="co">#&gt; BIC: 1764.747</span>
<span class="co">#&gt; Residual deviance: 1128.549</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Log-likelihood: -848.4481 on 1871 Degrees of freedom </span>
<span class="co">#&gt; Number of iterations: 8</span>
<span class="co">#&gt; -----------------------</span>
<span class="co">#&gt; Population size estimation results: </span>
<span class="co">#&gt; Point estimate 12691.45</span>
<span class="co">#&gt; Observed proportion: 14.8% (N obs = 1880)</span>
<span class="co">#&gt; Std. Error 2809.508</span>
<span class="co">#&gt; 95% CI for the population size:</span>
<span class="co">#&gt;           lowerBound upperBound</span>
<span class="co">#&gt; normal      7184.917   18197.99</span>
<span class="co">#&gt; logNormal   8430.749   19723.38</span>
<span class="co">#&gt; 95% CI for the share of observed population:</span>
<span class="co">#&gt;           lowerBound upperBound</span>
<span class="co">#&gt; normal     10.330814   26.16592</span>
<span class="co">#&gt; logNormal   9.531836   22.29932</span></code></pre></div>
<p>We implemented a method for <code>plot</code> function to visualise the model fit and other usefull diagnostic information. One of which is <code>rootogram</code>, a type of plot that compares fitted and observed marginal frequencies:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, plotType <span class="op">=</span> <span class="st">"rootogram"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-plot-1.png" width="75%"></p>
<p>The possible values for <code>plotType</code> argument are:</p>
<ul>
<li>
<code>qq</code> - the normal quantile-quantile plot for pearson residuals.</li>
<li>
<code>marginal</code> - a <code>matplot</code> comparing fitted and observed marginal frequencies.</li>
<li>
<code>fitresid</code> - plot of linear predictor values contrasted with pearson residuals.</li>
<li>
<code>bootHist</code> - histogram of bootstrap sample.</li>
<li>
<code>rootogram</code> - rootogram, example presented above.</li>
<li>
<code>dfpopContr</code> - contrasting two deletion effects to identify presence of influential observations.</li>
<li>
<code>dfpopBox</code> - boxplot of results from dfpopsize function see its documentation.</li>
<li>
<code>scaleLoc</code> - scale-location plot.</li>
<li>
<code>cooks</code> - plot of <code>cooks.values</code> for distributions for which it is defined.</li>
<li>
<code>hatplot</code> - plot of <code>hatvalues</code>.</li>
<li>
<code>strata</code> - plot of confidence intervals for selected su populations.</li>
</ul>
<p>a user can also pass arguments to specify additional information such as plot title, subtitle etc. similar to calling <code>plot</code> on some data. For more info check <code>plot.singleR</code> method documentation.</p>
<p>As we have seen there are some significant differences between fitted and observed marginal frequencies. To check our intuition let’s perform goodness of fit test between fitted and observed marginal frequencies.</p>
<p>To do it we call a <code>summary</code> function of <code>marginalFreq</code> function which computes marginal frequencies for the fitted <code>singleR</code> class object:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="reference/marginalFreq.html">marginalFreq</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">2</span>, dropl5 <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span>
<span class="co">#&gt; Test for Goodness of fit of a regression model:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                  Test statistics df P(&gt;X^2)</span>
<span class="co">#&gt; Chi-squared test           50.06  2 1.4e-11</span>
<span class="co">#&gt; G-test                     34.31  2 3.6e-08</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -------------------------------------------------------------- </span>
<span class="co">#&gt; Cells with fitted frequencies of &lt; 5 have been grouped </span>
<span class="co">#&gt; Names of cells used in calculating test(s) statistic: 1 2 3</span></code></pre></div>
<p>Finally let us check if we have any influential observations. We will do this by comparing the deletion effect of every observation on population size estimate by removing it entirely from the model (from population size estimate and regression) and by only omitting it in pop size estimation (this is what is called the contribution of an observation). If observation is not influential these two actions should have the approximately the same effect:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, plotType <span class="op">=</span> <span class="st">"dfpopContr"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="75%"></p>
<p>it is easy to deduce from the plot above that we have influential observations in our dataset (one in particular).</p>
<p>Lastly <code>singleRcapture</code> offers some posthoc procedures for example a function <code>stratifyPopsize</code> that estimates sizes of user specified sub populations and returns them in a <code>data.frame</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/stratifyPopsize.html">stratifyPopsize</a></span><span class="op">(</span><span class="va">model</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.01</span>, <span class="fl">.02</span>, <span class="fl">.03</span>, <span class="fl">.05</span><span class="op">)</span>, <span class="co"># different significance level for each sub population</span>
    stratas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    <span class="st">"Females from Surinam"</span> <span class="op">=</span> <span class="va">netherlandsimmigrant</span><span class="op">$</span><span class="va">gender</span> <span class="op">==</span> <span class="st">"female"</span> <span class="op">&amp;</span> <span class="va">netherlandsimmigrant</span><span class="op">$</span><span class="va">nation</span> <span class="op">==</span> <span class="st">"Surinam"</span>,
    <span class="st">"Males from Turkey"</span> <span class="op">=</span> <span class="va">netherlandsimmigrant</span><span class="op">$</span><span class="va">gender</span> <span class="op">==</span> <span class="st">"male"</span> <span class="op">&amp;</span> <span class="va">netherlandsimmigrant</span><span class="op">$</span><span class="va">nation</span> <span class="op">==</span> <span class="st">"Turkey"</span>,
    <span class="st">"Younger males"</span> <span class="op">=</span> <span class="va">netherlandsimmigrant</span><span class="op">$</span><span class="va">gender</span> <span class="op">==</span> <span class="st">"male"</span> <span class="op">&amp;</span> <span class="va">netherlandsimmigrant</span><span class="op">$</span><span class="va">age</span> <span class="op">==</span> <span class="st">"&lt;40yrs"</span>,
    <span class="st">"Older males"</span> <span class="op">=</span> <span class="va">netherlandsimmigrant</span><span class="op">$</span><span class="va">gender</span> <span class="op">==</span> <span class="st">"male"</span> <span class="op">&amp;</span> <span class="va">netherlandsimmigrant</span><span class="op">$</span><span class="va">age</span> <span class="op">==</span> <span class="st">"&gt;40yrs"</span>
<span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   Observed Estimated ObservedPercentage  StdError normalLowerBound</span>
<span class="co">#&gt; 1       20   932.371           2.145069  956.1229     -1530.438420</span>
<span class="co">#&gt; 2       78  1291.514           6.039425  741.1843      -432.738939</span>
<span class="co">#&gt; 3     1391  7337.175          18.958251 1281.9295      4555.271881</span>
<span class="co">#&gt; 4       91  1542.882           5.898055  782.2326         9.733753</span>
<span class="co">#&gt;   normalUpperBound logNormalLowerBound logNormalUpperBound                 name</span>
<span class="co">#&gt; 1         3395.180            119.3464            8398.972 Females from Surinam</span>
<span class="co">#&gt; 2         3015.766            405.4748            4574.882    Males from Turkey</span>
<span class="co">#&gt; 3        10119.078           5135.1856           10834.174        Younger males</span>
<span class="co">#&gt; 4         3076.029            630.7808            3996.215          Older males</span>
<span class="co">#&gt;   confLevel</span>
<span class="co">#&gt; 1      0.01</span>
<span class="co">#&gt; 2      0.02</span>
<span class="co">#&gt; 3      0.03</span>
<span class="co">#&gt; 4      0.05</span></code></pre></div>
<p><code>stratas</code> argument may be specified in various ways for example:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/stratifyPopsize.html">stratifyPopsize</a></span><span class="op">(</span><span class="va">model</span>, stratas <span class="op">=</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">/</span> <span class="va">age</span><span class="op">)</span>
<span class="co">#&gt;   Observed Estimated ObservedPercentage  StdError normalLowerBound</span>
<span class="co">#&gt; 1      398 3811.3954          10.442370 1154.7825      1548.063241</span>
<span class="co">#&gt; 2     1482 8880.0563          16.689083 1812.6286      5327.369600</span>
<span class="co">#&gt; 3      378 3169.5475          11.925992  881.2932      1442.244687</span>
<span class="co">#&gt; 4     1391 7337.1748          18.958251 1281.9295      4824.639108</span>
<span class="co">#&gt; 5       20  641.8478           3.116003  408.1451      -158.101825</span>
<span class="co">#&gt; 6       91 1542.8815           5.898055  782.2326         9.733753</span>
<span class="co">#&gt;   normalUpperBound logNormalLowerBound logNormalUpperBound</span>
<span class="co">#&gt; 1         6074.727           2188.5341            6905.147</span>
<span class="co">#&gt; 2        12432.743           6090.8584           13357.226</span>
<span class="co">#&gt; 3         4896.850           1903.7278            5485.554</span>
<span class="co">#&gt; 4         9849.710           5306.6899           10420.570</span>
<span class="co">#&gt; 5         1441.797            212.4088            2029.756</span>
<span class="co">#&gt; 6         3076.029            630.7808            3996.215</span>
<span class="co">#&gt;                     name confLevel</span>
<span class="co">#&gt; 1         gender==female      0.05</span>
<span class="co">#&gt; 2           gender==male      0.05</span>
<span class="co">#&gt; 3 genderfemale:age&lt;40yrs      0.05</span>
<span class="co">#&gt; 4   gendermale:age&lt;40yrs      0.05</span>
<span class="co">#&gt; 5 genderfemale:age&gt;40yrs      0.05</span>
<span class="co">#&gt; 6   gendermale:age&gt;40yrs      0.05</span></code></pre></div>
<p><code>singleRcapture</code> package also includes the option to estimate standard error of population size estimate by bootstrap and common non standard argument such as significance levels different from usual 5%:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">modelInflated</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimatePopsize.html">estimatePopsize</a></span><span class="op">(</span>
    formula <span class="op">=</span> <span class="va">capture</span> <span class="op">~</span> <span class="va">nation</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">age</span>,
    data <span class="op">=</span> <span class="va">netherlandsimmigrant</span>,
    popVar <span class="op">=</span> <span class="st">"bootstrap"</span>,
    model <span class="op">=</span> <span class="st">"oiztgeom"</span>,
    method <span class="op">=</span> <span class="st">"IRLS"</span>,
    controlMethod <span class="op">=</span> <span class="fu"><a href="reference/controlMethod.html">controlMethod</a></span><span class="op">(</span>stepsize <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>, <span class="co"># control parameters for regression fitting check documentation of controlMethod</span>
    controlPopVar <span class="op">=</span> <span class="fu"><a href="reference/controlPopVar.html">controlPopVar</a></span><span class="op">(</span> <span class="co"># control parameters for population size estimation check documentation of controlPopVar</span>
        B <span class="op">=</span> <span class="fl">1250</span>, <span class="co"># number of boostrap samples</span>
        alpha <span class="op">=</span> <span class="fl">.01</span>, <span class="co"># significance level </span>
        bootType <span class="op">=</span> <span class="st">"semiparametric"</span> <span class="co"># type of bootstrap see documentation for estimatePopsize</span>
    <span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modelInflated</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; estimatePopsize(formula = capture ~ nation + gender + age, data = netherlandsimmigrant, </span>
<span class="co">#&gt;     model = "oiztgeom", method = "IRLS", popVar = "bootstrap", </span>
<span class="co">#&gt;     controlMethod = controlMethod(stepsize = 0.2), controlPopVar = controlPopVar(B = 1250, </span>
<span class="co">#&gt;         alpha = 0.01, bootType = "semiparametric"))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Pearson Residuals:</span>
<span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="co">#&gt; -0.416300 -0.416300 -0.292541  0.004086 -0.188313 13.733512 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; -----------------------</span>
<span class="co">#&gt; For linear predictors associated with: lambda </span>
<span class="co">#&gt;                      Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)           -1.5518     0.2395  -6.480 9.19e-11 ***</span>
<span class="co">#&gt; nationAsia            -0.8294     0.2573  -3.224  0.00126 ** </span>
<span class="co">#&gt; nationNorth Africa     0.2082     0.1854   1.123  0.26147    </span>
<span class="co">#&gt; nationRest of Africa  -0.6800     0.2578  -2.638  0.00834 ** </span>
<span class="co">#&gt; nationSurinam         -1.5370     0.6403  -2.401  0.01637 *  </span>
<span class="co">#&gt; nationTurkey          -1.1880     0.4336  -2.740  0.00614 ** </span>
<span class="co">#&gt; gendermale             0.3145     0.1466   2.145  0.03194 *  </span>
<span class="co">#&gt; age&gt;40yrs             -0.6692     0.3116  -2.148  0.03171 *  </span>
<span class="co">#&gt; -----------------------</span>
<span class="co">#&gt; For linear predictors associated with: omega </span>
<span class="co">#&gt;             Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)  -2.2241     0.4556  -4.882 1.05e-06 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; AIC: 1676.961</span>
<span class="co">#&gt; BIC: 1726.813</span>
<span class="co">#&gt; Residual deviance: 941.3779</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Log-likelihood: -829.4807 on 3751 Degrees of freedom </span>
<span class="co">#&gt; Number of iterations: 52</span>
<span class="co">#&gt; -----------------------</span>
<span class="co">#&gt; Population size estimation results: </span>
<span class="co">#&gt; Point estimate 7559.606</span>
<span class="co">#&gt; Observed proportion: 24.9% (N obs = 1880)</span>
<span class="co">#&gt; Boostrap sample skewness: 0.3109832</span>
<span class="co">#&gt; 0 skewness is expected for normally distributed vairable</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Bootstrap Std. Error 3194.534</span>
<span class="co">#&gt; 99% CI for the population size:</span>
<span class="co">#&gt; lowerBound upperBound </span>
<span class="co">#&gt;   4517.296  18967.029 </span>
<span class="co">#&gt; 99% CI for the share of observed population:</span>
<span class="co">#&gt; lowerBound upperBound </span>
<span class="co">#&gt;   9.911937  41.617818</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">modelInflated</span>, plotType <span class="op">=</span> <span class="st">"bootHist"</span>, labels <span class="op">=</span> <span class="cn">TRUE</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">300</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="75%"></p>
<p>and for models with more than one distribution parameter we allow all parameters to be covariate dependent for exapmle if we wish to modify the model above:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">modelInflated2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimatePopsize.html">estimatePopsize</a></span><span class="op">(</span>
    formula <span class="op">=</span> <span class="va">capture</span> <span class="op">~</span> <span class="va">nation</span>  <span class="op">+</span> <span class="va">age</span>,
    data <span class="op">=</span> <span class="va">netherlandsimmigrant</span>,
    popVar <span class="op">=</span> <span class="st">"bootstrap"</span>,
    model <span class="op">=</span> <span class="st">"oiztgeom"</span>,
    method <span class="op">=</span> <span class="st">"IRLS"</span>,
    controlMethod <span class="op">=</span> <span class="fu"><a href="reference/controlMethod.html">controlMethod</a></span><span class="op">(</span>stepsize <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>,
    controlPopVar <span class="op">=</span> <span class="fu"><a href="reference/controlPopVar.html">controlPopVar</a></span><span class="op">(</span>
        B <span class="op">=</span> <span class="fl">1250</span>,
        alpha <span class="op">=</span> <span class="fl">.01</span>,
        bootType <span class="op">=</span> <span class="st">"semiparametric"</span>,
        covType <span class="op">=</span> <span class="st">"Fisher"</span> <span class="co"># use fisher information matrix to construct cross covariance matrix instead of observed information matrix</span>
    <span class="op">)</span>,
    controlModel <span class="op">=</span> <span class="fu"><a href="reference/controlModel.html">controlModel</a></span><span class="op">(</span>omegaFormula <span class="op">=</span> <span class="op">~</span> <span class="va">gender</span><span class="op">)</span> <span class="co"># put covariates on omega i.e. the inflation parameter</span>
<span class="op">)</span>
<span class="co">#&gt; Warning in estimatePopsize(formula = capture ~ nation + age, data = netherlandsimmigrant, : The (analytically computed) hessian of the score function is not negative define.</span>
<span class="co">#&gt; NOTE: Second derivative test failing does not necessarily mean that the maximum of score function that was found numericaly is invalid since R^k is not a bounded space.</span>
<span class="co">#&gt; Additionally in one inflated and hurdle models second derivative test often fails even on valid arguments.</span></code></pre></div>
<p>the results are significantly different (the warning issued concerns the second derivative test for existence of local minimum, here it was inconclusive but we manually checked that fitting process found the optimal regression coefficients it’s here to provide more information to the user):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">modelInflated2</span>, plotType <span class="op">=</span> <span class="st">"bootHist"</span>, labels <span class="op">=</span> <span class="cn">TRUE</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">220</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="75%"></p>
<p>and information criteria support the second model:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">" First model: AIC = "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">modelInflated</span><span class="op">)</span>, <span class="st">" BIC = "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">modelInflated</span><span class="op">)</span>,
    <span class="st">"\nSecond model: AIC = "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">modelInflated2</span><span class="op">)</span>, <span class="st">" BIC = "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">modelInflated2</span><span class="op">)</span>, <span class="st">"\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="co">#&gt;  First model: AIC = 1676.961 BIC = 1726.813</span>
<span class="co">#&gt; Second model: AIC = 1675.318 BIC = 1725.169</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="funding">Funding<a class="anchor" aria-label="anchor" href="#funding"></a>
</h2>
<p>Work on this package is supported by the the National Science Center, OPUS 22 grant no. 2020/39/B/HS4/00941.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ncn-foreigners/singleRcapture/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ncn-foreigners/singleRcapture/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing singleRcapture</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Piotr Chlebicki <br><small class="roles"> Author, maintainer </small>  </li>
<li>Maciej Beręsewicz <br><small class="roles"> Author, contributor </small> <a href="https://orcid.org/0000-0002-8281-4301" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ncn-foreigners/singleRcapture/actions" class="external-link"><img src="https://github.com/ncn-foreigners/singleRcapture/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/ncn-foreigners/singleRcapture?branch=main" class="external-link"><img src="https://codecov.io/gh/ncn-foreigners/singleRcapture/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Piotr Chlebicki, Maciej Beręsewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
