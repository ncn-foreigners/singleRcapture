[{"path":"https://ncn-foreigners.github.io/singleRcapture/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 singleRcapture authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (â€œSoftwareâ€), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED â€œâ€, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"sec-introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"Population size estimation methodological approach employed across multiple scientific disciplines, serves basis research, policy formulation, decision-making processes (cf. BÃ¶hning, Bunge, Heijden 2018). field statistics, particularly official statistics, precise population estimates essential order develop robust economic models, optimize resource allocation, inform evidence-based policy (cf. Baffour, King, Valente 2013). Social scientists utilize advanced population estimation techniques investigate hard--reach populations, homeless individuals illicit drug users effort overcome inherent limitations conventional census methodologies. techniques crucial obtaining accurate data populations typically -represented difficult access using traditional sampling methods (cf. Vincent Thompson 2022). ecology epidemiology, researchers focus estimating size individual species disease-affected populations within defined geographical regions part conservation efforts, ecosystem management, public health interventions. Population size estimation can approached using various methodologies, distinct advantages limitations. Traditional approaches include full enumeration (e.g.Â censuses) comprehensive sample surveys, , providing detailed data, often resource-intensive may result delayed estimates, particularly human populations. Alternative methods leverage existing data sources, administrative registers carefully designed small-scale studies wildlife research, census coverage surveys (cf. Wolter 1986; Zhang 2019). Information sources often extracted applying statistical methods, known capture-recapture multiple system estimation, rely data multiple enumerations population (cf. Dunne Zhang 2024). approach can implemented using either single source repeated observations, two sources, multiple sources. paper focus methods involve single data source multiple enumerations units (cf. Heijden et al. 2003). human population studies, data can derived police records, health system databases, border control logs; case non-human populations, data kind can come veterinary records specialized field data. methods often applied estimate hard--reach hidden populations, standard sampling methods may inappropriate prohibitive costs problems identifying population members. methods two sources implemented various open-source software packages, instance CARE-4 (Yang Chao 2006) (GAUSS), Rcapture (Baillargeon Rivest 2007), marked (Laake et al. 2013) VGAM (Thomas W. Yee, Stoklosa, Huggins 2015) (R), single-source capture-recapture (SSCR) methods either available partially implemented existing R packages software. Therefore, paper attempts bridge gap introducing singleRcapture package, implement state---art SSCR methods offer user friendly API resembling existing R functions (e.g., glm). next subsection describe existing R packages software used estimating population size using SSCR methods.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"sec-software","dir":"Articles","previous_headings":"Introduction","what":"Software for capture-recapture with a single source","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"majority SSCR methods assume zero-truncated distributions extensions (e.g., inclusion one-inflation). Distributions.jl (BesanÃ§on et al. 2021) (Julia), StatsModels (Seabold Perktold 2010) (Python), countreg (Zeileis, Kleiber, Jackman 2008), VGAM (T. Yee 2015) distributions3 (Hayes et al. 2024) (R) implement truncated distributions (e.g. distributions3::ZTPoisson countreg::zerotrunc) general distributions, Generally Altered, Inflated, Truncated Deflated, can found VGAM package (e.g. VGAM::gaitdpoisson Poisson distribution, see Thomas W. Yee Ma (2024) detailed description). However, estimation parameters given truncated (possibly inflated) distribution just first step (case log-linear models capture-recapture two sources) , best knowledge, open-source software can used estimate population size using SSCR methods includes variance estimators diagnostics. Therefore, purpose singleRcapture, R package, bridge gap providing scientists practitioners tool estimating population size SSCR methods. implemented state---art methods, recently described BÃ¶hning, Bunge, Heijden (2018) BÃ¶hning Friedl (2024) provided extensions (e.g., inclusion covariates, different treatment one-inflation), covered detail Section 2. package implements variance estimation based various methods, can used create custom models diagnostic plots (e.g.Â rootograms) parameters estimated using modified iteratively reweighted least squares (IRLS) algorithm implemented estimation stability. best knowledge, existing open-source package allows estimation population size selecting appropriate SSCR model, conducting estimation, providing informative diagnostics results. remaining part paper structured follows. Section 2 contains brief description theoretical background information fitting methods available methods variance estimation. Section 3 introduces main functions package. Section 4 presents case study contains assessment results, diagnostics estimates specific sub-populations. Section 5 describes classes S3methods implemented package. paper ends conclusions appendix showing use estimatePopsizeFit function aimed mimic glm.fit similar functions. replication materials show implement custom model option interest users wishing apply new bootstrap methods implemented package.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"how-to-estimate-population-size-with-a-single-source","dir":"Articles","previous_headings":"Theoretical background","what":"How to estimate population size with a single source?","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"Let YkY_{k} represent number times kk-th unit observed single source (e.g.Â register). Clearly, observe k:Yk>0k:Y_{k}>0 know many units missed (.e.Â Yk=0Y_{k}=0), population size, denoted NN, needs estimated. general, assume conditional distribution YkY_{k} given vector covariates ğ±k\\boldsymbol{x}_{k} follows version zero-truncated count data distribution (extensions). know parameters distribution can estimate population size using Horvitz-Thompson type estimator given : NÌ‚=âˆ‘k=1NIkâ„™[Yk>0|ğ—k]=âˆ‘k=1Nobs1â„™[Yk>0|ğ—k], \\begin{equation} \\hat{N}= \\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}[Y_{k}>0|\\boldsymbol{X}_{k}]}= \\sum_{k=1}^{N_{obs}}\\frac{1}{\\mathbb{P}[Y_{k}>0|\\boldsymbol{X}_{k}]}, \\end{equation} Ik:=â„â„•(Yk)I_{k}:=\\mathcal{}_{\\mathbb{N}}(Y_{k}), NobsN_{obs} number observed units â„\\mathcal{} indicator function, maximum likelihood estimate NN obtained substituting regression parameters ğ›ƒ\\boldsymbol{\\beta} â„™[Yk>0|ğ±k]\\mathbb{P}[Y_{k}>0|\\boldsymbol{x}_{k}] equation. basic SSCR assumes independence counts, rather naive assumption, since first capture may significantly influence behavior given unit limit possibility subsequent captures (e.g.Â due incarceration). solve issues, Ryan T. Godwin BÃ¶hning (2017b) Ryan T. Godwin BÃ¶hning (2017a) introduced one-inflated distributions, explicitly model probability singletons giving additional mass Ï‰\\omega singletons denoted â„{1}(y)\\mathcal{}_{\\{1\\}}(y)(cf. BÃ¶hning Friedl 2024). words considered new random variable Y*Y^{\\ast} corresponds data collection process exhibits one inflation: â„™[Y*=y|Y*>0]=Ï‰â„{1}(y)+(1âˆ’Ï‰)â„™[Y=y|Y>0]. \\begin{equation*}   \\mathbb{P}\\left[Y^{\\ast}=y|Y^{\\ast}>0\\right] =   \\omega\\mathcal{}_{\\{1\\}}(y)+(1-\\omega)\\mathbb{P}[Y=y|Y>0]. \\end{equation*} Analytic variance estimation performed computing two parts decomposition according law total variance given : var[NÌ‚]=ğ”¼[var[NÌ‚|I1,â€¦,]]+var[ğ”¼[NÌ‚|I1,â€¦,]], \\begin{equation}\\label{eq-law_of_total_variance_decomposition}   \\text{var}[\\hat{N}] = \\mathbb{E}\\left[\\text{var}   \\left[\\hat{N}|I_{1},\\dots,I_{n}\\right]\\right] +    \\text{var}\\left[\\mathbb{E}[\\hat{N}|I_{1},\\dots,I_{n}]\\right], \\end{equation} first part can estimated using multivariate Î´\\delta method given : ğ”¼[var[NÌ‚|I1,â€¦,]]=(âˆ‚(N|I1,â€¦,)âˆ‚ğ›ƒ)âŠ¤cov[ğ›ƒÌ‚](âˆ‚(N|I1,â€¦,)âˆ‚ğ›ƒ)|ğ›ƒ=ğ›ƒÌ‚, \\begin{equation*}   \\mathbb{E}\\left[\\text{var} \\left[\\hat{N}|I_{1},\\dots,I_{n}\\right]\\right] =   \\left.\\left(\\frac{\\partial(N|I_1,\\dots,I_N)}{\\partial\\boldsymbol{\\beta}}\\right)^\\top   \\text{cov}\\left[\\hat{\\boldsymbol{\\beta}}\\right]   \\left(\\frac{\\partial(N|I_1,\\dots,I_N)}{\\partial\\boldsymbol{\\beta}}\\right)   \\right|_{\\boldsymbol{\\beta}=\\hat{\\boldsymbol{\\beta}}}, \\end{equation*} second part decomposition , assuming independence IkI_{k}â€™s omitted simplifications, optimally estimated : var[ğ”¼(NÌ‚|I1,â€¦,)]=var[âˆ‘k=1NIkâ„™(Yk>0)]â‰ˆâˆ‘k=1Nobs1âˆ’â„™(Yk>0)â„™(Yk>0)2, \\begin{equation*}   \\text{var}\\left[\\mathbb{E}(\\hat{N}|I_{1},\\dots,I_{n})\\right] =   \\text{var}\\left[\\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)}\\right]   \\approx\\sum_{k=1}^{N_{obs}}\\frac{1-\\mathbb{P}(Y_{k}>0)}{\\mathbb{P}(Y_{k}>0)^{2}}, \\end{equation*} serves basis interval estimation. Confidence intervals usually constructed assumption (asymptotic) normality NÌ‚\\hat{N} asymptotic normality ln(NÌ‚âˆ’N)\\ln(\\hat{N}-N) (log normality NÌ‚\\hat{N}). latter attempt address common criticism student type confidence intervals SSCR, namely possibly skewed distribution NÌ‚\\hat{N}, results 1âˆ’Î±1-\\alpha confidence interval given : (Nobs+NÌ‚âˆ’NobsÎ¾,Nobs+(NÌ‚âˆ’Nobs)Î¾), \\begin{equation*}   \\left(N_{obs}+\\frac{\\hat{N}-N_{obs}}{\\xi},N_{obs} +   \\left(\\hat{N}-N_{obs}\\right)\\xi\\right), \\end{equation*} : Î¾=exp(z(1âˆ’Î±2)ln(1+VarÌ‚(NÌ‚)(NÌ‚âˆ’Nobs)2)), \\begin{equation*}   \\xi = \\exp\\left(z\\left(1-\\frac{\\alpha}{2}\\right)   \\sqrt{\\ln\\left(1+\\frac{\\widehat{\\text{Var}}(\\hat{N})}{\\left(\\hat{N}-N_{obs}\\right)^{2}}\\right)}\\right), \\end{equation*} zz quantile function standard normal distribution. estimator NÌ‚\\hat{N} best interpreted estimator total number units population, since means estimating number units population probability included data 00(Heijden et al. 2003).","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"available-models","dir":"Articles","previous_headings":"Theoretical background","what":"Available models","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"full list models implemented singleRcapture along corresponding expressions probability density functions point estimates can found collective help file family functions: sake simplicity, list family functions together brief descriptions. detailed information, please consult relevant literature. current list family functions includes: Generalized Chaoâ€™s (Chao 1987) Zeltermanâ€™s (Zelterman 1988) estimators via logistic regression variable ZZ defined Z=1Z=1 Y=2Y=2 Z=0Z=0 Y=1Y=1 Zâˆ¼b(p)Z\\sim b(p) b(â‹…)b(\\cdot) Bernoulli distribution pp can modeled unit kk logit(pk)=ln(Î»k/2)\\text{logit}(p_k)=\\ln(\\lambda_k/2) Poisson parameter Î»k=ğ±kğ›ƒ\\lambda_k=\\boldsymbol{x}_{k}\\boldsymbol{\\beta} (covariate extension see BÃ¶hning et al. (2013) BÃ¶hning Heijden (2009)): NÌ‚Chao=Nobs+âˆ‘k=1ğŸ1+ğŸ2(2exp(ğ±kğ›ƒÌ‚)+2exp(2ğ±kğ›ƒÌ‚))âˆ’1, \\hat{N}_{\\text{Chao}} = N_{obs}+ \\sum_{k=1}^{\\boldsymbol{f}_{1}+\\boldsymbol{f}_{2}} \\left(2\\exp\\left(\\boldsymbol{x}_{k}\\hat{\\boldsymbol{\\beta}}\\right)+ 2\\exp\\left(2\\boldsymbol{x}_{k}\\hat{\\boldsymbol{\\beta}}\\right)\\right)^{-1}, \\tag{Chao's estimator} NÌ‚Zelt=âˆ‘k=1Nobs(1âˆ’exp(âˆ’2exp(ğ±kğ›ƒÌ‚)))âˆ’1. \\hat{N}_{\\text{Zelt}}=\\sum_{k=1}^{N_{obs}} \\left(1-\\exp\\left(-2\\exp\\left(\\boldsymbol{x}_{k}\\hat{\\boldsymbol{\\beta}}\\right)\\right)\\right)^{-1}. \\tag{Zelterman's estimator} ğŸ1\\boldsymbol{f}_{1} ğŸ2\\boldsymbol{f}_{2} denotes number units observed twice. Zero-truncated (zt*^\\ast) zero-one-truncated (zot*^\\ast) Poisson (BÃ¶hning Heijden 2019), geometric, NB type II (NB2) regression, non-truncated distribution parameterized : â„™[Y=y|Î»,Î±]=Î“(y+Î±âˆ’1)Î“(Î±âˆ’1)y!(Î±âˆ’1Î±âˆ’1+Î»)Î±âˆ’1(Î»Î»+Î±âˆ’1)y. \\mathbb{P}[Y=y|\\lambda,\\alpha] = \\frac{\\Gamma\\left(y+\\alpha^{-1}\\right)}{\\Gamma\\left(\\alpha^{-1}\\right)y!} \\left(\\frac{\\alpha^{-1}}{\\alpha^{-1}+\\lambda}\\right)^{\\alpha^{-1}} \\left(\\frac{\\lambda}{\\lambda + \\alpha^{-1}}\\right)^{y}. Zero-truncated one-inflated (ztoi*^\\ast) modifications, count data variable Y*Y^{\\ast} defined : â„™[Y*=y]=Ï‰â„{1}(y)+(1âˆ’Ï‰)â„™[Y=y], \\mathbb{P}\\left[Y^{\\ast}=y\\right] = \\omega \\mathcal{}_{\\{1\\}}(y)+(1-\\omega)\\mathbb{P}[Y=y], â„™[Y*=y|Y*>0]=Ï‰â„{1}(y)1âˆ’(1âˆ’Ï‰)â„™[Y=0]+(1âˆ’Ï‰)â„™[Y=y]1âˆ’(1âˆ’Ï‰)â„™[Y=0]. \\mathbb{P}\\left[Y^{\\ast}=y|Y^{\\ast}>0\\right] =  \\omega\\frac{\\mathcal{}_{\\{1\\}}(y)}{1-(1-\\omega)\\mathbb{P}[Y=0]}+ (1-\\omega)\\frac{\\mathbb{P}[Y=y]}{1-(1-\\omega)\\mathbb{P}[Y=0]}. One-inflated zero-truncated (oizt*^\\ast) modifications, count data variable Y*Y^{\\ast} defined distribution statisfies: â„™[Y*=y]={â„™[Y=0]y=0,Ï‰(1âˆ’â„™[Y=0])+(1âˆ’Ï‰)â„™[Y=1]y=1,(1âˆ’Ï‰)â„™[Y=y]y>1, \\mathbb{P}\\left[Y^{\\ast}=y\\right]= \\begin{cases} \\mathbb{P}[Y=0] & y=0, \\\\ \\omega\\left(1-\\mathbb{P}[Y=0]\\right)+(1-\\omega)\\mathbb{P}[Y=1] & y=1, \\\\ (1-\\omega)\\mathbb{P}[Y=y] & y>1, \\end{cases} â„™[Y*=y|Y*>0]=Ï‰â„{1}(y)+(1âˆ’Ï‰)â„™[Y=y|Y>0]. \\mathbb{P}\\left[Y^{\\ast}=y|Y^{\\ast}>0\\right]=\\omega\\mathcal{}_{\\{1\\}}(y)+(1-\\omega)\\mathbb{P}[Y=y|Y>0]. Note ztoi*^\\ast oizt*^\\ast distributions equivalent, sense maximum value likelihood function equal distributions given data, shown (BÃ¶hning 2023) population size estimators different. addition, propose two new approaches model singletons similar way hurdle models. particular, proposed following: zero-truncated hurdle model (ztHurdle*) Poisson, geometric NB2 defined : â„™[Y*=y]={â„™[Y=0]1âˆ’â„™[Y=1]y=0,Ï€(1âˆ’â„™[Y=1])y=1,(1âˆ’Ï€)â„™[Y=y]1âˆ’â„™[Y=1]y>1, \\mathbb{P}[Y^{\\ast}=y]=\\begin{cases} \\frac{\\mathbb{P}[Y=0]}{1-\\mathbb{P}[Y=1]} & y=0, \\\\ \\pi(1-\\mathbb{P}[Y=1]) & y=1, \\\\ (1-\\pi) \\frac{\\mathbb{P}[Y=y]}{1-\\mathbb{P}[Y=1]} & y>1, \\end{cases} â„™[Y*=y|Y*>0]=Ï€ğŸ{1}(y)+(1âˆ’Ï€)ğŸâ„•\\{1}(y)â„™[Y=y]1âˆ’â„™[Y=0]âˆ’â„™[Y=1]. \\mathbb{P}[Y^{\\ast}=y|Y^{\\ast}>0]=\\pi\\mathbf{1}_{\\{1\\}}(y)+ (1-\\pi)\\mathbf{1}_{\\mathbb{N}\\setminus\\{1\\}}(y)\\frac{\\mathbb{P}[Y=y]}{1-\\mathbb{P}[Y=0]-\\mathbb{P}[Y=1]}. Ï€\\pi denotes conditional probability observing singletons. hurdle zero-truncated model (Hurdlezt*) Poisson, geometric NB2 defined : â„™[Y*=y]={Ï€y=1,(1âˆ’Ï€)â„™[Y=y]1âˆ’â„™[Y=1]yâ‰ 1, \\mathbb{P}[Y^{\\ast}=y]=\\begin{cases} \\pi & y=1, \\\\ (1-\\pi) \\frac{\\mathbb{P}[Y=y]}{1-\\mathbb{P}[Y=1]} & y\\neq1, \\end{cases} â„™[Y*=y|Y*>0]={Ï€1âˆ’â„™[Y=1]1âˆ’â„™[Y=0]âˆ’â„™[Y=1]y=1,(1âˆ’Ï€)â„™[Y=y]1âˆ’â„™[Y=0]âˆ’â„™[Y=1]y>1, \\mathbb{P}[Y^{\\ast}=y|Y^{\\ast}>0]=\\begin{cases} \\pi\\frac{1-\\mathbb{P}[Y=1]}{1-\\mathbb{P}[Y=0]-\\mathbb{P}[Y=1]} & y=1,\\\\ (1-\\pi)\\frac{\\mathbb{P}[Y=y]}{1-\\mathbb{P}[Y=0]-\\mathbb{P}[Y=1]} & y>1, \\end{cases} Ï€\\pi denotes unconditional probability observing singletons. approaches presented differ assumptions, computational complexity, way treat heterogeneity captures singletons. instance, dispersion parameter Î±\\alpha NB2 type models often interpreted measuring severity unobserved heterogeneity underlying Poisson process (Cruyff Heijden 2008). using truncated NB model, hope given class models considered, consistency lost despite lack information. discussed literature, interpretation heterogeneous Î±\\alpha across population (specified controlModel) unobserved heterogeneity affects accuracy prediction dependent variable YY severely others. geometric model (NB Î±=1\\alpha=1) singled package often considered literature inherent computational issues NB models, exacerbated fact data used SSCR usually rather low quality. Data sparsity particularly common problem SSCR big challenge numerical methods fitting (zero-truncated) NB model. extra mass Ï‰\\omega one-inflated models important extension researcherâ€™s toolbox SSCR models, since inflation y=1y=1 likely occur many types applications. example, estimating number active people committed criminal acts given time period, fact captured first time following arrest associated risk longer able captured second time. One constraint present modelling via inflated models attempts include possibility one inflation one deflation lead numerical inferential problems since parameter space ((Ï‰,Î»)(\\omega, \\lambda) (Ï‰,Î»,Î±)(\\omega, \\lambda, \\alpha)) given {(Ï‰,Î»,Î±)|âˆ€xâˆˆâ„•:p(x|Ï‰,Î»,Î±)â‰¥0}\\{(\\omega, \\lambda, \\alpha) | \\forall x\\\\mathbb{N}: p(x|\\omega, \\lambda, \\alpha)\\geq0\\} probability mass function pp. boundary set 11 2âˆ’2-dimensional manifold, transforming parameter space â„3\\mathbb{R}^{3} require using link functions depend one parameter. Hurdle models represent another approach modelling one-inflation. can also model deflation well inflation deflation simultaneously, flexible , case hurdle zero-truncated models, appear numerically stable. Although question interpret regression parameters tends somewhat overlooked SSCR studies, point interpretation Ï‰\\omega inflation parameter (ztoi*^\\ast oizt*^\\ast) convenient interpretation Ï€\\pi probability parameter (hurdle models). Additionally, interpretation Î»\\lambda parameter (one) inflated models conforms following intuition: given unit kk comes non-inflated part population, follows Poisson distribution (respectively geometric negative binomial) Î»\\lambda parameter (Î»,Î±\\lambda,\\alpha); interpretation exists hurdle models. Interestingly, estimates hurdle zero-truncated zero-truncated one-inflated models tend quite close one another, although rigorous studies required confirm observation.","code":"?ztpoisson"},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"fitting-method","dir":"Articles","previous_headings":"Theoretical background","what":"Fitting method","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"previously noted, singleRcapture package can used model (linear) dependence parameters covariates. modified IRLS algorithm employed purpose presented Algorithm 1; full details available T. Yee (2015). order apply algorithm, modified model matrix ğ—vlm\\boldsymbol{X}_{\\text{vlm}} created estimatePopsize function called. context models implemented singleRcapture, matrix can written : ğ—vlm=(ğ—1ğŸâ€¦ğŸğŸğ—2â€¦ğŸâ‹®â‹®â‹±â‹®ğŸğŸâ€¦ğ—p) \\begin{equation}\\label{X_vlm-definition}   \\boldsymbol{X}_{\\text{vlm}}=   \\begin{pmatrix}     \\boldsymbol{X}_{1} & \\boldsymbol{0} &\\dotso &\\boldsymbol{0}\\\\     \\boldsymbol{0} & \\boldsymbol{X}_{2} &\\dotso &\\boldsymbol{0}\\\\     \\vdots & \\vdots & \\ddots & \\vdots\\\\     \\boldsymbol{0} & \\boldsymbol{0} &\\dotso &\\boldsymbol{X}_{p}   \\end{pmatrix} \\end{equation} ğ—i\\boldsymbol{X}_{} corresponds model matrix associated user specified formula.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"algorithm-1-the-modified-irls-algorithm-used-in-the-singlercapture-package","dir":"Articles","previous_headings":"Theoretical background > Fitting method","what":"Algorithm 1: The modified IRLS algorithm used in the singleRcapture package","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"Initialize iter â† 1, ğ›ˆ\\boldsymbol{\\eta} â† start, ğ–\\boldsymbol{W} â† , â„“\\ell â† â„“(ğ›ƒ)\\ell(\\boldsymbol{\\beta}) Store values previous step:â„“âˆ’\\ell_{-} â† â„“\\ell, ğ–âˆ’\\boldsymbol{W}_{-} â† ğ–\\boldsymbol{W}, ğ›ƒâˆ’\\boldsymbol{\\beta}_{-} â† ğ›ƒ\\boldsymbol{\\beta} (last assignment omitted first iteration), assign values current iteration: ğ›ˆ\\displaystyle\\boldsymbol{\\eta} â† ğ—vlmğ›ƒ+ğ¨\\boldsymbol{X}_{\\text{vlm}}\\boldsymbol{\\beta}+\\boldsymbol{o} ğ–(k)\\boldsymbol{W}_{(k)} â† ğ”¼[âˆ’âˆ‚2â„“âˆ‚ğ›ˆ(k)âŠ¤âˆ‚ğ›ˆ(k)]\\mathbb{E}\\left[-\\frac{\\partial^{2}\\ell}{\\partial\\boldsymbol{\\eta}_{(k)}^\\top\\partial\\boldsymbol{\\eta}_{(k)}}\\right] ğ™(k)\\boldsymbol{Z}_{(k)} â† ğ›ˆ(k)+âˆ‚â„“âˆ‚ğ›ˆ(k)ğ–(k)âˆ’1âˆ’ğ¨(k)\\boldsymbol{\\eta}_{(k)}+\\frac{\\partial\\ell}{\\partial\\boldsymbol{\\eta}_{(k)}}\\boldsymbol{W}_{(k)}^{-1}-\\boldsymbol{o}_{(k)} ğ¨\\boldsymbol{o} denotes offset. Assign current coefficient value:ğ›ƒ\\boldsymbol{\\beta} â† (ğ—vlmğ–ğ—vlm)âˆ’1ğ—vlmğ–ğ™\\left(\\boldsymbol{X}_{\\text{vlm}}\\boldsymbol{W}\\boldsymbol{X}_{\\text{vlm}}\\right)^{-1}\\boldsymbol{X}_{\\text{vlm}}\\boldsymbol{W}\\boldsymbol{Z} â„“(ğ›ƒ)<â„“(ğ›ƒâˆ’)\\ell(\\boldsymbol{\\beta})<\\ell(\\boldsymbol{\\beta}_{-}) try selecting smallest value hh ğ›ƒh\\boldsymbol{\\beta}_{h} â† 2âˆ’h(ğ›ƒ+ğ›ƒâˆ’)2^{-h}\\left(\\boldsymbol{\\beta}+\\boldsymbol{\\beta}_{-}\\right) inequality â„“(ğ›ƒh)>â„“(ğ›ƒâˆ’)\\ell(\\boldsymbol{\\beta}_{h})>\\ell(\\boldsymbol{\\beta}_{-}) holds successful ğ›ƒ\\boldsymbol{\\beta} â† ğ›ƒh\\boldsymbol{\\beta}_{h}, else stop algorithm. convergence achieved iter higher maxiter, stop algorithm, else iter â† 1 + iter return step 2. case multi-parameter families, get matrix linear predictors ğ›ˆ\\boldsymbol{\\eta} instead vector, number columns matching number parameters distribution. â€œWeightsâ€ (matrix ğ–\\boldsymbol{W}) modified information matrices ğ”¼[âˆ’âˆ‚2â„“âˆ‚ğ›ˆ(k)âŠ¤âˆ‚ğ›ˆ(k)]\\displaystyle\\mathbb{E}\\left[-\\frac{\\partial^{2}\\ell}{\\partial\\boldsymbol{\\eta}_{(k)}^\\top\\partial\\boldsymbol{\\eta}_{(k)}}\\right], â„“\\ell log-likelihood function ğ›ˆ(k)\\boldsymbol{\\eta}_{(k)} kk-th row ğ›ˆ\\boldsymbol{\\eta}, typical IRLS scalars ğ”¼[âˆ’âˆ‚2â„“âˆ‚Î·k2]\\displaystyle\\mathbb{E}\\left[-\\frac{\\partial^{2}\\ell}{\\partial\\eta_{k}^{2}}\\right], often just âˆ’âˆ‚2â„“âˆ‚Î·2\\displaystyle-\\frac{\\partial^{2}\\ell}{\\partial\\eta^{2}}.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"sec-boostrap","dir":"Articles","previous_headings":"Theoretical background","what":"Bootstrap variance estimators","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"implemented three types bootstrap algorithms: parametric (adapted theory Zwane Van der Heijden (2003), Norris Pollock (1996) multiple source setting covariates), semi-parametric (see e.g. BÃ¶hning Friedl (2021)) nonparametric. nonparametric version usual bootstrap algorithm; typically underestimate variance NÌ‚\\hat{N}. section, focus first two approaches. idea semi-parametric bootstrap modify usual bootstrap include additional uncertainty resulting fact sample size random variable. type bootstrap performed steps listed Algorithm 2.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"algorithm-2-semi-parametric-bootstrap","dir":"Articles","previous_headings":"Theoretical background > Bootstrap variance estimators","what":"Algorithm 2: Semi-parametric bootstrap","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"Draw sample size Nobsâ€²âˆ¼Binomial(Nâ€²,NobsNâ€²)N_{obs}'\\sim\\text{Binomial}\\left(N', \\frac{N_{obs}}{N'}\\right), Nâ€²=âŒŠNÌ‚âŒ‹+Bernoulli(âŒŠNÌ‚âŒ‹âˆ’NÌ‚)N'=\\lfloor\\hat{N}\\rfloor+\\text{Bernoulli}\\left(\\lfloor\\hat{N}\\rfloor-\\hat{N}\\right) Draw Nobsâ€²N_{obs}' units data uniformly without replacement Obtain new population size estimate NbN_b using bootstrap data Repeat 1-3 steps BB times words, first draw sample size sample conditional sample size. Note using semi-parametric bootstrap one implicitly assumes population size estimate NÌ‚\\hat{N} accurate. last implemented bootstrap type parametric algorithm, first draws finite population size â‰ˆNÌ‚\\approx\\hat{N} superpopulation model samples population according selected model, described Algorithm 3.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"algorithm-3-parametric-bootstrap","dir":"Articles","previous_headings":"Theoretical background > Bootstrap variance estimators","what":"Algorithm 3: Parametric bootstrap","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"Draw number covariates equal âŒŠNÌ‚âŒ‹+Bernoulli(âŒŠNÌ‚âŒ‹âˆ’NÌ‚)\\lfloor\\hat{N}\\rfloor+\\text{Bernoulli}\\left(\\lfloor\\hat{N}\\rfloor-\\hat{N}\\right) proportional estimated contribution (â„™[Yk>0|ğ±k])âˆ’1(\\mathbb{P}\\left[Y_{k}>0|\\boldsymbol{x}_{k}\\right])^{-1} replacement Using fitted model regression coefficients ğ›ƒÌ‚\\hat{\\boldsymbol{\\beta}} draw covariate YY value corresponding probability measure â„•âˆª{0}\\mathbb{N}\\cup\\{0\\} Truncate units drawn YY value equal 00 Obtain population size estimate NbN_b based truncated data Repeat 1-4 steps BB times Note order type algorithm result consistent standard error estimates, imperative estimated model entire superpopulation probability space consistent, may much less realistic case semi-parametric bootstrap. parametric bootstrap algorithm default option singleRcapture.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"the-estimatepopsize-function","dir":"Articles","previous_headings":"The main function","what":"The estimatePopsize function","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"singleRcapture package built around estimatePopsize function. main design objective make using estimatePopsize similar possible standard stats::glm function packages fitting zero-truncated regression models, countreg (e.g. countreg::zerotrunc function). estimatePopsize function used first fit appropriate (vector) generalized linear model estimate population size along variance. assumed response vector (.e.Â dependent variable) corresponds number times given unit observed source. important arguments given Table ; obligatory ones formula, data, model. important step using estimatePopsize specifying model parameter, indicates type model used estimating unobserved part population. instance, fit Chaoâ€™s Zeltermanâ€™s model one select chao zelterman , assuming one-inflation present, one can select one zero-truncated one-inflated (ztoi*^\\ast) one-inflated zero-truncated (oizt*^\\ast) models, oiztpoisson Poisson ztoinegbin NB2. assumed heterogeneity observed NB2 models, one can specify formula controlModel argument controlModel function alphaFormula argument. enables user provide formula dispersion parameter NB2 models. heterogeneity assumed ztoi*^\\ast oizt*^\\ast, one can specify omegaFormula argument, corresponds Ï‰\\omega parameter models. Finally, covariates assumed available hurdle models (ztHurdle*^\\ast Hurdlezt*^\\ast), piFormula can specified, provides formula probability parameter models.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"controlling-variance-estimation-with-controlpopvar","dir":"Articles","previous_headings":"The main function","what":"Controlling variance estimation with controlPopVar","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"estimatePopsize function makes possible specify variance estimation method via popVar (e.g.Â analytic variance bootstrap) control estimation process specifying controlPopVar. control function controlPopVar user can specify bootType argument, three possible values: \"parametric\", \"semiparametric\" \"nonparametric\". Additional arguments accepted contorlPopVar function, relevant bootstrap, include: alpha, B â€“ significance level number bootstrap samples performed, respectively, 0.050.05 500500 default options. cores â€“ number process cores used bootstrap (1 default); parallel computing enabled doParallel (Microsoft Weston 2022a), foreach (Microsoft Weston 2022b) parallel packages (R Core Team 2023). keepbootStat â€“ logical value indicating whether keep vector statistics produced bootstrap. traceBootstrapSize, bootstrapVisualTrace â€“ logical values indicating whether sample population size tracked (FALSE default); work cores = 1. fittingMethod, bootstrapFitcontrol â€“ fitting method (default one used original call) control parameters (controlMethod) model fitting bootstrap. addition, user can specify type confidence interval means confType type covariance matrix using covType analytical variance estimator (observed Fisher information matrix). next sections present case study involving use simple zero-truncated Poisson regression advanced model: zero-truncated one-inflated geometric regression cloglog link function. First, present example dataset, describe estimate population size assess quality diagnostics measures. Finally, show estimate population size user-specified sub-populations.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"sec-study","dir":"Articles","previous_headings":"","what":"Data analysis example","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"package can installed standard manner using: , need load package using following code:","code":"install.packages(\"singleRcapture\") library(singleRcapture)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"dataset","dir":"Articles","previous_headings":"Data analysis example","what":"Dataset","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"use dataset Heijden et al. (2003), contains information immigrants four Dutch cities (Amsterdam, Rotterdam, Hague Utrecht), staying country without legal permit 1995 appeared police records year. dataset included package called netherlandsimmigrant: number times individual appeared records included capture variable. available covariates include gender, age, reason, nation; last two represent reason captured region world given person comes : One notable characteristic dataset contains disproportionately large number individuals observed (.e.Â 1645). basic syntax estimatePopsize similar glm, can said output summary method except additional results population size estimates (denoted Population size estimation results). output regarding population size contains point estimate, observed proportion (based input dataset), standard error two confidence intervals: one relating point estimate, second â€“ observed proportion. According simple model, population size 12,500, 15% units observed register. 95% CI normality indicates true population size likely 7,000-18,000, 10-26% target population observed register. Since reasonable suspicion act observing unit dataset may lead undesirable consequences person concerned (case, possible deportation, detention something similar). reasons, user may consider one-inflated models, zero-truncated one-inflated geometric model (specified ztoigeom family) presented . According approach, population size 7,000, 5,000 less case naive Poisson approach. comparison AIC BIC suggests one-inflation model fits data better BIC ztoigeom 1727 1757 ztpoisson. can access population size estimates using following code, returns list numerical results. decision whether use zero-truncated Poisson zero-truncated one-inflated geometric model based assessment model assumptions regarding data generation process. One possible method selection based likelihood ratio test, can computed quickly conveniently lmtest (Zeileis Hothorn (2002)) interface: However, standard method model selection SSCR. next sections dedicated detailed description assess results using standard statistical tests diagnostics.","code":"data(netherlandsimmigrant) head(netherlandsimmigrant) ##   capture gender    age       reason       nation ## 1       1   male <40yrs Other reason North Africa ## 2       1   male <40yrs Other reason North Africa ## 3       1   male <40yrs Other reason North Africa ## 4       1   male <40yrs Other reason         Asia ## 5       1   male <40yrs Other reason         Asia ## 6       2   male <40yrs Other reason North Africa summary(netherlandsimmigrant) ##     capture         gender         age                reason     ##  Min.   :1.000   female: 398   <40yrs:1769   Illegal stay: 259   ##  1st Qu.:1.000   male  :1482   >40yrs: 111   Other reason:1621   ##  Median :1.000                                                   ##  Mean   :1.162                                                   ##  3rd Qu.:1.000                                                   ##  Max.   :6.000                                                   ##                     nation     ##  American and Australia: 173   ##  Asia                  : 284   ##  North Africa          :1023   ##  Rest of Africa        : 243   ##  Surinam               :  64   ##  Turkey                :  93 table(netherlandsimmigrant$capture) ##  ##    1    2    3    4    5    6  ## 1645  183   37   13    1    1 basicModel <- estimatePopsize(   formula = capture ~ gender + age + nation,   model   = ztpoisson(),   data    = netherlandsimmigrant,   controlMethod = controlMethod(silent = TRUE) ) summary(basicModel) ##  ## Call: ## estimatePopsize.default(formula = capture ~ gender + age + nation,  ##     data = netherlandsimmigrant, model = ztpoisson(), controlMethod = controlMethod(silent = TRUE)) ##  ## Pearson Residuals: ##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  ## -0.486442 -0.486442 -0.298080  0.002093 -0.209444 13.910844  ##  ## Coefficients: ## ----------------------- ## For linear predictors associated with: lambda  ##                      Estimate Std. Error z value  P(>|z|)     ## (Intercept)           -1.3411     0.2149  -6.241 4.35e-10 *** ## gendermale             0.3972     0.1630   2.436 0.014832 *   ## age>40yrs             -0.9746     0.4082  -2.387 0.016972 *   ## nationAsia            -1.0926     0.3016  -3.622 0.000292 *** ## nationNorth Africa     0.1900     0.1940   0.979 0.327398     ## nationRest of Africa  -0.9106     0.3008  -3.027 0.002468 **  ## nationSurinam         -2.3364     1.0136  -2.305 0.021159 *   ## nationTurkey          -1.6754     0.6028  -2.779 0.005445 **  ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ## AIC: 1712.901 ## BIC: 1757.213 ## Residual deviance: 1128.553 ##  ## Log-likelihood: -848.4504 on 1872 Degrees of freedom  ## Number of iterations: 8 ## ----------------------- ## Population size estimation results:  ## Point estimate 12690.35 ## Observed proportion: 14.8% (N obs = 1880) ## Std. Error 2808.169 ## 95% CI for the population size: ##           lowerBound upperBound ## normal      7186.444   18194.26 ## logNormal   8431.275   19718.32 ## 95% CI for the share of observed population: ##           lowerBound upperBound ## normal     10.332927   26.16037 ## logNormal   9.534281   22.29793 set.seed(123456) modelInflated <- estimatePopsize(     formula = capture ~ nation,     model   = ztoigeom(omegaLink = \"cloglog\"),     data    = netherlandsimmigrant,     controlModel = controlModel(         omegaFormula = ~ gender + age     ),     popVar = \"bootstrap\",     controlPopVar = controlPopVar(bootType = \"semiparametric\",                                   B = 50) ) summary(modelInflated) ##  ## Call: ## estimatePopsize.default(formula = capture ~ nation, data = netherlandsimmigrant,  ##     model = ztoigeom(omegaLink = \"cloglog\"), popVar = \"bootstrap\",  ##     controlModel = controlModel(omegaFormula = ~gender + age),  ##     controlPopVar = controlPopVar(bootType = \"semiparametric\",  ##         B = 50)) ##  ## Pearson Residuals: ##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.  ## -0.41643 -0.41643 -0.30127  0.00314 -0.18323 13.88375  ##  ## Coefficients: ## ----------------------- ## For linear predictors associated with: lambda  ##                      Estimate Std. Error z value  P(>|z|)     ## (Intercept)           -1.2552     0.2149  -5.840 5.22e-09 *** ## nationAsia            -0.8193     0.2544  -3.220  0.00128 **  ## nationNorth Africa     0.2057     0.1838   1.119  0.26309     ## nationRest of Africa  -0.6692     0.2548  -2.627  0.00862 **  ## nationSurinam         -1.5205     0.6271  -2.425  0.01532 *   ## nationTurkey          -1.1888     0.4343  -2.737  0.00619 **  ## ----------------------- ## For linear predictors associated with: omega  ##             Estimate Std. Error z value  P(>|z|)     ## (Intercept)  -1.4577     0.3884  -3.753 0.000175 *** ## gendermale   -0.8738     0.3602  -2.426 0.015267 *   ## age>40yrs     1.1745     0.5423   2.166 0.030326 *   ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ## AIC: 1677.125 ## BIC: 1726.976 ## Residual deviance: 941.5416 ##  ## Log-likelihood: -829.5625 on 3751 Degrees of freedom  ## Number of iterations: 10 ## ----------------------- ## Population size estimation results:  ## Point estimate 6699.953 ## Observed proportion: 28.1% (N obs = 1880) ## Boostrap sample skewness: 0.5209689 ## 0 skewness is expected for normally distributed variable ## --- ## Bootstrap Std. Error 1579.235 ## 95% CI for the population size: ## lowerBound upperBound  ##   5107.533  10738.242  ## 95% CI for the share of observed population: ## lowerBound upperBound  ##   17.50752   36.80838 popSizeEst(basicModel)    # alternative: basicModel$populationSize ## Point estimate: 12690.35 ## Variance: 7885812 ## 95% confidence intervals: ##           lowerBound upperBound ## normal      7186.444   18194.26 ## logNormal   8431.275   19718.32 popSizeEst(modelInflated) # alternative: modelInflated$populationSize ## Point estimate: 6699.953 ## Variance: 2493985 ## 95% confidence intervals: ## lowerBound upperBound  ##   5107.533  10738.242 library(lmtest) lrtest(basicModel, modelInflated,         name = function(x) {     if (family(x)$family == \"ztpoisson\")         \"Basic model\"     else \"Inflated model\" }) ## Likelihood ratio test ##  ## Model 1: Basic model ## Model 2: Inflated model ##   #Df  LogLik Df  Chisq Pr(>Chisq)     ## 1   8 -848.45                          ## 2   9 -829.56  1 37.776  7.936e-10 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"testing-marginal-frequencies","dir":"Articles","previous_headings":"Data analysis example","what":"Testing marginal frequencies","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"popular method testing model fit single source capture-recapture studies consists comparing fitted marginal frequencies âˆ‘j=1Nobsâ„™Ì‚[Yj=k|ğ±j,Yj>0]\\displaystyle\\sum_{j=1}^{N_{obs}}\\hat{\\mathbb{P}}\\left[Y_{j}=k|\\boldsymbol{x}_{j}, Y_{j} > 0\\right] observed marginal frequencies âˆ‘j=1Nâ„{k}(Yj)=âˆ‘j=1Nobsâ„{k}(Yj)\\displaystyle\\sum_{j=1}^{N}\\mathcal{}_{\\{k\\}}(Y_{j})=\\sum_{j=1}^{N_{obs}}\\mathcal{}_{\\{k\\}}(Y_{j}) kâ‰¥1k\\geq1. fitted model bears sufficient resemblance real data collection process, quantities quite close GG Ï‡2\\chi^{2} tests can used test statistical significance discrepancy following singleRcapture syntax Poisson model (rather poor fit): one-inflated model (better fit): dropl5 argument used indicate handle cells less 55 fitted observations. Note, however, currently continuity correction.","code":"margFreq <- marginalFreq(basicModel) summary(margFreq, df = 1, dropl5 = \"group\") ## Test for Goodness of fit of a regression model: ##  ##                  Test statistics df P(>X^2) ## Chi-squared test           50.06  1 1.5e-12 ## G-test                     34.31  1 4.7e-09 ##  ## --------------------------------------------------------------  ## Cells with fitted frequencies of < 5 have been grouped  ## Names of cells used in calculating test(s) statistic: 1 2 3 margFreq_inf <- marginalFreq(modelInflated) summary(margFreq_inf, df = 1, dropl5 = \"group\") ## Test for Goodness of fit of a regression model: ##  ##                  Test statistics df P(>X^2) ## Chi-squared test            1.88  1    0.17 ## G-test                      2.32  1    0.13 ##  ## --------------------------------------------------------------  ## Cells with fitted frequencies of < 5 have been grouped  ## Names of cells used in calculating test(s) statistic: 1 2 3 4"},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"diagnostics","dir":"Articles","previous_headings":"Data analysis example","what":"Diagnostics","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"singleRStaticCountData class plot method implementing several types quick demonstrative plots, rootogram (Kleiber Zeileis 2016), comparing fitted marginal frequencies, can generated following syntax: Rootograms ztpoisson (left) ztoigeom (right) models plots suggest ztoigeom model fits data better. Another important issue population size estimation conduct model diagnostics order verify whether influential observations present data. purpose leave-one-(LOO) diagnostic implemented dfbeta stats package adapted shown (multiplied factor hundred better readability): result dfbeta can used dfpopsize function, can used quantify LOO population size. Note warning bootstap variance estimation applied. Figure 2 shows comparison effect deleting observation population size estimate inverse probability weights, refer contribution given observation population size estimate: Results ztpoisson (left) ztoigeom (right) model plots show population size changes given observation removed. instance, remove observation 542, population size increase 4236 ztpoisson model. case ztoigeom, largest change equal 457 observation 900. full list plot types along list optional arguments can passed call plot method base R graphics functions can found help file plot method.","code":"plot(   basicModel, plotType = \"rootogram\", main = \"ZT Poisson model\") plot(modelInflated, plotType = \"rootogram\", main = \"ZTOI Geometric model\") dfb <- dfbeta(basicModel) round(t(apply(dfb, 2, quantile)*100), 4) ##                           0%     25%     50%    75%    100% ## (Intercept)          -0.9909 -0.1533  0.0191 0.0521  8.6619 ## gendermale           -9.0535 -0.0777 -0.0283 0.1017  2.2135 ## age>40yrs            -2.0010  0.0179  0.0379 0.0691 16.0061 ## nationAsia           -9.5559 -0.0529  0.0066 0.0120 17.9914 ## nationNorth Africa   -9.6605 -0.0842 -0.0177 0.0087  3.1260 ## nationRest of Africa -9.4497 -0.0244  0.0030 0.0083 10.9787 ## nationSurinam        -9.3140 -0.0066  0.0020 0.0035 99.3383 ## nationTurkey         -9.6198 -0.0220  0.0079 0.0143 32.0980 dfi <- dfbeta(modelInflated) round(t(apply(dfi, 2, quantile)*100), 4) ##                            0%     25%     50%     75%    100% ## (Intercept)           -1.4640  0.0050  0.0184  0.0557  9.0600 ## nationAsia            -6.6331 -0.0346  0.0157  0.0347 12.2406 ## nationNorth Africa    -7.2770 -0.0768 -0.0170  0.0085  1.9415 ## nationRest of Africa  -6.6568 -0.0230  0.0081  0.0262  7.1710 ## nationSurinam         -6.2308 -0.0124  0.0162  0.0421 62.2045 ## nationTurkey          -6.4795 -0.0273  0.0204  0.0462 21.1338 ## (Intercept):omega     -6.8668 -0.0193  0.0476  0.0476  9.3389 ## gendermale:omega      -2.2733 -0.2227  0.1313  0.2482 11.1234 ## age>40yrs:omega      -30.2130 -0.2247 -0.1312 -0.0663  2.0393 dfb_pop <- dfpopsize(basicModel, dfbeta = dfb) dfi_pop <- dfpopsize(modelInflated, dfbeta = dfi) summary(dfb_pop) ##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  ## -4236.412     2.663     2.663     5.448    17.284   117.448 summary(dfi_pop) ##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  ## -456.6443   -3.1121   -0.7242    3.4333    5.1535  103.5949 plot(basicModel, plotType = \"dfpopContr\",       dfpop = dfb_pop, xlim = c(-4500, 150)) plot(modelInflated, plotType = \"dfpopContr\",       dfpop = dfi_pop, xlim = c(-4500, 150)) ?plot.singleRStaticCountData"},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"the-stratifypopsize-function","dir":"Articles","previous_headings":"Data analysis example","what":"The stratifyPopsize function","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"Researchers may interested total population size also size specific sub-populations (e.g.Â males, females, particular age groups). reason created stratifyPopsize function, estimates size strata defined coefficients model (default option). following output presents results based ztpoisson ztoigeom models. stratifyPopsize function prepared handle objects singleRStaticCountData class, accepts three optional parameters strata, alpha, cov, used specifying sub-populations, significance levels covariance matrix used computing standard errors. example full call presented . provided integration sandwich (Zeileis, KÃ¶ll, Graham 2020) package correct variance-covariance matrix Î´\\delta method. code used vcovHC method singleRStaticCountData class sandwich package, different significance levels confidence intervals stratum formula specify want estimates males females grouped nation age. strata parameter can specified either : formula empty left hand side, shown example (e.g.Â ~ gender * age), logical vector number entries equal number rows dataset, case one stratum created (e.g.Â netherlandsimmigrant$gender == \"male\"), vector names explanatory variables, result every level explanatory variable sub-population variable specified (e.g. c(\"gender\", \"age\")), supplied , case strata correspond levels factor data without interactions (string vectors converted factors convenience user), (named) list element logical vector; names list used specify variable names returned object, example: One can also specify plotType = \"strata\" plot function, results plot point CI estimates population size. Population size covariates ztpoisson (left) ztoigeom (right) model logNormal type confidence interval used plotting since studentized confidence intervals often result negative lower bounds.","code":"popSizestrata <- stratifyPopsize(basicModel) cols <- c(\"name\", \"Observed\", \"Estimated\", \"logNormalLowerBound\",            \"logNormalUpperBound\") popSizestrata_report <- popSizestrata[, cols] cols_custom <- c(\"Name\", \"Obs\", \"Estimated\", \"LowerBound\", \"UpperBound\") names(popSizestrata_report) <- cols_custom popSizestrata_report ##                              Name  Obs  Estimated LowerBound UpperBound ## 1                  gender==female  398  3811.0924  2189.0439   6902.140 ## 2                    gender==male 1482  8879.2613  6090.7752  13354.889 ## 3                     age==<40yrs 1769 10506.8994  7359.4140  15426.465 ## 4                     age==>40yrs  111  2183.4543   872.0130   5754.881 ## 5  nation==American and Australia  173   708.3688   504.6086   1037.331 ## 6                    nation==Asia  284  2742.3147  1755.2548   4391.590 ## 7            nation==North Africa 1023  3055.2033  2697.4900   3489.333 ## 8          nation==Rest of Africa  243  2058.1533  1318.7466   3305.786 ## 9                 nation==Surinam   64  2386.4544   505.2460  12288.008 ## 10                 nation==Turkey   93  1739.8592   638.0497   5068.959 popSizestrata_inflated <- stratifyPopsize(modelInflated) popSizestrata_inflated_report <- popSizestrata_inflated[, cols] names(popSizestrata_inflated_report) <- cols_custom popSizestrata_inflated_report ##                              Name  Obs Estimated LowerBound UpperBound ## 1  nation==American and Australia  173  516.2432   370.8463   768.4919 ## 2                    nation==Asia  284 1323.5377   831.1601  2258.9954 ## 3            nation==North Africa 1023 2975.8801  2254.7071  4119.3050 ## 4          nation==Rest of Africa  243 1033.9753   667.6106  1716.4484 ## 5                 nation==Surinam   64  354.2236   193.8891   712.4739 ## 6                  nation==Turkey   93  496.0934   283.1444   947.5309 ## 7                  gender==female  398 1109.7768   778.7197  1728.7066 ## 8                    gender==male 1482 5590.1764  3838.4550  8644.0776 ## 9                     age==<40yrs 1769 6437.8154  4462.3472  9862.2147 ## 10                    age==>40yrs  111  262.1379   170.9490   492.0347 library(sandwich) popSizestrataCustom <- stratifyPopsize(   object  = basicModel,   strata = ~ gender + age,    alpha   = rep(c(0.1, 0.05), each=2),    cov     = vcovHC(basicModel, type = \"HC4\") )  popSizestrataCustom_report <- popSizestrataCustom[, c(cols, \"confLevel\")] names(popSizestrataCustom_report) <- c(cols_custom, \"alpha\") popSizestrataCustom_report ##             Name  Obs Estimated LowerBound UpperBound alpha ## 1 gender==female  398  3811.092  2275.6410   6602.168  0.10 ## 2   gender==male 1482  8879.261  6261.5109  12930.760  0.10 ## 3    age==<40yrs 1769 10506.899  7297.2057  15580.151  0.05 ## 4    age==>40yrs  111  2183.454   787.0673   6464.016  0.05 list(   \"Stratum 1\" = netherlandsimmigrant$gender == \"male\"   &      netherlandsimmigrant$nation == \"Suriname\",    \"Stratum 2\" = netherlandsimmigrant$gender == \"female\" &      netherlandsimmigrant$nation == \"North Africa\" ) plot(basicModel, plotType = \"strata\") plot(modelInflated, plotType = \"strata\")"},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"sec-methods","dir":"Articles","previous_headings":"","what":"Classes and S3Methods","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"created number classes. main ones : singleRStaticCountData, singleRfamily, supplementary : popSizeEstResults, summarysingleRmargin summarysingleRStaticCountData, make possible extract relevant information regarding population size. instance, popSizeEst function can used extract information estimated size population given : resulting object popEst popSizeEstResults class contains following fields: pointEstimate, variance â€“ numerics containing point estimate variance estimate. confidenceInterval â€“ data.frame confidence intervals. boot â€“ bootstrap performed numeric vector containing NÌ‚\\hat{N} values bootstrap, character vector value \"bootstrap performed\" otherwise. control â€“ controlPopVar object controls used obtain object. explicitly defined method popSizeEstResults, summarysingleRmargin summarysingleRStaticCountData classes print method, former one also accepts R primitives like coef: analogously glm stats. singleRfamily inherits family class stats explicitly defined print simulate methods. Example usage presented full list explicitly defined methods singleRStaticCountData methods presented Table .","code":"(popEst <- popSizeEst(basicModel)) ## Point estimate: 12690.35 ## Variance: 7885812 ## 95% confidence intervals: ##           lowerBound upperBound ## normal      7186.444   18194.26 ## logNormal   8431.275   19718.32 coef(summary(basicModel)) ##                        Estimate Std. Error    z value      P(>|z|) ## (Intercept)          -1.3410661  0.2148870 -6.2407965 4.353484e-10 ## gendermale            0.3971793  0.1630155  2.4364504 1.483220e-02 ## age>40yrs            -0.9746058  0.4082420 -2.3873235 1.697155e-02 ## nationAsia           -1.0925990  0.3016259 -3.6223642 2.919228e-04 ## nationNorth Africa    0.1899980  0.1940007  0.9793677 3.273983e-01 ## nationRest of Africa -0.9106361  0.3008092 -3.0272880 2.467587e-03 ## nationSurinam        -2.3363962  1.0135645 -2.3051282 2.115939e-02 ## nationTurkey         -1.6753917  0.6027744 -2.7794674 5.444812e-03 set.seed(1234567890) N <- 10000 gender <- rbinom(N, 1, 0.2) eta <- -1 + 0.5*gender counts <- simulate(ztpoisson(), eta = cbind(eta), seed = 1) summary(data.frame(gender, eta, counts)) ##      gender            eta              counts       ##  Min.   :0.0000   Min.   :-1.0000   Min.   :0.0000   ##  1st Qu.:0.0000   1st Qu.:-1.0000   1st Qu.:0.0000   ##  Median :0.0000   Median :-1.0000   Median :0.0000   ##  Mean   :0.2036   Mean   :-0.8982   Mean   :0.4196   ##  3rd Qu.:0.0000   3rd Qu.:-1.0000   3rd Qu.:1.0000   ##  Max.   :1.0000   Max.   :-0.5000   Max.   :5.0000"},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"concluding-remarks","dir":"Articles","previous_headings":"","what":"Concluding remarks","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"paper introduced singleRcapture package single source capture-recapture models. package implement state---art methods estimating population size based single data set multiple counts. package implements different methods account heterogeneity capture probabilities, modelled using covariates, well behavioural change, modelled using one-inflation. built package facilitate implementation new models using family objects; application exemplified Section 7. example implementing custom family described Section 8 presented replication materials. Furthermore, since many R users familiar countreg VGAM packages, implemented lightweight extension called singleRcaptureExtra, available Github (), can used integrate singleRcapture packages. future work plan implement Bayesian estimation using Stan (e.g.Â via brms package; Carpenter et al. (2017), BÃ¼rkner (2017)) one-inflation models can use recent approach proposed Tuoto, Di Cecco, Tancredi (2022) implement families using brms package.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"Acknowledgements","dir":"Articles","previous_headings":"","what":"Acknowledgements","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"authorsâ€™ work financed National Science Centre Poland, OPUS 20, grant . 2020/39/B/HS4/00941. authors like thank Peter van der Heijden, Maarten Cruyff, Dankmar BÃ¶hning, Åukasz Chrostowski Layna Dennett useful comments helped improve functionality package. addition, like thank Marcin Szymkowiak Tymon Åšwitalski valuable comments considerably improved paper.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"sec-estimatePopsizeFit","dir":"Articles","previous_headings":"Detailed information","what":"The estimatePopsizeFit function","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"section provide step--step description prepare data order use estimatePopsizeFit function, may useful users, e.g.Â wishing make modifications NÌ‚\\hat{N} estimate bootstrap. order show apply function fit one-inflated zero-truncated geometric model data BÃ¶hning et al. (2013) covariate dependency: log(Î»)=Î²1,1+Î²1,2log_distance+Î²1,3C_TYPE+Î²1,4log_size,logit(Ï‰)=Î²2,1+Î²2,2log_distance+Î²2,3C_TYPE.\\begin{align*}   \\log(\\lambda) &=   \\beta_{1, 1} + \\beta_{1, 2} \\text{log\\_distance} + \\beta_{1, 3} \\text{C\\_TYPE} +   \\beta_{1, 4} \\text{log\\_size}, \\\\   \\text{logit}(\\omega) &=   \\beta_{2, 1} + \\beta_{2, 2} \\text{log\\_distance} + \\beta_{2, 3} \\text{C\\_TYPE}. \\end{align*} equivalent following esimatePopsize call: Create data matrix ğ—vlm\\boldsymbol{X}_{\\text{vlm}} Fill first nn rows model.matrix according specified formula specify attribute attr(X, \"hwm\") informs function elements design matrix correspond linear predictor (covariates counts covariates one-inflation) Obtain starting ğ›ƒ\\boldsymbol{\\beta} parameters using glm.fit function. Use estimatePopsizeFit function fit model assuming zero-truncated one-inflated geometric distribution specified family argument. Compare results obtained applying stats::optim function. default maxiter parameter \"optim\" fitting 10001000, needed increase since optim converge 10001000 steps â€œgets stuckâ€ plateau, results lower log-likelihood value compared standard \"IRLS\". situation rather typical. conduct formal numerical analyses, seems one attempts model one parameter distribution covariate dependent optim algorithms, \"Nelder-Mead\" \"L-BFGS-B\" seem ill-suited task despite provided analytically computed gradient. one reasons \"IRLS\" default fitting method.","code":"estimatePopsize(   TOTAL_SUB ~ .,   data = farmsubmission,   model = oiztgeom(),   controlModel(     omegaFormula = ~ 1 + log_size + C_TYPE   ) ) X <- matrix(data = 0, nrow = 2 * NROW(farmsubmission), ncol = 7) X[1:NROW(farmsubmission), 1:4] <- model.matrix(   ~ 1 + log_size + log_distance + C_TYPE,    farmsubmission ) X[-(1:NROW(farmsubmission)), 5:7] <- model.matrix(   ~ 1 + log_distance + C_TYPE,    farmsubmission ) attr(X, \"hwm\") <- c(4, 3) start <- glm.fit(   y = farmsubmission$TOTAL_SUB,    x = X[1:NROW(farmsubmission), 1:4],    family = poisson() )$coefficients start ## [1] -0.82583943  0.33254499 -0.03277732  0.32746933 res <- estimatePopsizeFit(   y            = farmsubmission$TOTAL_SUB,    X            = X,    method       = \"IRLS\",    priorWeights = 1,    family       = oiztgeom(),    control      = controlMethod(silent = TRUE),    coefStart    = c(start, 0, 0, 0),   etaStart     = matrix(X %*% c(start, 0, 0, 0), ncol = 2),   offset       = cbind(rep(0, NROW(farmsubmission)),                         rep(0, NROW(farmsubmission))) ) ll <- oiztgeom()$makeMinusLogLike(y = farmsubmission$TOTAL_SUB, X = X) res2 <- estimatePopsizeFit(   y = farmsubmission$TOTAL_SUB,    X = X,    method = \"optim\",    priorWeights = 1,    family = oiztgeom(),    coefStart = c(start, 0, 0, 0),   control = controlMethod(silent = TRUE, maxiter = 10000),   offset = cbind(rep(0, NROW(farmsubmission)), rep(0, NROW(farmsubmission))) ) data.frame(IRLS  = round(c(res$beta, -ll(res$beta), res$iter), 4),            optim = round(c(res2$beta, -ll(res2$beta), res2$iter[1]), 4)) ##          IRLS       optim ## 1     -2.7845     -2.5971 ## 2      0.6170      0.6163 ## 3     -0.0646     -0.0825 ## 4      0.5346      0.5431 ## 5     -3.1745     -0.1504 ## 6      0.1281     -0.1586 ## 7     -1.0865     -1.0372 ## 8 -17278.7613 -17280.1189 ## 9     15.0000   1696.0000"},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"sec-family","dir":"Articles","previous_headings":"Detailed information","what":"Structure of a family function","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"section provide details regarding family object singleRcapture package. object contains additional parameters comparison standard family object stats package.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/articles/singleRcapture.html","id":"sec-custom","dir":"Articles","previous_headings":"","what":"Implementing a custom singleRcapture family function","title":"singleRcapture: An R Package for Single-Source Capture-Recapture Models","text":"Suppose want implement specific zero truncated family function singleRcapture, corresponds following â€œuntruncatedâ€ distribution: â„™[Y=y|Î»,Ï€]={1âˆ’12Î»âˆ’12Ï€when: y=012Ï€when: y=112Î»when: y=2,   \\mathbb{P}[Y=y|\\lambda, \\pi] = \\begin{cases}     1 - \\frac{1}{2}\\lambda - \\frac{1}{2}\\pi & \\text{: } y=0\\\\     \\frac{1}{2}\\pi & \\text{: } y=1\\\\     \\frac{1}{2}\\lambda & \\text{: } y=2,   \\end{cases} Î»,Ï€âˆˆ(0,1)\\lambda, \\pi\\\\left(0, 1\\right) dependent covariates. provide possible way implementing model, lambda, pi meaning 12Î»,12Ï€\\frac{1}{2}\\lambda,\\frac{1}{2}\\pi. provide simple example shows proposed approach works expected. quick tests shows us implementation fact works: link functions, singleRcapture:::singleRinternalcloglogLink, just internal functions singleRcapture compute link functions, inverses derivatives links inverse links third order: One , course, include code computing manually.","code":"myFamilyFunction <- function(lambdaLink = c(\"logit\", \"cloglog\", \"probit\"),                              piLink     = c(\"logit\", \"cloglog\", \"probit\"),                              ...) {   if (missing(lambdaLink)) lambdaLink <- \"logit\"   if (missing(piLink))         piLink <- \"logit\"    links <- list()   attr(links, \"linkNames\") <- c(lambdaLink, piLink)    lambdaLink <- switch(lambdaLink,                        \"logit\"   = singleRcapture:::singleRinternallogitLink,                        \"cloglog\" = singleRcapture:::singleRinternalcloglogLink,                        \"probit\"  = singleRcapture:::singleRinternalprobitLink   )    piLink <- switch(piLink,                    \"logit\"   = singleRcapture:::singleRinternallogitLink,                    \"cloglog\" = singleRcapture:::singleRinternalcloglogLink,                    \"probit\"  = singleRcapture:::singleRinternalprobitLink   )    links[1:2] <- c(lambdaLink, piLink)    mu.eta <- function(eta, type = \"trunc\", deriv = FALSE, ...) {     pi     <-     piLink(eta[, 2], inverse = TRUE) / 2     lambda <- lambdaLink(eta[, 1], inverse = TRUE) / 2      if (!deriv) {       switch (type,               \"nontrunc\" = pi + 2 * lambda,               \"trunc\" = 1 + lambda / (pi + lambda)       )     } else {       # Only necessary if one wishes to use standard errors in predict method       switch (type,               \"nontrunc\" = {                 matrix(c(2, 1) * c(                   lambdaLink(eta[, 1], inverse = TRUE, deriv = 1) / 2,                   piLink(eta[, 2], inverse = TRUE, deriv = 1) / 2                 ), ncol = 2)               },               \"trunc\" = {                 matrix(c(                   pi / (pi + lambda) ^ 2,                   -lambda / (pi + lambda) ^ 2                 ) * c(                   lambdaLink(eta[, 1], inverse = TRUE, deriv = 1) / 2,                   piLink(eta[, 2], inverse = TRUE, deriv = 1) / 2                 ), ncol = 2)               }       )     }   }    variance <- function(eta, type = \"nontrunc\", ...) {     pi     <-     piLink(eta[, 2], inverse = TRUE) / 2     lambda <- lambdaLink(eta[, 1], inverse = TRUE) / 2      switch (type,             \"nontrunc\" = pi * (1 - pi) + 4 * lambda * (1 - lambda - pi),             \"trunc\" = lambda * (1 - lambda) / (pi + lambda)     )   }    Wfun <- function(prior, y, eta, ...) {     pi     <-     piLink(eta[, 2], inverse = TRUE) / 2     lambda <- lambdaLink(eta[, 1], inverse = TRUE) / 2      G01 <- ((lambda + pi) ^ (-2)) * piLink(eta[, 2], inverse = TRUE, deriv = 1) *       lambdaLink(eta[, 1], inverse = TRUE, deriv = 1) * prior / 4      G00 <- ((lambda + pi) ^ (-2)) - (pi ^ (-2)) - lambda / ((lambda + pi) * (pi ^ 2))     G00 <- G00 * prior * (piLink(eta[, 2], inverse = TRUE, deriv = 1) ^ 2) / 4      G11 <- ((lambda + pi) ^ (-2)) - (((lambda + pi) * lambda) ^ -1)     G11 <- G11 * prior * (lambdaLink(eta[, 1], inverse = TRUE, deriv = 1) ^ 2) / 4      matrix(       -c(G11, # lambda          G01, # mixed          G01, # mixed          G00  # pi       ),       dimnames = list(rownames(eta), c(\"lambda\", \"mixed\", \"mixed\", \"pi\")),       ncol = 4     )   }    funcZ <- function(eta, weight, y, prior, ...) {     pi     <-     piLink(eta[, 2], inverse = TRUE) / 2     lambda <- lambdaLink(eta[, 1], inverse = TRUE) / 2      weight <- weight / prior      G0 <- (2 - y) / pi     - ((lambda + pi) ^ -1)     G1 <- (y - 1) / lambda - ((lambda + pi) ^ -1)      G1 <- G1 * lambdaLink(eta[, 1], inverse = TRUE, deriv = 1) / 2     G0 <- G0 *     piLink(eta[, 2], inverse = TRUE, deriv = 1) / 2      uMatrix <- matrix(c(G1, G0), ncol = 2)      weight <- lapply(X = 1:nrow(weight), FUN = function (x) {       matrix(as.numeric(weight[x, ]), ncol = 2)     })      pseudoResid <- sapply(X = 1:length(weight), FUN = function (x) {       #xx <- chol2inv(chol(weight[[x]])) # less computationally demanding       xx <- solve(weight[[x]]) # more stable       xx %*% uMatrix[x, ]     })     pseudoResid <- t(pseudoResid)     dimnames(pseudoResid) <- dimnames(eta)     pseudoResid   }    minusLogLike <- function(y, X, offset,                            weight    = 1,                            NbyK      = FALSE,                            vectorDer = FALSE,                            deriv     = 0,                            ...) {     y <- as.numeric(y)     if (is.null(weight)) {       weight <- 1     }     if (missing(offset)) {       offset <- cbind(rep(0, NROW(X) / 2), rep(0, NROW(X) / 2))     }      if (!(deriv %in% c(0, 1, 2)))       stop(\"Only score function and derivatives up to 2 are supported.\")     deriv <- deriv + 1      switch (deriv,             function(beta) {               eta <- matrix(as.matrix(X) %*% beta, ncol = 2) + offset               pi     <-     piLink(eta[, 2], inverse = TRUE) / 2               lambda <- lambdaLink(eta[, 1], inverse = TRUE) / 2               -sum(weight * ((2 - y) * log(pi) + (y - 1) * log(lambda) - log(pi + lambda)))             },             function(beta) {               eta <- matrix(as.matrix(X) %*% beta, ncol = 2) + offset               pi     <-     piLink(eta[, 2], inverse = TRUE) / 2               lambda <- lambdaLink(eta[, 1], inverse = TRUE) / 2                G0 <- (2 - y) / pi     - ((lambda + pi) ^ -1)               G1 <- (y - 1) / lambda - ((lambda + pi) ^ -1)                G1 <- G1 * weight * lambdaLink(eta[, 1], inverse = TRUE, deriv = 1) / 2               G0 <- G0 * weight *     piLink(eta[, 2], inverse = TRUE, deriv = 1) / 2                if (NbyK) {                 XX <- 1:(attr(X, \"hwm\")[1])                 return(cbind(as.data.frame(X[1:nrow(eta), XX]) * G1,                              as.data.frame(X[-(1:nrow(eta)), -XX]) * G0))               }               if (vectorDer) {                 return(cbind(G1, G0))               }                as.numeric(c(G1, G0) %*% X)             },             function (beta) {               lambdaPredNumber <- attr(X, \"hwm\")[1]               eta <- matrix(as.matrix(X) %*% beta, ncol = 2) + offset               pi     <-     piLink(eta[, 2], inverse = TRUE) / 2               lambda <- lambdaLink(eta[, 1], inverse = TRUE) / 2                res <- matrix(nrow = length(beta), ncol = length(beta),                             dimnames = list(names(beta), names(beta)))                # pi^2 derivative               dpi <- (2 - y) / pi - (lambda + pi) ^ -1               G00 <- ((lambda + pi) ^ (-2)) - (2 - y) / (pi ^ 2)                G00 <- t(as.data.frame(X[-(1:(nrow(X) / 2)), -(1:lambdaPredNumber)] *                                        (G00 * ((piLink(eta[, 2], inverse = TRUE, deriv = 1) / 2) ^ 2) +                                           dpi * piLink(eta[, 2], inverse = TRUE, deriv = 2) / 2) * weight)) %*%                 as.matrix(X[-(1:(nrow(X) / 2)), -(1:lambdaPredNumber)])               # mixed derivative               G01 <- (lambda + pi) ^ (-2)                G01 <- t(as.data.frame(X[1:(nrow(X) / 2), 1:lambdaPredNumber]) *                          G01 * (lambdaLink(eta[, 1], inverse = TRUE, deriv = 1) / 2) *                          (piLink(eta[, 2], inverse = TRUE, deriv = 1) / 2) * weight) %*%                 as.matrix(X[-(1:(nrow(X) / 2)), -(1:lambdaPredNumber)])               # lambda^2 derivative               G11 <- ((lambda + pi) ^ (-2)) - (y - 1) / (lambda ^ 2)               dlambda <- (y - 1) / lambda - ((lambda + pi) ^ -1)                G11 <- t(as.data.frame(X[1:(nrow(X) / 2), 1:lambdaPredNumber] *                                        (G11 * ((lambdaLink(eta[, 1], inverse = TRUE, deriv = 1) / 2) ^ 2) +                                           dlambda * lambdaLink(eta[, 1], inverse = TRUE, deriv = 2) / 2) * weight)) %*%                 X[1:(nrow(X) / 2), 1:lambdaPredNumber]                res[-(1:lambdaPredNumber), -(1:lambdaPredNumber)] <- G00               res[1:lambdaPredNumber, 1:lambdaPredNumber] <- G11               res[1:lambdaPredNumber, -(1:lambdaPredNumber)] <- t(G01)               res[-(1:lambdaPredNumber), 1:lambdaPredNumber] <- G01                res             }     )   }    validmu <- function(mu) {     (sum(!is.finite(mu)) == 0) && all(0 < mu) && all(2 > mu)   }    # this is optional   devResids <- function(y, eta, wt, ...) {     0   }    pointEst <- function (pw, eta, contr = FALSE, ...) {     pi     <-     piLink(eta[, 2], inverse = TRUE) / 2     lambda <- lambdaLink(eta[, 1], inverse = TRUE) / 2     N <- pw / (lambda + pi)     if(!contr) {       N <- sum(N)     }     N   }    popVar <- function (pw, eta, cov, Xvlm, ...) {     pi     <-     piLink(eta[, 2], inverse = TRUE) / 2     lambda <- lambdaLink(eta[, 1], inverse = TRUE) / 2      bigTheta1 <- -pw / (pi + lambda) ^ 2 # w.r to pi     bigTheta1 <- bigTheta1 * piLink(eta[, 2], inverse = TRUE, deriv = 1) / 2     bigTheta2 <- -pw / (pi + lambda) ^ 2 # w.r to lambda     bigTheta2 <- bigTheta2 * lambdaLink(eta[, 1], inverse = TRUE, deriv = 1) / 2 # w.r to lambda      bigTheta <- t(c(bigTheta2, bigTheta1) %*% Xvlm)      f1 <- t(bigTheta) %*% as.matrix(cov) %*% bigTheta      f2 <- sum(pw * (1 - pi - lambda) / ((pi + lambda) ^ 2))      f1 + f2   }    dFun <- function (x, eta, type = c(\"trunc\", \"nontrunc\")) {     if (missing(type)) type <- \"trunc\"     pi     <-     piLink(eta[, 2], inverse = TRUE) / 2     lambda <- lambdaLink(eta[, 1], inverse = TRUE) / 2      switch (type,             \"trunc\" = {               (pi * as.numeric(x == 1) + lambda * as.numeric(x == 2)) / (pi + lambda)             },             \"nontrunc\" = {               (1 - pi - lambda) * as.numeric(x == 0) +                 pi * as.numeric(x == 1) + lambda * as.numeric(x == 2)             }     )   }    simulate <- function(n, eta, lower = 0, upper = Inf) {     pi     <-     piLink(eta[, 2], inverse = TRUE) / 2     lambda <- lambdaLink(eta[, 1], inverse = TRUE) / 2     CDF <- function(x) {       ifelse(x == Inf, 1,              ifelse(x < 0, 0,                     ifelse(x < 1, 1 - pi - lambda,                            ifelse(x < 2, 1 - lambda, 1))))     }     lb <- CDF(lower)     ub <- CDF(upper)     p_u <- stats::runif(n, lb, ub)     sims <- rep(0, n)     cond <- CDF(sims) <= p_u     while (any(cond)) {       sims[cond] <- sims[cond] + 1       cond <- CDF(sims) <= p_u     }     sims   }    getStart <- expression(     if (method == \"IRLS\") {       etaStart <- cbind(         family$links[[1]](mean(observed == 2) * (1 + 0 * (observed == 2))), # lambda         family$links[[2]](mean(observed == 1) * (1 + 0 * (observed == 1)))  # pi       ) + offset     } else if (method == \"optim\") {       init <- c(         family$links[[1]](weighted.mean(observed == 2, priorWeights) * 1 + .0001),         family$links[[2]](weighted.mean(observed == 1, priorWeights) * 1 + .0001)       )       if (attr(terms, \"intercept\")) {         coefStart <- c(init[1], rep(0, attr(Xvlm, \"hwm\")[1] - 1))       } else {         coefStart <- rep(init[1] / attr(Xvlm, \"hwm\")[1], attr(Xvlm, \"hwm\")[1])       }       if (\"(Intercept):pi\" %in% colnames(Xvlm)) {         coefStart <- c(coefStart, init[2], rep(0, attr(Xvlm, \"hwm\")[2] - 1))       } else {         coefStart <- c(coefStart, rep(init[2] / attr(Xvlm, \"hwm\")[2], attr(Xvlm, \"hwm\")[2]))       }     }   )    structure(     list(       makeMinusLogLike = minusLogLike,       densityFunction  = dFun,       links     = links,       mu.eta    = mu.eta,       valideta  = function (eta) {TRUE},       variance  = variance,       Wfun      = Wfun,       funcZ     = funcZ,       devResids = devResids,       validmu   = validmu,       pointEst  = pointEst,       popVar    = popVar,       family    = \"myFamilyFunction\",       etaNames  = c(\"lambda\", \"pi\"),       simulate  = simulate,       getStart  = getStart,       extraInfo = c(         mean       = \"pi / 2 + lambda\",         variance   = paste0(\"(pi / 2) * (1 - pi / 2) + 2 * lambda * (1 - lambda / 2 - pi / 2)\"),         popSizeEst = \"(1 - (pi + lambda) / 2) ^ -1\",         meanTr     = \"1 + lambda / (pi + lambda)\",         varianceTr = paste0(\"lambda * (1 - lambda / 2) / (pi + lambda)\")       )     ),     class = c(\"singleRfamily\", \"family\")   ) } set.seed(123) Y <- simulate(   myFamilyFunction(lambdaLink = \"logit\", piLink = \"logit\"),   nsim = 1000, eta = matrix(0, nrow = 1000, ncol = 2),   truncated = FALSE ) mm <- estimatePopsize(   formula = Y ~ 1,   data = data.frame(Y = Y[Y > 0]),   model = myFamilyFunction(lambdaLink = \"logit\",                            piLink = \"logit\"),   # the usual observed information matrix   # is ill-suited for this distribution   controlPopVar = controlPopVar(covType = \"Fisher\") ) summary(mm) ##  ## Call: ## estimatePopsize.default(formula = Y ~ 1, data = data.frame(Y = Y[Y >  ##     0]), model = myFamilyFunction(lambdaLink = \"logit\", piLink = \"logit\"),  ##     controlPopVar = controlPopVar(covType = \"Fisher\")) ##  ## Pearson Residuals: ##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  ## -0.8198 -0.8198  0.8099  0.0000  0.8099  0.8099  ##  ## Coefficients: ## ----------------------- ## For linear predictors associated with: lambda  ##             Estimate Std. Error z value P(>|z|) ## (Intercept)  0.01217    0.20253    0.06   0.952 ## ----------------------- ## For linear predictors associated with: pi  ##             Estimate Std. Error z value P(>|z|) ## (Intercept) -0.01217    0.08926  -0.136   0.892 ##  ## AIC: 687.4249 ## BIC: 695.8259 ## Residual deviance: 0 ##  ## Log-likelihood: -341.7124 on 984 Degrees of freedom  ## Number of iterations: 2 ## ----------------------- ## Population size estimation results:  ## Point estimate 986 ## Observed proportion: 50% (N obs = 493) ## Std. Error 70.30092 ## 95% CI for the population size: ##           lowerBound upperBound ## normal      848.2127   1123.787 ## logNormal   866.3167   1144.053 ## 95% CI for the share of observed population: ##           lowerBound upperBound ## normal      43.86951   58.12221 ## logNormal   43.09241   56.90759 singleRcapture:::singleRinternalcloglogLink ## function (x, inverse = FALSE, deriv = 0)  ## { ##     deriv <- deriv + 1 ##     if (isFALSE(inverse)) { ##         res <- switch(deriv, log(-log(1 - x)), -1/((1 - x) *  ##             log(1 - x)), -(1 + log(1 - x))/((x - 1)^2 * log(1 -  ##             x)^2), (2 * log(1 - x)^2 + 3 * log(1 - x) + 2)/(log(1 -  ##             x)^3 * (x - 1)^3)) ##     } ##     else { ##         res <- switch(deriv, 1 - exp(-exp(x)), exp(x - exp(x)),  ##             (1 - exp(x)) * exp(x - exp(x)), (exp(2 * x) - 3 *  ##                 exp(x) + 1) * exp(x - exp(x))) ##     } ##     res ## } ## <bytecode: 0x55f54fa7d3d0> ## <environment: namespace:singleRcapture>"},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Piotr Chlebicki. Author, contributor. Maciej BerÄ™sewicz. Author, maintainer.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Chlebicki P, Ber\\c{e}sewicz M (2025). â€œsingleRcapture: R Package Single-Source Capture-Recapture Models.â€ Journal Statistical Software, 115(1), 1â€“30. \\Sexpr[results=rd]{tools:::Rd_expr_doi(\"10.18637/jss.v115.i01\")}.","code":"@Article{,   title = {{singleRcapture}: An {R} Package for Single-Source Capture-Recapture Models},   author = {Piotr Chlebicki and Maciej Ber\\c{e}sewicz},   journal = {Journal of Statistical Software},   year = {2025},   volume = {115},   number = {1},   pages = {1--30},   doi = {10.18637/jss.v115.i01}, }"},{"path":"https://ncn-foreigners.github.io/singleRcapture/index.html","id":"singlercapture-an-r-package-for-single-source-capture-recapture-models-","dir":"","previous_headings":"","what":"Single-Source Capture-Recapture Models","title":"Single-Source Capture-Recapture Models","text":"Capture-recapture type experiments used estimate total population size situations observing part population feasible. recent years types experiments seen interest. Single-source models distinct capture-recapture models estimate population size based many units observed two three sources standard approach. Instead single-source models utilize count data regression models positive distributions (.e.Â counts greater 0) dependent variable number times particular unit observed source data. package aims implement already existing introduce new methods estimating population size single source simplify research process. Currently, implemented frequentist approaches used literature : Zero-truncated Poisson, geometric negative binomial regression. Zero-truncated one-inflated one-inflated zero-truncated Poisson, geometric negative binomial model. Zero-one-truncated Poisson, geometric negative binomial models. Generalized Chaoâ€™s Zeltermanâ€™s models based logistic regression. Three types bootstrap parametric, semi-parametric nonparametric. wide range additional functionalities associated (vector) generalized linear models relevant topic. details see singleRcapture: R Package Single-Source Capture-Recapture Models vignette CRAN pkgdown website.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Single-Source Capture-Recapture Models","text":"can install current version singleRcapture package main branch GitHub : install stable version CRAN :","code":"# install.packages(\"devtools\") remotes::install_github(\"ncn-foreigners/singleRcapture\") install.packages(singleRcapture)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/index.html","id":"examples","dir":"","previous_headings":"Installation","what":"Examples","title":"Single-Source Capture-Recapture Models","text":"main function package estimatePopsize fitts regression specified distribution uses fitted regression estimate population size. Lets look model 2003 publication (Van Der Heijden, P. G., Bustami, R., Cruyff, M. J., Engbersen, G., & Van Houwelingen, H. C. (2003). Point interval estimation population size using truncated Poisson regression model. Statistical Modelling, 3(4), 305-322.). call estimatePopsize look similar anyone used stats::glm function: implemented method plot function visualise model fit useful diagnostic information. One rootogram, type plot compares fitted observed marginal frequencies:  possible values plotType argument : qq - normal quantile-quantile plot pearson residuals (default), marginal - matplot comparing fitted observed marginal frequencies, fitresid - plot linear predictor values contrasted pearson residuals, bootHist - histogram bootstrap sample, rootogram - rootogram, example presented , dfpopContr - contrasting two deletion effects identify presence influential observations, dfpopBox - boxplot results dfpopsize function see documentation, scaleLoc - scale-location plot, cooks - plot cooks.values distributions defined, hatplot - plot hatvalues, strata - plot confidence intervals selected populations. User can also pass arguments specify additional information plot title, subtitle etc. similar calling plot data. info check plot.singleR method documentation. seen significant differences fitted observed marginal frequencies. check intuition letâ€™s perform goodness fit test fitted observed marginal frequencies. call summary function marginalFreq function computes marginal frequencies fitted singleR class object: Finally let us check influential observations. comparing deletion effect every observation population size estimate removing entirely model (population size estimate regression) omitting pop size estimation (called contribution observation). observation influential two actions approximately effect:  easy deduce plot influential observations dataset (one particular). Lastly singleRcapture offers post-hoc procedures example function stratifyPopsize estimates sizes user specified sub populations returns data.frame: strata argument may specified various ways example: package designed convenience mind, example possible specify weights provided call interpreted number occurrences units row: Methods regression diagnostics adjusted (values weights reduced instead rows removed etc.) also included option use common non standard argument significance levels different usual 5%: option estimate standard error population size estimate bootstrap, models one distribution parameter dependent covariates non standard link functions example: results significantly different (warning issued concerns second derivative test existence local minimum, inconclusive manually checked fitting process found optimal regression coefficients â€™s provide information user):  information criteria support second model:","code":"library(singleRcapture) model <- estimatePopsize(   formula = capture ~ gender + age + nation, # specify formula   data = netherlandsimmigrant,   popVar = \"analytic\", # specify    model = \"ztpoisson\", # distribution used   method = \"IRLS\", # fitting method one of three currently supported   controlMethod = controlMethod(silent = TRUE) # ignore convergence at half step warning ) summary(model) # a summary method for singleR class with standard glm-like output and population size estimation resutls #>  #> Call: #> estimatePopsize.default(formula = capture ~ gender + age + nation,  #>     data = netherlandsimmigrant, model = \"ztpoisson\", method = \"IRLS\",  #>     popVar = \"analytic\", controlMethod = controlMethod(silent = TRUE)) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.486442 -0.486442 -0.298080  0.002093 -0.209444 13.910844  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.3411     0.2149  -6.241 4.35e-10 *** #> gendermale             0.3972     0.1630   2.436 0.014832 *   #> age>40yrs             -0.9746     0.4082  -2.387 0.016972 *   #> nationAsia            -1.0926     0.3016  -3.622 0.000292 *** #> nationNorth Africa     0.1900     0.1940   0.979 0.327398     #> nationRest of Africa  -0.9106     0.3008  -3.027 0.002468 **  #> nationSurinam         -2.3364     1.0136  -2.305 0.021159 *   #> nationTurkey          -1.6754     0.6028  -2.779 0.005445 **  #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> AIC: 1712.901 #> BIC: 1757.213 #> Residual deviance: 1128.553 #>  #> Log-likelihood: -848.4504 on 1872 Degrees of freedom  #> Number of iterations: 8 #> ----------------------- #> Population size estimation results:  #> Point estimate 12690.35 #> Observed proportion: 14.8% (N obs = 1880) #> Std. Error 2808.165 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      7186.449   18194.25 #> logNormal   8431.277   19718.31 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal     10.332933   26.16035 #> logNormal   9.534288   22.29793 plot(model, plotType = \"rootogram\") summary(marginalFreq(model), df = 2, dropl5 = \"group\") #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           50.06  2 1.3e-11 #> G-test                     34.31  2 3.6e-08 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been grouped  #> Names of cells used in calculating test(s) statistic: 1 2 3 plot(model, plotType = \"dfpopContr\") stratifyPopsize(model, alpha = c(.01, .02, .03, .05), # different significance level for each sub population     strata = list(     \"Females from Surinam\" = netherlandsimmigrant$gender == \"female\" & netherlandsimmigrant$nation == \"Surinam\",     \"Males from Turkey\" = netherlandsimmigrant$gender == \"male\" & netherlandsimmigrant$nation == \"Turkey\",     \"Younger males\" = netherlandsimmigrant$gender == \"male\" & netherlandsimmigrant$age == \"<40yrs\",     \"Older males\" = netherlandsimmigrant$gender == \"male\" & netherlandsimmigrant$age == \">40yrs\" )) #>                   name Observed Estimated ObservedPercentage  StdError #> 1 Females from Surinam       20  931.4677           2.147149  955.0657 #> 2    Males from Turkey       78 1291.2513           6.040652  741.0066 #> 3        Younger males     1391 7337.0708          18.958520 1282.1402 #> 4          Older males       91 1542.1886           5.900705  781.4747 #>   normalLowerBound normalUpperBound logNormalLowerBound logNormalUpperBound #> 1      -1528.61853         3391.554            119.2661            8389.158 #> 2       -432.58790         3015.090            405.4127            4573.791 #> 3       4554.71057        10119.431           5134.8122           10834.785 #> 4         10.52637         3073.851            630.7551            3992.674 #>   confLevel #> 1      0.01 #> 2      0.02 #> 3      0.03 #> 4      0.05 stratifyPopsize(model, strata = ~ gender / age) #>                     name Observed Estimated ObservedPercentage  StdError #> 1         gender==female      398 3811.0911          10.443203 1153.9733 #> 2           gender==male     1482 8879.2594          16.690581 1812.0790 #> 3 genderfemale:age<40yrs      378 3169.8263          11.924944  880.9478 #> 4   gendermale:age<40yrs     1391 7337.0708          18.958520 1282.1402 #> 5 genderfemale:age>40yrs       20  641.2648           3.118836  407.5264 #> 6   gendermale:age>40yrs       91 1542.1886           5.900705  781.4747 #>   normalLowerBound normalUpperBound logNormalLowerBound logNormalUpperBound #> 1       1549.34513         6072.837           2189.0443            6902.133 #> 2       5327.64991        12430.869           6090.7762           13354.880 #> 3       1443.20030         4896.452           1904.3126            5484.617 #> 4       4824.12208         9850.019           5306.3306           10421.082 #> 5       -157.47223         1440.002            212.3382            2026.726 #> 6         10.52637         3073.851            630.7551            3992.674 #>   confLevel #> 1      0.05 #> 2      0.05 #> 3      0.05 #> 4      0.05 #> 5      0.05 #> 6      0.05 df <- netherlandsimmigrant[, c(1:3,5)] df$ww <- 0 ### this is dplyr::count without dependencies df <- aggregate(ww ~ ., df, FUN = length) summary(estimatePopsize(   formula = capture ~ nation + age + gender,    data = df,    model = ztpoisson,    weights = df$ww,   controlModel = controlModel(weightsAsCounts = TRUE) )) #>  #> Call: #> estimatePopsize.default(formula = capture ~ nation + age + gender,  #>     data = df, model = ztpoisson, weights = df$ww, controlModel = controlModel(weightsAsCounts = TRUE)) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -317.6467   -2.4060    3.7702    0.0803   13.4920  183.2108  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.3411     0.2149  -6.241 4.35e-10 *** #> nationAsia            -1.0926     0.3016  -3.622 0.000292 *** #> nationNorth Africa     0.1900     0.1940   0.979 0.327398     #> nationRest of Africa  -0.9106     0.3008  -3.027 0.002468 **  #> nationSurinam         -2.3364     1.0136  -2.305 0.021159 *   #> nationTurkey          -1.6754     0.6028  -2.779 0.005445 **  #> age>40yrs             -0.9746     0.4082  -2.387 0.016972 *   #> gendermale             0.3972     0.1630   2.436 0.014832 *   #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> AIC: 1712.901 #> BIC: 1757.213 #> Residual deviance: 1128.553 #>  #> Log-likelihood: -848.4504 on 1872 Degrees of freedom  #> Number of iterations: 8 #> ----------------------- #> Population size estimation results:  #> Point estimate 12690.35 #> Observed proportion: 14.8% (N obs = 1880) #> Std. Error 2808.169 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      7186.444   18194.26 #> logNormal   8431.275   19718.32 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal     10.332927   26.16037 #> logNormal   9.534281   22.29793 set.seed(123) modelInflated <- estimatePopsize(     formula = capture ~ gender + age,     data = netherlandsimmigrant,     model = \"ztoigeom\",     method = \"IRLS\",     # control parameters for population size estimation check documentation of controlPopVar     controlPopVar = controlPopVar(         alpha = .01, # significance level      ) ) summary(modelInflated) #>  #> Call: #> estimatePopsize.default(formula = capture ~ gender + age, data = netherlandsimmigrant,  #>     model = \"ztoigeom\", method = \"IRLS\", controlPopVar = controlPopVar(alpha = 0.01,  #>         )) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.357193 -0.357193 -0.357193  0.000343 -0.287637 10.233608  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>             Estimate Std. Error z value P(>|z|)     #> (Intercept)  -1.5346     0.1846  -8.312 < 2e-16 *** #> gendermale    0.3863     0.1380   2.800 0.00512 **  #> age>40yrs    -0.7788     0.2942  -2.648 0.00810 **  #> ----------------------- #> For linear predictors associated with: omega  #>             Estimate Std. Error z value  P(>|z|)     #> (Intercept)  -1.7591     0.3765  -4.673 2.97e-06 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> AIC: 1736.854 #> BIC: 1759.01 #> Residual deviance: 1011.271 #>  #> Log-likelihood: -864.4272 on 3756 Degrees of freedom  #> Number of iterations: 6 #> ----------------------- #> Population size estimation results:  #> Point estimate 5661.522 #> Observed proportion: 33.2% (N obs = 1880) #> Std. Error 963.9024 #> 99% CI for the population size: #>           lowerBound upperBound #> normal      3178.674   8144.370 #> logNormal   3861.508   9096.681 #> 99% CI for the share of observed population: #>           lowerBound upperBound #> normal      23.08343   59.14416 #> logNormal   20.66688   48.68564 modelInflated2 <- estimatePopsize(     formula = capture ~ age,     data = netherlandsimmigrant,     popVar = \"bootstrap\",     model = ztoigeom(omegaLink = \"cloglog\"),     method = \"IRLS\",     controlPopVar = controlPopVar(         B = 500,# number of boostrap samples         alpha = .01, # significance level          # type of bootstrap see documentation for estimatePopsize         bootType = \"semiparametric\",         # control regression fitting on bootstrap samples         bootstrapFitcontrol = controlMethod(           epsilon = .Machine$double.eps,            silent = TRUE,            stepsize = 2         )     ),     controlModel = controlModel(omegaFormula = ~ gender) # put covariates on omega i.e. the inflation parameter ) #> Warning in estimatePopsize.default(formula = capture ~ age, data = netherlandsimmigrant, : The (analytically computed) hessian of the score function is not negative define. #> NOTE: Second derivative test failing does not  #>         necessarily mean that the maximum of score function that was found  #>         numericaly is invalid since R^k is not a bounded space. #> Additionally in one inflated and hurdle models second derivative test often fails even on valid arguments. #> Warning in estimatePopsize.default(formula = capture ~ age, data = #> netherlandsimmigrant, : Switching from observed information matrix to Fisher #> information matrix because hessian of log-likelihood is not negative define. popSizeEst(modelInflated2) #> Point estimate: 5496.376 #> Variance: 1217986 #> 99% confidence intervals: #> lowerBound upperBound  #>   4002.763  10231.716 plot(modelInflated2,       plotType = \"bootHist\",       labels = TRUE,       ylim = c(0, 175),      breaks = 15) #>  First model: AIC = 1736.854 BIC = 1759.01 #> Second model: AIC = 1734.803 BIC = 1756.959"},{"path":"https://ncn-foreigners.github.io/singleRcapture/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"Single-Source Capture-Recapture Models","text":"Work package supported National Science Centre, OPUS 20 grant . 2020/39/B/HS4/00941.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/carcassubmission.html","id":null,"dir":"Reference","previous_headings":"","what":"The British farm carcass submissions data â€” carcassubmission","title":"The British farm carcass submissions data â€” carcassubmission","text":"Data British animal farms submissions AHVLA. British farms able submit samples AHVLA cause death animal determined private veterinary surgeon decides submit , unless notifiable disease suspected submission required. data set contains information farms. submissions included data frame submissions carcasses .e. submissions blood samples etc. excluded.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/carcassubmission.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The British farm carcass submissions data â€” carcassubmission","text":"","code":"data(\"carcassubmission\")"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/carcassubmission.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"The British farm carcass submissions data â€” carcassubmission","text":"Data frame 1,858 rows 4 columns. TOTAL_SUB Number submissions animal carcasses. log_size Numerical value equal logarithm size farm. log_distance Numerical value equal logarithm distance nearest AHVLA center. C_TYPE Factor describing type activity farm animals used . Either Dairy Beef","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/carcassubmission.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The British farm carcass submissions data â€” carcassubmission","text":"data set description provided publication: BÃ¶hning, D., Vidal Diez, ., Lerdsuwansri, R., Viwatwongkasem, C., Arnold, M. (2013). \"generalization Chao's estimator covariate information\". Biometrics, 69(4), 1033-1042. doi:10.1111/biom.12082","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/confint.singleRStaticCountData.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence intervals for model parameters â€” confint.singleRStaticCountData","title":"Confidence intervals for model parameters â€” confint.singleRStaticCountData","text":"function computes studentized confidence intervals model coefficients.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/confint.singleRStaticCountData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence intervals for model parameters â€” confint.singleRStaticCountData","text":"","code":"# S3 method for class 'singleRStaticCountData' confint(object, parm, level = 0.95, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/confint.singleRStaticCountData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence intervals for model parameters â€” confint.singleRStaticCountData","text":"object object singleRStaticCountData class. parm names parameters confidence intervals computed, missing parameters considered. level confidence level intervals. ... currently nothing.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/confint.singleRStaticCountData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence intervals for model parameters â€” confint.singleRStaticCountData","text":"object named columns include upper lower limit confidence intervals.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":null,"dir":"Reference","previous_headings":"","what":"Control parameters for regression â€” controlMethod","title":"Control parameters for regression â€” controlMethod","text":"controlMethod constructs list necessary control parameters regression fitting estimatePopsizeFit estimatePopsize.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control parameters for regression â€” controlMethod","text":"","code":"controlMethod(   epsilon = 1e-08,   maxiter = 1000,   verbose = 0,   printEveryN = 1L,   coefStart = NULL,   etaStart = NULL,   optimMethod = \"Nelder-Mead\",   silent = FALSE,   optimPass = FALSE,   stepsize = 1,   checkDiagWeights = TRUE,   weightsEpsilon = 1e-08,   momentumFactor = 0,   saveIRLSlogs = FALSE,   momentumActivation = 5,   criterion = c(\"coef\", \"abstol\", \"reltol\") )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control parameters for regression â€” controlMethod","text":"epsilon tolerance level fitting algorithms default 1e-8. maxiter maximum number iterations. verbose numeric value indicating whether trace steps fitting algorithm IRLS fitting method different values verbose give following information: 1 â€“ Returns information number current iteration current log-likelihood. 2 â€“ Returns information vector regression parameters current iteration (). 3 â€“ Returns information reduction log-likelihood current iteration (). 4 â€“ Returns information value log-likelihood function gradient current iteration (). 5 â€“ Returns information convergence criterion values taken account considering convergence (). optim method chosen verbose passed stats::optim() trace. printEveryN integer value indicating often print information specified verbose, default set 1. coefStart, etaStart initial parameters regression coefficients linear predictors NULL. IRLS fitting etaStart needed coefStart provided converted etaStart, optim fitting coefStart necessary argument etaStart ignored. optimMethod method stats::optim() used  \"Nelder-Mead\" default . silent logical value, indicating whether warnings IRLS method suppressed. optimPass optional list parameters passed stats::optim(..., control = optimPass) FALSE list control parameters inferred parameters. stepsize IRLS, scaling updates beta vector lower value means slower convergence accuracy default 1. general fitting algorithm fails lowering value tends effective correcting . checkDiagWeights logical value indicating whether check diagonal elements working weights matrixes IRLS sufficiently positive matrixes positive defined. default TRUE. weightsEpsilon small number ensure positive definedness weights matrixes. matters checkDiagWeights set TRUE. default 1e-8. momentumFactor experimental parameter IRLS allowing taking previous step account current step, .e instead updating regression parameters : \\[\\boldsymbol{\\beta}_{()} = \\boldsymbol{\\beta}_{(-1)} + \\text{stepsize} \\cdot \\text{step}_{()}\\] update made : \\[ \\boldsymbol{\\beta}_{()} = \\boldsymbol{\\beta}_{(-1)} + \\text{stepsize} \\cdot (\\text{step}_{()} + \\text{momentum}\\cdot\\text{step}_{(-1)})\\] saveIRLSlogs logical value indicating information specified verbose saved output object, default FALSE. momentumActivation value log-likelihood reduction bellow momentum apply. criterion criterion used determine convergence IRLS, multiple values may provided. default c(\"coef\", \"abstol\").","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Control parameters for regression â€” controlMethod","text":"List selected parameters, also possible call list directly.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Control parameters for regression â€” controlMethod","text":"Piotr Chlebicki, Maciej BerÄ™sewicz MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}};","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Control parameters specific to some models â€” controlModel","title":"Control parameters specific to some models â€” controlModel","text":"controlModel constructs list necessary control parameters estimatePopsize either specific selected model fit anywhere else. Specifying additional formulas done using right hand side formula also now variables additional formulas also included \"main\" formula.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control parameters specific to some models â€” controlModel","text":"","code":"controlModel(   weightsAsCounts = FALSE,   omegaFormula = ~1,   alphaFormula = ~1,   piFormula = ~1 )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control parameters specific to some models â€” controlModel","text":"weightsAsCounts boolean value indicating whether treat weights argument number occurrences row data adjust necessary methods functionalities, like adjustments bootstrap decreasing weights dfbeta instead deleting rows data, accommodate form model specification. omegaFormula formula inflation parameter one inflated zero truncated zero truncated one inflated models. alphaFormula formula dispersion parameter negative binomial based models. piFormula formula probability parameter pseudo hurdle zero truncated zero truncated pseudo hurdle models.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Control parameters specific to some models â€” controlModel","text":"list selected parameters, also possible call list directly.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Control parameters specific to some models â€” controlModel","text":"Piotr Chlebicki, Maciej BerÄ™sewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":null,"dir":"Reference","previous_headings":"","what":"Control parameters for population size estimation â€” controlPopVar","title":"Control parameters for population size estimation â€” controlPopVar","text":"Creating control parameters population size estimation respective standard error variance estimation.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control parameters for population size estimation â€” controlPopVar","text":"","code":"controlPopVar(   alpha = 0.05,   bootType = c(\"parametric\", \"semiparametric\", \"nonparametric\"),   B = 500,   confType = c(\"percentilic\", \"normal\", \"basic\"),   keepbootStat = TRUE,   traceBootstrapSize = FALSE,   bootstrapVisualTrace = FALSE,   fittingMethod = c(\"optim\", \"IRLS\"),   bootstrapFitcontrol = NULL,   sd = c(\"sqrtVar\", \"normalMVUE\"),   covType = c(\"observedInform\", \"Fisher\"),   cores = 1L )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control parameters for population size estimation â€” controlPopVar","text":"alpha significance level, 0.05 used default. bootType bootstrap type used. Default \"parametric\", possible values : \"semiparametric\" \"nonparametric\". B number bootstrap samples performed (default 500). confType type confidence interval bootstrap confidence interval, \"percentile\" default. possibilities: \"studentized\" \"basic\". keepbootStat boolean value indicating whether keep vector statistics produced bootstrap. traceBootstrapSize boolean value indicating whether print size bootstrapped sample truncation semi- fully parametric bootstraps. bootstrapVisualTrace boolean value indicating whether plot bootstrap statistics real time cores = 1 cores > 1 instead indicates whether make progress bar. fittingMethod method used fitting models bootstrap samples. bootstrapFitcontrol control parameters regression works exactly like controlMethod fitting models bootstrap samples. sd character indicating compute standard deviation population size estimator either : \\[\\hat{\\sigma}=\\sqrt{\\hat{\\text{var}}(\\hat{N})}\\] sqrt (slightly biased \\(\\hat{N}\\) normal distribution) normalMVUE unbiased minimal variance estimator normal distribution: \\[\\hat{\\sigma}=\\sqrt{\\hat{\\text{var}}(\\hat{N})} \\frac{\\Gamma\\left(\\frac{N_{obs}-1}{2}\\right)}{\\Gamma\\left(\\frac{N_{obs}}{2}\\right)} \\sqrt{\\frac{N_{obs}}{2}}\\] ration involving gamma functions computed log gamma function. covType type covariance matrix regression parameters default observed information matrix. cores bootstrap , number processor cores used, number greater 1 activates code designed doParallel, foreach parallel packages. Note now using parallel computing makes tracing impossible traceBootstrapSize bootstrapVisualTrace parameters ignored case.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Control parameters for population size estimation â€” controlPopVar","text":"list selected parameters, also possible call list directly.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Control parameters for population size estimation â€” controlPopVar","text":"Piotr Chlebicki, Maciej BerÄ™sewicz MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}};","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":null,"dir":"Reference","previous_headings":"","what":"Single-source capture-recapture models â€” estimatePopsize","title":"Single-source capture-recapture models â€” estimatePopsize","text":"estimatePopsize first fits appropriate (v)glm model estimates full (observed unobserved) population size. types models assumed response vector (.e. dependent variable) corresponds number times given unit observed source. Population size usually estimated Horvitz-Thompson type estimator: \\[\\hat{N} = \\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)} = \\sum_{k=1}^{N_{obs}}\\frac{1}{1-\\mathbb{P}(Y_{k}=0)}\\] \\(I_{k}=I_{Y_{k} > 0}\\) indicator variables, value 1 kth unit observed least 0 otherwise.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single-source capture-recapture models â€” estimatePopsize","text":"","code":"estimatePopsize(formula, ...)  # Default S3 method estimatePopsize(   formula,   data,   model = c(\"ztpoisson\", \"ztnegbin\", \"ztgeom\", \"zotpoisson\", \"ztoipoisson\",     \"oiztpoisson\", \"ztHurdlepoisson\", \"Hurdleztpoisson\", \"zotnegbin\", \"ztoinegbin\",     \"oiztnegbin\", \"ztHurdlenegbin\", \"Hurdleztnegbin\", \"zotgeom\", \"ztoigeom\", \"oiztgeom\",     \"ztHurdlegeom\", \"ztHurdlegeom\", \"zelterman\", \"chao\"),   weights = NULL,   subset = NULL,   naAction = NULL,   method = c(\"optim\", \"IRLS\"),   popVar = c(\"analytic\", \"bootstrap\", \"noEst\"),   controlMethod = NULL,   controlModel = NULL,   controlPopVar = NULL,   modelFrame = TRUE,   x = FALSE,   y = TRUE,   contrasts = NULL,   ratioReg = FALSE,   offset,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single-source capture-recapture models â€” estimatePopsize","text":"formula formula model fitted, applied \"main\" linear predictor. single response models available. ... additional optional arguments passed methods eg. estimatePopsizeFit. data data frame object coercible data.frame class containing data regression population size estimation. model model regression population estimate full description singleRmodels(). weights optional object prior weights used fitting model. Can used specify number occurrences rows data see controlModel() subset logical vector indicating observations used regression population size estimation. evaluated data argument provided call. naAction yet implemented. method method fitting values currently supported: iteratively reweighted least squares (IRLS) maximum likelihood (optim). popVar method constructing confidence interval estimating standard error either analytic bootstrap. Bootstrap confidence interval type may specified controlPopVar. also third possible value noEst skips population size estimate together. controlMethod list indicating parameters use fitting model may constructed singleRcapture::controlMethod function. information included controlMethod(). controlModel list indicating additional formulas regression (like formula inflation parameter/dispersion parameter) may constructed singleRcapture::controlModel function. information eventually included controlModel(). controlPopVar list indicating parameters use estimating variance population size estimation may constructed singleRcapture::controlPopVar function. information included controlPopVar(). modelFrame, x, y logical values indicating whether return model matrix, dependent vector model matrix part output. contrasts yet implemented. ratioReg yet implemented offset matrix offset values number columns matching number distribution parameters providing offset values linear predictors.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single-source capture-recapture models â€” estimatePopsize","text":"Returns object class c(\"singleRStaticCountData\", \"singleR\", \"glm\", \"lm\") type list containing: y â€“ Vector dependent variable specified function call. X â€“ Model matrix specified function call. formula â€“ list formula provided call additional formulas specified controlModel. call â€“ Call matching original input. coefficients â€“ vector fitted coefficients regression. control â€“ list control parameters controlMethod controlModel, controlPopVar included populationSize. model â€“ Model estimation population size regression built, object class family. deviance â€“ Deviance model. priorWeights â€“ Prior weight provided call. weights â€“ IRLS method estimation chosen weights returned IRLS, otherwise priorWeights. residuals â€“ Vector raw residuals. logL â€“ Logarithm likelihood obtained final iteration. iter â€“ Numbers iterations performed fitting stats::optim used number call loglikelihood function. dfResiduals â€“ Residual degrees freedom. dfNull â€“ Null degrees freedom. fittValues â€“ Data frame fitted values mu (expected value) lambda (Poisson parameter). populationSize â€“ list containing information population size estimate. modelFrame â€“ Model frame specified call. linearPredictors â€“ Vector fitted linear predictors. sizeObserved â€“ Number observations original model frame. terms â€“ terms attribute model frame used. contrasts â€“ contrasts specified function call. naAction â€“ naAction used. â€“ list indicating observations used regression/population size estimation. fittingLog â€“ log fitting information \"IRLS\" fitting specified controlMethod.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Single-source capture-recapture models â€” estimatePopsize","text":"generalized linear model characterized equation \\[\\boldsymbol{\\eta}=\\boldsymbol{X}\\boldsymbol{\\beta}\\] \\(\\boldsymbol{X}\\) (lm) model matrix. vector generalized linear model similarly characterized equations \\[\\boldsymbol{\\eta}_{k}=\\boldsymbol{X}_{k}\\boldsymbol{\\beta}_{k}\\] \\(\\boldsymbol{X}_{k}\\) (lm) model matrix constructed appropriate formula (specified controlModel parameter). \\(\\boldsymbol{\\eta}\\) vector constructed : \\[\\boldsymbol{\\eta}=\\begin{pmatrix} \\boldsymbol{\\eta}_{1} \\cr \\boldsymbol{\\eta}_{2} \\cr \\dotso \\cr \\boldsymbol{\\eta}_{p} \\end{pmatrix}^{T}\\] cases models package (vlm) model matrix constructed block matrix: \\[\\boldsymbol{X}_{vlm}= \\begin{pmatrix} \\boldsymbol{X}_{1} & \\boldsymbol{0} &\\dotso &\\boldsymbol{0}\\cr \\boldsymbol{0} & \\boldsymbol{X}_{2} &\\dotso &\\boldsymbol{0}\\cr \\vdots & \\vdots & \\ddots & \\vdots\\cr \\boldsymbol{0} & \\boldsymbol{0} &\\dotso &\\boldsymbol{X}_{p} \\end{pmatrix}\\] differs convention VGAM package (consider special cases vglm models) just convention affect model, convention taken makes fitting IRLS (explanation algorithm estimatePopsizeFit()) algorithm easier. (constraints matrixes vglm match ones implicitly use vglm model matrix differs respect order kronecker multiplication X constraints.) package use observed likelihood fit regression models. mentioned usually population size estimation done via: \\[\\hat{N} = \\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)} = \\sum_{k=1}^{N_{obs}}\\frac{1}{1-\\mathbb{P}(Y_{k}=0)}\\] \\(I_{k}=I_{Y_{k} > 0}\\) indicator variables, value 1 kth unit observed least 0 otherwise. \\(\\mathbb{P}(Y_{k}>0)\\) estimated maximum likelihood. following assumptions usually present using method estimation described : specified regression model correct. entails linear relationship independent variables dependent ones dependent variable generated appropriate distribution. unobserved heterogeneity. assumption broken possible (admittedly imperfect) workarounds see details singleRmodels(). population size constant relevant time frame. Depending confidence interval construction (asymptotic) normality \\(\\hat{N}\\) statistic assumed. two ways estimating variance estimate \\(\\hat{N}\\), first \"analytic\" usually done application law total variance \\(\\hat{N}\\): \\[\\text{var}(\\hat{N})=\\mathbb{E}\\left(\\text{var} \\left(\\hat{N}|I_{1},\\dots,I_{n}\\right)\\right)+ \\text{var}\\left(\\mathbb{E}(\\hat{N}|I_{1},\\dots,I_{n})\\right)\\] \\(\\delta\\) method \\(\\hat{N}|I_{1},\\dots I_{N}\\): \\[\\mathbb{E}\\left(\\text{var} \\left(\\hat{N}|I_{1},\\dots,I_{n}\\right)\\right)= \\left.\\left(\\frac{\\partial(N|I_1,\\dots,I_N)}{\\partial\\boldsymbol{\\beta}}\\right)^{T} \\text{cov}\\left(\\boldsymbol{\\beta}\\right) \\left(\\frac{\\partial(N|I_1,\\dots,I_N)}{\\partial\\boldsymbol{\\beta}}\\right) \\right|_{\\boldsymbol{\\beta}=\\hat{\\boldsymbol{\\beta}}}\\] \\(\\text{var}\\left(\\mathbb{E}(\\hat{N}|I_{1},\\dots,I_{n})\\right)\\) term may derived analytically (assume independence observations) since \\(\\hat{N}|I_{1},\\dots,I_{n}\\) just constant. general gives us: \\[ \\begin{aligned} \\text{var}\\left(\\mathbb{E}(\\hat{N}|I_{1},\\dots,I_{n})\\right)&= \\text{var}\\left(\\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)}\\right)\\cr &=\\sum_{k=1}^{N}\\text{var}\\left(\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)}\\right)\\cr &=\\sum_{k=1}^{N}\\frac{1}{\\mathbb{P}(Y_{k}>0)^{2}}\\text{var}(I_{k})\\cr &=\\sum_{k=1}^{N}\\frac{1}{\\mathbb{P}(Y_{k}>0)^{2}}\\mathbb{P}(Y_{k}>0)(1-\\mathbb{P}(Y_{k}>0))\\cr &=\\sum_{k=1}^{N}\\frac{1}{\\mathbb{P}(Y_{k}>0)}(1-\\mathbb{P}(Y_{k}>0))\\cr &\\approx\\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)^{2}}(1-\\mathbb{P}(Y_{k}>0))\\cr &=\\sum_{k=1}^{N_{obs}}\\frac{1-\\mathbb{P}(Y_{k}>0)}{\\mathbb{P}(Y_{k}>0)^{2}} \\end{aligned} \\] approximation 6th line appears 5th line sum units, includes unobserved units, since \\(I_{k}\\) independent \\(I_{k}\\sim b(\\mathbb{P}(Y_{k}>0))\\) 6th line unbiased estimator 5th line. method estimating variance \"bootstrap\", since \\(N_{obs}=\\sum_{k=1}^{N}I_{k}\\) also random variable bootstrap simple just drawing \\(N_{obs}\\) units data replacement just computing \\(\\hat{N}\\). Method described referred literature \"nonparametric\" bootstrap (see controlPopVar()), due ignoring variability observed sample size likely underestimate variance. sophisticated bootstrap procedure may described follows: Compute probability distribution : \\[ \\frac{\\hat{\\boldsymbol{f}}_{0}}{\\hat{N}}, \\frac{\\boldsymbol{f}_{1}}{\\hat{N}}, \\dots, \\frac{\\boldsymbol{f}_{\\max{y}}}{\\hat{N}}\\] \\(\\boldsymbol{f}_{n}\\) denotes observed marginal frequency units observed exactly n times. Draw \\(\\hat{N}\\) units distribution (\\(\\hat{N}\\) integer draw \\(\\lfloor\\hat{N}\\rfloor + b(\\hat{N}-\\lfloor\\hat{N}\\rfloor)\\)), \\(\\lfloor\\cdot\\rfloor\\) floor function. Truncated units \\(y=0\\). covariates draw original data replacement uniform distribution. example unit drawn new data \\(y=2\\) choose one covariate vectors original data associated unit observed 2 times. Regress \\(\\boldsymbol{y}_{new}\\) \\(\\boldsymbol{X}_{vlm new}\\) obtain \\(\\hat{\\boldsymbol{\\beta}}_{new}\\), starting point \\(\\hat{\\boldsymbol{\\beta}}\\) make slightly faster, use compute \\(\\hat{N}_{new}\\). Repeat 2-5 unit least B statistics obtained. Compute confidence intervals based alpha confType specified controlPopVar(). step 1 procedure convenient first draw binary vector length \\(\\lfloor\\hat{N}\\rfloor + b(\\hat{N}-\\lfloor\\hat{N}\\rfloor)\\) probability \\(1-\\frac{\\hat{\\boldsymbol{f}}_{0}}{\\hat{N}}\\), sum elements vector determine sample size draw sample size uniformly data. procedure known literature \"semiparametric\" bootstrap necessary assume correct estimate \\(\\hat{N}\\) order use type bootstrap. Lastly \"paramteric\" bootstrap assume probabilistic model used obtain \\(\\hat{N}\\) correct bootstrap procedure may described : Draw \\(\\lfloor\\hat{N}\\rfloor + b(\\hat{N}-\\lfloor\\hat{N}\\rfloor)\\) covariate information vectors replacement data according probability distribution proportional : \\(N_{k}\\), \\(N_{k}\\) contribution kth unit .e. \\(\\dfrac{1}{\\mathbb{P}(Y_{k}>0)}\\). Determine \\(\\boldsymbol{\\eta}\\) matrix using estimate \\(\\hat{\\boldsymbol{\\beta}}\\). Generate \\(\\boldsymbol{y}\\) (dependent variable) vector using \\(\\boldsymbol{\\eta}\\) probability mass function associated chosen model. Truncated units \\(y=0\\) construct \\(\\boldsymbol{y}_{new}\\) \\(\\boldsymbol{X}_{vlm new}\\). Regress \\(\\boldsymbol{y}_{new}\\) \\(\\boldsymbol{X}_{vlm new}\\) obtain \\(\\hat{\\boldsymbol{\\beta}}_{new}\\) use compute \\(\\hat{N}_{new}\\). Repeat 1-5 unit least B statistics obtained. Compute confidence intervals based alpha confType specified controlPopVar() also worth noting \"analytic\" method estimatePopsize uses \"standard\" covariance matrix estimation. possible improper covariance matrix estimate part estimation assumptions violated. cases post-hoc procedures implemented package address issue. Lastly confidence intervals \\(\\hat{N}\\) computed (analytic case) either assuming follows normal distribution variable \\(\\ln(N-\\hat{N})\\) follows normal distribution. estimates may found using either summary.singleRStaticCountData method popSizeEst.singleRStaticCountData function. labelled normal logNormal respectively.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Single-source capture-recapture models â€” estimatePopsize","text":"General single source capture recapture literature: Zelterman, Daniel (1988). â€˜Robust estimation truncated discrete distributions application capture-recapture experimentsâ€™. : Journal statistical planning inference 18.2, pp. 225â€“237. Heijden, Peter GM van der et al. (2003). â€˜Point interval estimation population size using truncated Poisson regression modelâ€™. : Statistical Modelling 3.4, pp. 305â€“322. doi: 10.1191/1471082X03st057oa. Cruyff, Maarten J. L. F. Peter G. M. van der Heijden (2008). â€˜Point Interval Estimation Population Size Using Zero-Truncated Negative Binomial Regression Modelâ€™. : Biometrical Journal 50.6, pp. 1035â€“1050. doi: 10.1002/bimj.200810455 BÃ¶hning, Dankmar Peter G. M. van der Heijden (2009). â€˜covariate adjustment zero-truncated approaches estimating size hidden elusive populationsâ€™. : Annals Applied Statistics 3.2, pp. 595â€“610. doi: 10.1214/08-AOAS214. BÃ¶hning, Dankmar, Alberto Vidal-Diez et al. (2013). â€˜Generalization Chaoâ€™s Estimator Covariate Informationâ€™. : Biometrics 69.4, pp. 1033â€“ 1042. doi: 10.1111/biom.12082 BÃ¶hning, Dankmar Peter G. M. van der Heijden (2019). â€˜identity zero-truncated, one-inflated likelihood zero-one-truncated likelihood general count densities application drink-driving Britainâ€™. : Annals Applied Statistics 13.2, pp. 1198â€“1211. doi: 10.1214/18-AOAS1232. Navaratna WC, Del Rio Vilas VJ, BÃ¶hning D. Extending Zelterman's approach robust estimation population size zero-truncated clustered Data. Biom J. 2008 Aug;50(4):584-96. doi: 10.1002/bimj.200710441. BÃ¶hning D. equivalence one-inflated zero-truncated zero-truncated one-inflated count data likelihoods. Biom J. 2022 Aug 15. doi: 10.1002/bimj.202100343. BÃ¶hning, D., Friedl, H. Population size estimation based upon zero-truncated, one-inflated sparse count data. Stat Methods Appl 30, 1197â€“1217 (2021). doi: 10.1007/s10260-021-00556-8 Bootstrap: Zwane, PGM EN Van der Heijden, Implementing parametric bootstrap capture-recapture models continuous covariates 2003 Statistics & probability letters 65.2 pp 121-125 Norris, James L Pollock, Kenneth H Including model uncertainty estimating variances multiple capture studies 1996 Environmental Ecological Statistics 3.3 pp 235-244 Vector generalized linear models: Yee, T. W. (2015). Vector Generalized Linear Additive Models: Implementation R. New York, USA: Springer. ISBN 978-1-4939-2817-0.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Single-source capture-recapture models â€” estimatePopsize","text":"Piotr Chlebicki, Maciej BerÄ™sewicz MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}};","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Single-source capture-recapture models â€” estimatePopsize","text":"","code":"# \\donttest{ # Model from 2003 publication  # Point and interval estimation of the # population size using the truncated Poisson regression mode # Heijden, Peter GM van der et al. (2003) model <- estimatePopsize(    formula = capture ~ gender + age + nation,     data = netherlandsimmigrant,     model = ztpoisson ) summary(model) #>  #> Call: #> estimatePopsize.default(formula = capture ~ gender + age + nation,  #>     data = netherlandsimmigrant, model = ztpoisson) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.486442 -0.486442 -0.298080  0.002093 -0.209444 13.910844  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.3411     0.2149  -6.241 4.35e-10 *** #> gendermale             0.3972     0.1630   2.436 0.014832 *   #> age>40yrs             -0.9746     0.4082  -2.387 0.016972 *   #> nationAsia            -1.0926     0.3016  -3.622 0.000292 *** #> nationNorth Africa     0.1900     0.1940   0.979 0.327398     #> nationRest of Africa  -0.9106     0.3008  -3.027 0.002468 **  #> nationSurinam         -2.3364     1.0136  -2.305 0.021159 *   #> nationTurkey          -1.6754     0.6028  -2.779 0.005445 **  #> --- #> Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 #>  #> AIC: 1712.901 #> BIC: 1757.213 #> Residual deviance: 1128.553 #>  #> Log-likelihood: -848.4504 on 1872 Degrees of freedom  #> Number of iterations: 8 #> ----------------------- #> Population size estimation results:  #> Point estimate 12690.35 #> Observed proportion: 14.8% (N obs = 1880) #> Std. Error 2808.169 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      7186.444   18194.26 #> logNormal   8431.275   19718.32 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal     10.332927   26.16037 #> logNormal   9.534281   22.29793 # Graphical presentation of model fit plot(model, \"rootogram\")  # Statistical test # see documentation for summary.singleRmargin summary(marginalFreq(model), df = 1, \"group\") #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           50.06  1 1.5e-12 #> G-test                     34.31  1 4.7e-09 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been grouped  #> Names of cells used in calculating test(s) statistic: 1 2 3    # We currently support 2 methods of numerical fitting # (generalized) IRLS algorithm and via stats::optim # the latter one is faster when fitting negative binomial models  # (and only then) due to IRLS having to numerically compute # (expected) information matrixes, optim is also less reliable when # using alphaFormula argument in controlModel modelNegBin <- estimatePopsize(     formula = TOTAL_SUB ~ .,      data = farmsubmission,      model = ztnegbin,      method = \"optim\" ) summary(modelNegBin) #>  #> Call: #> estimatePopsize.default(formula = TOTAL_SUB ~ ., data = farmsubmission,  #>     model = ztnegbin, method = \"optim\") #>  #> Pearson Residuals: #>       Min.    1st Qu.     Median       Mean    3rd Qu.       Max.  #> -0.7132180 -0.3362719 -0.1425626  0.0000101  0.1474530  7.0142742  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>              Estimate Std. Error z value  P(>|z|)     #> (Intercept)  -3.17536    0.25947 -12.238  < 2e-16 *** #> log_size      0.63932    0.01771  36.102  < 2e-16 *** #> log_distance -0.07935    0.02228  -3.561 0.000369 *** #> C_TYPEDairy   0.65919    0.03412  19.317  < 2e-16 *** #> ----------------------- #> For linear predictors associated with: alpha  #>             Estimate Std. Error z value  P(>|z|)     #> (Intercept)  0.58238    0.07299   7.979 1.48e-15 *** #> --- #> Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 #>  #> AIC: 34538.73 #> BIC: 34575.71 #> Residual deviance: 17730.07 #>  #> Log-likelihood: -17264.37 on 24067 Degrees of freedom  #> Number of calls to log-likelihood function: 654 #> ----------------------- #> Population size estimation results:  #> Point estimate 41019.07 #> Observed proportion: 29.3% (N obs = 12036) #> Std. Error 1888.039 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      37318.59   44719.56 #> logNormal   37548.53   44961.73 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      26.91440   32.25203 #> logNormal   26.76943   32.05452 summary(marginalFreq(modelNegBin)) #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           30.93 26    0.23 #> G-test                     19.12 26    0.83 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been dropped  #> Names of cells used in calculating test(s) statistic: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19   # More advanced call that specifies additional formula and shows # in depth information about fitting procedure pseudoHurdleModel <- estimatePopsize(     formula = capture ~ nation + age,     data = netherlandsimmigrant,     model = Hurdleztgeom,     method = \"IRLS\",     controlMethod = controlMethod(verbose = 5),     controlModel = controlModel(piFormula = ~ gender) ) #> Iteration number 1 log-likelihood: -846.77533 #> Parameter vector:  -1.52435898 -0.62008047  0.16074142 -0.49971856 -0.85750609 -0.78860226 -0.42067526 -0.44312806 -0.70241852 #> log-likelihood reduction:  Inf #> Value of gradient at current step: #>  142.04204576   8.81177229 108.34506498   9.81769037  -0.39315787   1.30854693   2.40548998 -74.87532567 -61.35856914 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 1.524359 #> ---- #> Iteration number 2 log-likelihood: -828.37292 #> Parameter vector:  -1.11072318 -0.66579168  0.16032836 -0.51705318 -1.27720523 -0.93384649 -0.55851513 -0.52578104 -0.41829231 #> log-likelihood reduction:  18.402407 #> Value of gradient at current step: #>  -30.198518684  -2.367348700 -20.882807839  -2.990134863  -0.033406007  -0.236178150  -0.291286777  12.908733472   8.061651997 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.41969914 #> ---- #> Iteration number 3 log-likelihood: -827.03041 #> Parameter vector:  -1.26212005 -0.65481997  0.16367571 -0.51638838 -1.22088469 -0.89969898 -0.52141633 -0.61358371 -0.51802941 #> log-likelihood reduction:  1.3425075 #> Value of gradient at current step: #>  -0.399477106 -0.125534668 -0.025207083 -0.124263770 -0.012272383 -0.001036293 -0.037255028 -0.402440790 -0.559697165 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.15139687 #> ---- #> Iteration number 4 log-likelihood: -827.01868 #> Parameter vector:  -1.28179260 -0.65559457  0.16445074 -0.51702724 -1.22154349 -0.89783555 -0.52232876 -0.64032726 -0.52639838 #> log-likelihood reduction:  0.011729135 #> Value of gradient at current step: #>   0.01965800195 -0.00376668640  0.02342526604  0.00085753707 -0.00131148043  0.00040402353 -0.00468611749 -0.01113423867 -0.00978879207 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.026743552 #> ---- #> Iteration number 5 log-likelihood: -827.01868 #> Parameter vector:  -1.28177518 -0.65568959  0.16449297 -0.51701807 -1.22190483 -0.89779857 -0.52262758 -0.64032669 -0.52640250 #> log-likelihood reduction:  0.0000018094989 #> Value of gradient at current step: #>  -0.0001561899387  0.0000207886459 -0.0000413107753 -0.0000259493362  0.0000040518562 -0.0000068413444 -0.0000222504320  0.0000011784080  0.0000010016067 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.00036133989 #> ---- #> Iteration number 6 log-likelihood: -827.01868 #> Parameter vector:  -1.28177959 -0.65568717  0.16449471 -0.51701668 -1.22190170 -0.89779724 -0.52262830 -0.64033172 -0.52640214 #> log-likelihood reduction:  0.00000000032207481 #> Value of gradient at current step: #>   0.00000138172839925 -0.00000029541573543  0.00000194942825438  0.00000005064943620 -0.00000001912655101  0.00000005032669892 -0.00000167462238743 -0.00000000020190338 -0.00000000017657165 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0000050277134 #> ---- #> Value of analytically computed hessian at fitted regression coefficients: #>              [,1]       [,2]       [,3]        [,4]      [,5]       [,6] #>  [1,] -600.647579 -45.430239 -437.78550 -46.3057511 -3.648625 -9.9715730 #>  [2,]  -45.430239 -45.430239    0.00000   0.0000000  0.000000  0.0000000 #>  [3,] -437.785496   0.000000 -437.78550   0.0000000  0.000000  0.0000000 #>  [4,]  -46.305751   0.000000    0.00000 -46.3057511  0.000000  0.0000000 #>  [5,]   -3.648625   0.000000    0.00000   0.0000000 -3.648625  0.0000000 #>  [6,]   -9.971573   0.000000    0.00000   0.0000000  0.000000 -9.9715730 #>  [7,]  -17.976683  -2.320732  -11.24212  -0.6903141 -2.003224 -0.2486649 #>  [8,]  328.022454  23.801161  241.35686  24.3769265  1.870670  5.1505625 #>  [9,]  280.048801  20.260808  211.90055  19.7419682  1.462128  4.6637718 #>              [,7]        [,8]        [,9] #>  [1,] -17.9766828  328.022454  280.048801 #>  [2,]  -2.3207316   23.801161   20.260808 #>  [3,] -11.2421165  241.356859  211.900549 #>  [4,]  -0.6903141   24.376927   19.741968 #>  [5,]  -2.0032237    1.870670    1.462128 #>  [6,]  -0.2486649    5.150563    4.663772 #>  [7,] -17.9766828    9.477666    8.492258 #>  [8,]   9.4776658 -197.098079 -168.419176 #>  [9,]   8.4922579 -168.419176 -168.419176 #> The matrix above has the following eigen values: #>  -3.121074 -6.868861 -9.331036 -16.61098 -18.10422 -33.99724 -45.94396 -112.7247 -1280.581  summary(pseudoHurdleModel) #>  #> Call: #> estimatePopsize.default(formula = capture ~ nation + age, data = netherlandsimmigrant,  #>     model = Hurdleztgeom, method = \"IRLS\", controlMethod = controlMethod(verbose = 5),  #>     controlModel = controlModel(piFormula = ~gender)) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.428461 -0.428461 -0.288574  0.004918 -0.181672 13.696149  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.2818     0.1858  -6.899 5.22e-12 *** #> nationAsia            -0.6557     0.1994  -3.289  0.00101 **  #> nationNorth Africa     0.1645     0.1417   1.161  0.24561     #> nationRest of Africa  -0.5170     0.1979  -2.612  0.00900 **  #> nationSurinam         -1.2219     0.5552  -2.201  0.02775 *   #> nationTurkey          -0.8978     0.3439  -2.611  0.00903 **  #> age>40yrs             -0.5226     0.2469  -2.117  0.03429 *   #> ----------------------- #> For linear predictors associated with: pi  #>             Estimate Std. Error z value P(>|z|)    #> (Intercept)  -0.6403     0.2945  -2.174 0.02969 *  #> gendermale   -0.5264     0.2043  -2.577 0.00996 ** #> --- #> Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 #>  #> AIC: 1672.037 #> BIC: 1721.889 #> Residual deviance: 1492.301 #>  #> Log-likelihood: -827.0187 on 3751 Degrees of freedom  #> Number of iterations: 6 #> ----------------------- #> Population size estimation results:  #> Point estimate 6446.833 #> Observed proportion: 29.2% (N obs = 1880) #> Std. Error 1126.716 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      4238.511   8655.156 #> logNormal   4715.983   9234.051 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      21.72116   44.35520 #> logNormal   20.35943   39.86443 # Assessing model fit plot(pseudoHurdleModel, \"rootogram\")  summary(marginalFreq(pseudoHurdleModel), \"group\", df = 1) #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test            1.89  1    0.17 #> G-test                      2.13  1    0.14 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been grouped  #> Names of cells used in calculating test(s) statistic: 1 2 3 4     # A advanced input with additional information for fitting procedure and # additional formula specification and different link for inflation parameter. Model <- estimatePopsize(  formula = TOTAL_SUB ~ .,   data = farmsubmission,   model = oiztgeom(omegaLink = \"cloglog\"),   method = \"IRLS\",   controlMethod = controlMethod(    stepsize = .85,     momentumFactor = 1.2,    epsilon = 1e-10,     silent = TRUE  ),  controlModel = controlModel(omegaFormula = ~ C_TYPE + log_size) ) summary(marginalFreq(Model), df = 18 - length(Model$coefficients)) #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           52.66 11 2.1e-07 #> G-test                     22.74 11 1.9e-02 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been dropped  #> Names of cells used in calculating test(s) statistic: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  summary(Model) #>  #> Call: #> estimatePopsize.default(formula = TOTAL_SUB ~ ., data = farmsubmission,  #>     model = oiztgeom(omegaLink = \"cloglog\"), method = \"IRLS\",  #>     controlMethod = controlMethod(stepsize = 0.85, momentumFactor = 1.2,  #>         epsilon = 1e-10, silent = TRUE), controlModel = controlModel(omegaFormula = ~C_TYPE +  #>         log_size)) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.894863 -0.642966 -0.439570  0.005459  0.290211 20.554330  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>              Estimate Std. Error z value  P(>|z|)     #> (Intercept)  -2.67980    0.25196 -10.636  < 2e-16 *** #> log_size      0.61258    0.02003  30.591  < 2e-16 *** #> log_distance -0.07270    0.02080  -3.495 0.000474 *** #> C_TYPEDairy   0.54628    0.04181  13.066  < 2e-16 *** #> ----------------------- #> For linear predictors associated with: omega  #>             Estimate Std. Error z value P(>|z|)    #> (Intercept) -1.70568    0.78564  -2.171 0.02993 *  #> C_TYPEDairy -0.91361    0.28104  -3.251 0.00115 ** #> log_size    -0.04029    0.13728  -0.293 0.76918    #> --- #> Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 #>  #> AIC: 34572 #> BIC: 34623.77 #> Residual deviance: 12319.33 #>  #> Log-likelihood: -17279 on 24065 Degrees of freedom  #> Number of iterations: 20 #> ----------------------- #> Population size estimation results:  #> Point estimate 28562.26 #> Observed proportion: 42.1% (N obs = 12036) #> Std. Error 713.9346 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      27162.98   29961.55 #> logNormal   27221.18   30021.78 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      40.17149   44.31032 #> logNormal   40.09089   44.21558 # }"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsizeFit.html","id":null,"dir":"Reference","previous_headings":"","what":"Regression fitting in single-source capture-recapture models â€” estimatePopsizeFit","title":"Regression fitting in single-source capture-recapture models â€” estimatePopsizeFit","text":"estimatePopsizeFit estimatePopsize glm.fit glm. internally called estimatePopsize. Since estimatePopsize much just regression fitting estimatePopsizeFit much faster.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsizeFit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regression fitting in single-source capture-recapture models â€” estimatePopsizeFit","text":"","code":"estimatePopsizeFit(   y,   X,   family,   control,   method,   priorWeights,   coefStart,   etaStart,   offset,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsizeFit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regression fitting in single-source capture-recapture models â€” estimatePopsizeFit","text":"y vector dependent variables. X model matrix, vglm one. family model estimatePopsize. control control parameters created controlModel. method method estimation estimatePopsize. priorWeights vector prior weights argument weights estimatePopsize. etaStart, coefStart initial value regression parameters linear predictors. offset offset passed default passed estimatePopsize(). ... arguments pass methods.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsizeFit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regression fitting in single-source capture-recapture models â€” estimatePopsizeFit","text":"List regression parameters, working weights (IRLS fitting method) chosen number iterations taken.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsizeFit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Regression fitting in single-source capture-recapture models â€” estimatePopsizeFit","text":"MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}}; method argument set \"optim\" stats::optim function used fit regression analytically computed gradient (minus) log likelihood functions gr fn arguments. Unfortunately optim allow hessian specified. information modify optim fitting included controlMethod(). method argument set \"IRLS\" iteratively reweighted least squares. algorithm well know generalised linear models. Thomas W. Yee later extended algorithm vector generalised linear models general terms can roughly described (Yee's description changing conventions): Initialize : converged <- FALSE iter <- 1 \\(\\boldsymbol{\\beta}\\) <- start \\(\\boldsymbol{W}\\) <- prior \\(\\ell\\) <- \\(\\ell(\\boldsymbol{\\beta})\\) converged iter > Maxiter move step 7. Store values previous algorithm step: \\(\\boldsymbol{W}_{-}\\) <-  \\(\\boldsymbol{W}\\) \\(\\ell_{-}\\) <-  \\(\\ell\\) \\(\\boldsymbol{\\beta}_{-}\\) <-  \\(\\boldsymbol{\\beta}\\) assign values current step: \\(\\boldsymbol{\\eta}\\) <-  \\(\\boldsymbol{X}_{vlm}\\boldsymbol{\\beta}\\) \\(Z_{}\\) <-  \\( \\eta_{}+\\frac{\\partial\\ell_{}}{\\partial\\eta_{}} \\mathbb{E}\\left(\\frac{\\partial^{2}\\ell_{}}{ \\partial\\eta_{}^{T}\\partial\\eta_{}}\\right)^{-1}\\) \\(\\boldsymbol{W}_{ij}\\) <-  \\(\\mathbb{E}\\left(\\frac{\\partial^{2}\\ell}{ \\partial\\boldsymbol{\\eta}_{j}^{T}\\partial\\boldsymbol{\\eta}_{}}\\right)\\) \\(\\ell_{}\\) ith component log likelihood function, \\(\\eta_{}\\) vector linear predictors associated ith row \\(\\mathbb{E}\\left(\\frac{\\partial^{2}\\ell_{}}{ \\partial\\eta_{}^{T}\\partial\\eta_{}}\\right)\\) corresponds weights associated ith row \\(\\boldsymbol{W}\\) block matrix, made diagonal matrixes \\(\\mathbb{E}\\left(\\frac{\\partial^{2}\\ell}{ \\partial\\boldsymbol{\\eta}_{j}^{T}\\partial\\boldsymbol{\\eta}_{}}\\right)\\) Regress \\(\\boldsymbol{Z}\\) \\(\\boldsymbol{X}_{vlm}\\) obtain \\(\\boldsymbol{\\beta}\\) : \\[\\boldsymbol{\\beta}= \\left(\\boldsymbol{X}_{vlm}^{T}\\boldsymbol{W}\\boldsymbol{X}_{vlm}\\right)^{-1} \\boldsymbol{X}_{vlm}^{T}\\boldsymbol{W}\\boldsymbol{Z}\\] Assign: converged <- \\( \\ell(\\boldsymbol{\\beta})-\\ell_{-} < \\varepsilon\\cdot\\ell_{-}\\) \\( ||\\boldsymbol{\\beta}-\\boldsymbol{\\beta}_{-}||_{\\infty} < \\varepsilon\\) iter <- iter + 1 \\(\\varepsilon\\) relative tolerance level, default 1e-8. Return step 2. Return \\(\\boldsymbol{\\beta}, \\boldsymbol{W}\\), iter. package use different conventions \\(\\boldsymbol{X}_{vlm}\\) matrix hence slight differences present algorithm description results identical.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsizeFit.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Regression fitting in single-source capture-recapture models â€” estimatePopsizeFit","text":"Yee, T. W. (2015). Vector Generalized Linear Additive Models: Implementation R. New York, USA: Springer. ISBN 978-1-4939-2817-0.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsizeFit.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Regression fitting in single-source capture-recapture models â€” estimatePopsizeFit","text":"Piotr Chlebicki, Maciej Beresewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsizeFit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Regression fitting in single-source capture-recapture models â€” estimatePopsizeFit","text":"","code":"# \\donttest{ summary(farmsubmission) #>    TOTAL_SUB        log_size       log_distance      C_TYPE     #>  Min.   : 1.00   Min.   : 0.000   Min.   : 4.102   Beef :5336   #>  1st Qu.: 1.00   1st Qu.: 4.673   1st Qu.:10.351   Dairy:6700   #>  Median : 1.00   Median : 5.347   Median :10.778                #>  Mean   : 2.34   Mean   : 5.259   Mean   :10.662                #>  3rd Qu.: 3.00   3rd Qu.: 5.940   3rd Qu.:11.099                #>  Max.   :47.00   Max.   :10.480   Max.   :12.097                 # construct vglm model matrix X <- matrix(data = 0, nrow = 2 * NROW(farmsubmission), ncol = 7) X[1:NROW(farmsubmission), 1:4] <- model.matrix( ~ 1 + log_size + log_distance + C_TYPE,  farmsubmission )   X[-(1:NROW(farmsubmission)), 5:7] <- X[1:NROW(farmsubmission), c(1, 3, 4)]  # this attribute tells the function which elements of the design matrix  # correspond to which linear predictor  attr(X, \"hwm\") <- c(4, 3)  # get starting points start <- glm.fit( y = farmsubmission$TOTAL_SUB,  x = X[1:NROW(farmsubmission), 1:4],  family = poisson() )$coefficients  res <- estimatePopsizeFit( y = farmsubmission$TOTAL_SUB,  X = X,  method = \"IRLS\",  priorWeights = 1,  family = ztoigeom(),  control = controlMethod(verbose = 5),  coefStart = c(start, 0, 0, 0), etaStart = matrix(X %*% c(start, 0, 0, 0), ncol = 2), offset = cbind(rep(0, NROW(farmsubmission)), rep(0, NROW(farmsubmission))) ) #> Iteration number 1 log-likelihood: -17550.114 #> Parameter vector:  -2.376169746  0.526024958 -0.056369900  0.413872736 -1.952364227  0.029469787 -0.352737911 #> log-likelihood reduction:  Inf #> Value of gradient at current step: #>   1489.26417  8462.99644 15802.73557  1127.53995  -418.45144 -4455.57223  -253.63196 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 2.3761697 #> ---- #> Iteration number 2 log-likelihood: -17300.07 #> Parameter vector:  -2.633896686  0.582395291 -0.064073582  0.667740572 -3.095480026  0.047207764  0.046264308 #> log-likelihood reduction:  250.04378 #> Value of gradient at current step: #>   -28.899411 -315.159403 -298.325366 -121.257418  -45.032685 -482.019954  -20.096746 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 1.1431158 #> ---- #> Iteration number 3 log-likelihood: -17287.188 #> Parameter vector:  -2.504876876  0.575295120 -0.073821708  0.612160832 -3.119640124  0.011888093  0.029514971 #> log-likelihood reduction:  12.882004 #> Value of gradient at current step: #>   41.5353296 252.3498380 448.9046975  30.7496910  -8.7641682 -93.3640710  -5.3929815 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.12901981 #> ---- #> Iteration number 4 log-likelihood: -17286.557 #> Parameter vector:  -2.608145817  0.582912458 -0.069091913  0.622397984 -3.562325812  0.036715781  0.114980134 #> log-likelihood reduction:  0.63083188 #> Value of gradient at current step: #>    1.65638471   9.43319152  16.29083146  -0.22561323  -1.22104226 -13.44032132  -0.49242892 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.44268569 #> ---- #> Iteration number 5 log-likelihood: -17286.527 #> Parameter vector:  -2.589615777  0.583968034 -0.071694931  0.624101247 -3.331535027  0.010372891  0.146052220 #> log-likelihood reduction:  0.030118595 #> Value of gradient at current step: #>   0.0045622452  0.7724124445  0.4383942297  0.1410982952 -0.1743585631 -1.7157841593  0.0436948698 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.23079079 #> ---- #> Iteration number 6 log-likelihood: -17286.524 #> Parameter vector:  -2.603607106  0.584395570 -0.070803343  0.626306026 -3.469650528  0.021013822  0.172842019 #> log-likelihood reduction:  0.0033094037 #> Value of gradient at current step: #>  -0.229287967 -1.254231939 -2.663094385 -0.136018786 -0.065501279 -0.875136888 -0.037830598 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.1381155 #> ---- #> Iteration number 7 log-likelihood: -17286.523 #> Parameter vector:  -2.595282607  0.584455592 -0.071643641  0.626377284 -3.357657769  0.010243233  0.173254080 #> log-likelihood reduction:  0.00058225262 #> Value of gradient at current step: #>   0.01697688169  0.18152150469  0.30278294083  0.05491324450 -0.00954208534  0.00046176213  0.02942429986 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.11199276 #> ---- #> Iteration number 8 log-likelihood: -17286.523 #> Parameter vector:  -2.601354233  0.584513757 -0.071144386  0.626915261 -3.431719299  0.016721304  0.179806607 #> log-likelihood reduction:  0.00017410518 #> Value of gradient at current step: #>  -0.064034760 -0.379810901 -0.778700450 -0.045639365 -0.011572568 -0.203677953 -0.019963628 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.07406153 #> ---- #> Iteration number 9 log-likelihood: -17286.523 #> Parameter vector:  -2.597126682  0.584506154 -0.071529657  0.626744005 -3.377281943  0.011722915  0.177519492 #> log-likelihood reduction:  0.000071507806 #> Value of gradient at current step: #>  0.0284979151 0.1864404866 0.3666111521 0.0305300981 0.0016229304 0.0719860549 0.0142857723 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.054437356 #> ---- #> Iteration number 10 log-likelihood: -17286.523 #> Parameter vector:  -2.600150970  0.584522770 -0.071267073  0.626938070 -3.415354274  0.015139829  0.179959991 #> log-likelihood reduction:  0.000035001824 #> Value of gradient at current step: #>  -0.0254323196 -0.1573738913 -0.3179746249 -0.0217129745 -0.0035760543 -0.0777211830 -0.0102459754 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.038072332 #> ---- #> Iteration number 11 log-likelihood: -17286.523 #> Parameter vector:  -2.598008714  0.584514838 -0.071457541  0.626825132 -3.388080609  0.012664531  0.178504506 #> log-likelihood reduction:  0.000017260521 #> Value of gradient at current step: #>  0.0166844643 0.1053460426 0.2101040472 0.0156399950 0.0016132423 0.0451631907 0.0071883615 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.027273665 #> ---- #> Iteration number 12 log-likelihood: -17286.523 #> Parameter vector:  -2.599534056  0.584521813 -0.071323467  0.626914011 -3.407406275  0.014409036  0.179635638 #> log-likelihood reduction:  0.0000087810295 #> Value of gradient at current step: #>  -0.0121554909 -0.0761209122 -0.1529982539 -0.0109236603 -0.0015139582 -0.0360631619 -0.0051776855 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.019325666 #> ---- #> Iteration number 13 log-likelihood: -17286.523 #> Parameter vector:  -2.598450181  0.584517321 -0.071419274  0.626853774 -3.393643298  0.013163381  0.178864482 #> log-likelihood reduction:  0.0000044078333 #> Value of gradient at current step: #>  0.00863941235 0.05422850142 0.10851025481 0.00789351520 0.00092550566 0.02403409764 0.00364208947 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.013762977 #> ---- #> Iteration number 14 log-likelihood: -17286.523 #> Parameter vector:  -2.599221083  0.584520680 -0.071351319  0.626897628 -3.403423424  0.014047410  0.179424307 #> log-likelihood reduction:  0.0000022386557 #> Value of gradient at current step: #>  -0.00609651399 -0.03826378502 -0.07677634455 -0.00553869224 -0.00072252915 -0.01776979990 -0.00261189222 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0097801258 #> ---- #> Iteration number 15 log-likelihood: -17286.523 #> Parameter vector:  -2.598672961  0.584518350 -0.071399702  0.626866800 -3.396467246  0.013418234  0.179030220 #> log-likelihood reduction:  0.0000011281627 #> Value of gradient at current step: #>  0.00437552328 0.02744244081 0.05496756154 0.00397917475 0.00048523685 0.01233742716 0.00184538567 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0069561777 #> ---- #> Iteration number 16 log-likelihood: -17286.523 #> Parameter vector:  -2.599062724  0.584520028 -0.071365321  0.626888846 -3.401413268  0.013865450  0.179311848 #> log-likelihood reduction:  0.00000057176658 #> Value of gradient at current step: #>  -0.00308520077 -0.01936683164 -0.03883603649 -0.00280772877 -0.00035808186 -0.00890811713 -0.00131846263 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0049460217 #> ---- #> Iteration number 17 log-likelihood: -17286.523 #> Parameter vector:  -2.598785568  0.584518843 -0.071389778  0.626873213 -3.397896233  0.013547389  0.179112085 #> log-likelihood reduction:  0.00000028862269 #> Value of gradient at current step: #>  0.00220900398 0.01385546526 0.02776312256 0.00200791788 0.00024850391 0.00627132383 0.00093429219 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0035170353 #> ---- #> Iteration number 18 log-likelihood: -17286.523 #> Parameter vector:  -2.598982644  0.584519689 -0.071372391  0.626884345 -3.400397179  0.013773541  0.179254311 #> log-likelihood reduction:  0.00000014611214 #> Value of gradient at current step: #>  -0.00156243814 -0.00980648384 -0.01966002003 -0.00142189173 -0.00017963917 -0.00448948244 -0.00066602383 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0025009461 #> ---- #> Iteration number 19 log-likelihood: -17286.523 #> Parameter vector:  -2.598842504  0.584519089 -0.071384756  0.626876435 -3.398618850  0.013612726  0.179153243 #> log-likelihood reduction:  0.00000007381459 #> Value of gradient at current step: #>  0.00111546600 0.00699753811 0.01402367467 0.00101410800 0.00012631018 0.00317780227 0.00047274423 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0017783286 #> ---- #> Iteration number 20 log-likelihood: -17286.523 #> Parameter vector:  -2.598942153  0.584519516 -0.071375964  0.626882062 -3.399883416  0.013727078  0.179225136 #> log-likelihood reduction:  0.00000003734749 #> Value of gradient at current step: #>  -0.000790860150 -0.004963117716 -0.009948972121 -0.000719565560 -0.000090519732 -0.002266834445 -0.000336593619 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0012645652 #> ---- #> Iteration number 21 log-likelihood: -17286.523 #> Parameter vector:  -2.598871294  0.584519212 -0.071382216  0.626878062 -3.398984225  0.013645765  0.179174024 #> log-likelihood reduction:  0.000000018873834 #> Value of gradient at current step: #>  0.000563568332 0.003535731060 0.007086435089 0.000512456788 0.000064017826 0.001608354191 0.000239124512 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0008991904 #> ---- #> Iteration number 22 log-likelihood: -17286.523 #> Parameter vector:  -2.598921680  0.584519428 -0.071377771  0.626880906 -3.399623632  0.013703585  0.179210372 #> log-likelihood reduction:  0.0000000095496944 #> Value of gradient at current step: #>  -0.000400125264 -0.002510830909 -0.005032906088 -0.000363998081 -0.000045696107 -0.001145438950 -0.000170148829 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.00063940667 #> ---- #> Value of analytically computed hessian at fitted regression coefficients: #>            [,1]         [,2]         [,3]        [,4]       [,5]       [,6] #> [1,]  -5941.804  -33237.6696  -63184.3939  -4042.8998  424.63598 23751.3293 #> [2,] -33237.670 -191051.4616 -353329.4001 -23640.8438 4526.54681  1389.4971 #> [3,] -63184.394 -353329.4001 -674494.4908 -42806.7283  247.79024  4526.5468 #> [4,]  -4042.900  -23640.8438  -42806.7283  -4042.8998 2229.15341 48421.1063 #> [5,]    424.636     247.7902   48421.1063   1389.4971  -69.94232  -744.9399 #> [6,]   2229.153    4526.5468    2624.5806   2624.5806 -744.93988 -7973.6057 #> [7,]   4526.547   23751.3293     247.7902    247.7902  -45.99667  -490.0571 #>            [,7] #> [1,] 2624.58059 #> [2,]  247.79024 #> [3,] 2624.58059 #> [4,]  247.79024 #> [5,]  -45.99667 #> [6,] -490.05713 #> [7,]  -45.99667 #> The matrix above has the following eigen values: #>  -869785.7+0i -17240.18+0i -2472.809+9708.042i -2472.809-9708.042i 8149.489+0i 1615.552+0i -1413.766+0i   # extract results  # regression coefficient vector res$beta #> [1] -2.59892168  0.58451943 -0.07137777  0.62688091 -3.39962363  0.01370359 #> [7]  0.17921037  # check likelihood ll <- ztoigeom()$makeMinusLogLike(y = farmsubmission$TOTAL_SUB, X = X)  -ll(res$beta) #> [1] -17286.52  # number of iterations res$iter #> [1] 22  # working weights head(res$weights) #>         lambda       mixed       mixed       omega #> [1,] 0.2733879 -0.03187827 -0.03187827 0.004860059 #> [2,] 0.6783958 -0.03738217 -0.03738217 0.007747769 #> [3,] 0.1145154 -0.02534924 -0.02534924 0.006028454 #> [4,] 0.1790770 -0.02931302 -0.02931302 0.005523789 #> [5,] 0.3987180 -0.03319312 -0.03319312 0.004479829 #> [6,] 0.4920636 -0.03350614 -0.03350614 0.004531546  # Compare with optim call  res2 <- estimatePopsizeFit(   y = farmsubmission$TOTAL_SUB,    X = X,    method = \"optim\",    priorWeights = 1,    family = ztoigeom(),    coefStart = c(start, 0, 0, 0),   control = controlMethod(verbose = 1, silent = TRUE),   offset = cbind(rep(0, NROW(farmsubmission)), rep(0, NROW(farmsubmission))) ) #>   Nelder-Mead direct search function minimizer #> function value for initial parameters = 19135.970356 #>   Scaled convergence tolerance is 0.00019136 #> Stepsize computed as 0.082584 #> BUILD              8 21628.437230 19133.539224 #> REFLECTION        10 20756.644804 18940.732447 #> LO-REDUCTION      12 19606.916214 18926.129600 #> LO-REDUCTION      14 19309.305936 18847.773068 #> EXTENSION         16 19269.501942 18303.096276 #> LO-REDUCTION      18 19153.670565 18303.096276 #> EXTENSION         20 19135.970356 17912.380725 #> LO-REDUCTION      22 19133.539224 17912.380725 #> LO-REDUCTION      24 18940.732447 17912.380725 #> LO-REDUCTION      26 18926.129600 17912.380725 #> LO-REDUCTION      28 18847.773068 17912.380725 #> LO-REDUCTION      30 18330.888204 17912.380725 #> EXTENSION         32 18303.096276 17699.648860 #> EXTENSION         34 18212.293899 17558.677603 #> HI-REDUCTION      36 18078.266152 17558.677603 #> LO-REDUCTION      38 18077.244658 17558.677603 #> EXTENSION         40 18046.635595 17434.246747 #> LO-REDUCTION      42 17966.526721 17434.246747 #> LO-REDUCTION      44 17912.380725 17434.246747 #> LO-REDUCTION      46 17871.858218 17434.246747 #> LO-REDUCTION      48 17699.648860 17434.246747 #> LO-REDUCTION      50 17650.163809 17434.246747 #> LO-REDUCTION      52 17558.677603 17434.246747 #> HI-REDUCTION      54 17516.785947 17434.246747 #> REFLECTION        56 17467.768303 17420.151936 #> HI-REDUCTION      58 17467.699076 17420.151936 #> EXTENSION         60 17465.840145 17381.144605 #> LO-REDUCTION      62 17465.538855 17381.144605 #> LO-REDUCTION      64 17457.288417 17381.144605 #> LO-REDUCTION      66 17442.024150 17381.144605 #> LO-REDUCTION      68 17440.392477 17381.144605 #> EXTENSION         70 17434.246747 17334.895518 #> LO-REDUCTION      72 17420.151936 17334.895518 #> LO-REDUCTION      74 17416.961045 17334.895518 #> LO-REDUCTION      76 17402.660537 17334.895518 #> LO-REDUCTION      78 17394.959214 17334.895518 #> LO-REDUCTION      80 17392.532797 17334.895518 #> EXTENSION         82 17381.144605 17316.504861 #> LO-REDUCTION      84 17375.832799 17316.504861 #> LO-REDUCTION      86 17363.774766 17316.504861 #> REFLECTION        88 17343.751331 17305.644043 #> LO-REDUCTION      90 17342.366351 17305.644043 #> EXTENSION         92 17338.983203 17299.308930 #> LO-REDUCTION      94 17334.895518 17299.308930 #> LO-REDUCTION      96 17324.646822 17299.308930 #> LO-REDUCTION      98 17323.590625 17299.308930 #> LO-REDUCTION     100 17316.627163 17299.308930 #> LO-REDUCTION     102 17316.504861 17299.308930 #> LO-REDUCTION     104 17309.426844 17299.308930 #> LO-REDUCTION     106 17306.896574 17299.213022 #> LO-REDUCTION     108 17305.644043 17299.213022 #> HI-REDUCTION     110 17301.855713 17299.213022 #> REFLECTION       112 17301.803640 17298.374210 #> HI-REDUCTION     114 17301.796394 17298.374210 #> LO-REDUCTION     116 17301.489802 17298.374210 #> LO-REDUCTION     118 17300.957660 17298.374210 #> LO-REDUCTION     120 17300.016126 17298.374210 #> HI-REDUCTION     122 17299.611047 17298.374210 #> REFLECTION       124 17299.308930 17298.093107 #> EXTENSION        126 17299.213022 17297.231097 #> REFLECTION       128 17298.925386 17297.171892 #> REFLECTION       130 17298.732554 17297.077851 #> LO-REDUCTION     132 17298.452859 17297.077851 #> LO-REDUCTION     134 17298.382263 17297.077851 #> REFLECTION       136 17298.374210 17296.980993 #> REFLECTION       138 17298.093107 17296.468183 #> EXTENSION        140 17297.268148 17295.433620 #> LO-REDUCTION     142 17297.231097 17295.433620 #> LO-REDUCTION     144 17297.201571 17295.433620 #> REFLECTION       146 17297.171892 17295.341847 #> LO-REDUCTION     148 17297.077851 17295.341847 #> EXTENSION        150 17296.980993 17294.284096 #> LO-REDUCTION     152 17296.468183 17294.284096 #> EXTENSION        154 17295.993173 17293.316067 #> LO-REDUCTION     156 17295.517735 17293.316067 #> LO-REDUCTION     158 17295.494544 17293.316067 #> LO-REDUCTION     160 17295.433620 17293.316067 #> EXTENSION        162 17295.341847 17292.072213 #> LO-REDUCTION     164 17295.283117 17292.072213 #> LO-REDUCTION     166 17294.357739 17292.072213 #> LO-REDUCTION     168 17294.284096 17292.072213 #> LO-REDUCTION     170 17294.231320 17292.072213 #> EXTENSION        172 17294.104223 17291.423540 #> LO-REDUCTION     174 17293.669383 17291.423540 #> REFLECTION       176 17293.316067 17291.060821 #> EXTENSION        178 17292.290481 17290.565091 #> LO-REDUCTION     180 17292.217296 17290.565091 #> LO-REDUCTION     182 17292.188283 17290.565091 #> LO-REDUCTION     184 17292.072213 17290.565091 #> LO-REDUCTION     186 17291.567818 17290.565091 #> LO-REDUCTION     188 17291.423540 17290.517025 #> EXTENSION        190 17291.060821 17289.934833 #> LO-REDUCTION     192 17291.007425 17289.934833 #> LO-REDUCTION     194 17290.866709 17289.934833 #> LO-REDUCTION     196 17290.817445 17289.934833 #> LO-REDUCTION     198 17290.758168 17289.934833 #> LO-REDUCTION     200 17290.565091 17289.934833 #> LO-REDUCTION     202 17290.530576 17289.934833 #> EXTENSION        204 17290.517025 17289.755906 #> LO-REDUCTION     206 17290.282088 17289.755906 #> LO-REDUCTION     208 17290.248001 17289.755906 #> LO-REDUCTION     210 17290.223189 17289.755906 #> REFLECTION       212 17290.127309 17289.725940 #> LO-REDUCTION     214 17290.098882 17289.725940 #> LO-REDUCTION     216 17290.036552 17289.725940 #> LO-REDUCTION     218 17289.934833 17289.725940 #> LO-REDUCTION     220 17289.902270 17289.725940 #> LO-REDUCTION     222 17289.890661 17289.725940 #> REFLECTION       224 17289.820937 17289.702686 #> LO-REDUCTION     226 17289.777081 17289.702312 #> REFLECTION       228 17289.758951 17289.686667 #> EXTENSION        230 17289.755906 17289.666388 #> EXTENSION        232 17289.747982 17289.610366 #> EXTENSION        234 17289.745697 17289.562699 #> HI-REDUCTION     236 17289.725940 17289.562699 #> LO-REDUCTION     238 17289.702686 17289.562699 #> LO-REDUCTION     240 17289.702312 17289.562699 #> LO-REDUCTION     242 17289.686667 17289.562699 #> REFLECTION       244 17289.666388 17289.553928 #> EXTENSION        246 17289.659099 17289.430319 #> LO-REDUCTION     248 17289.625783 17289.430319 #> LO-REDUCTION     250 17289.610366 17289.430319 #> LO-REDUCTION     252 17289.589639 17289.430319 #> EXTENSION        254 17289.581544 17289.366344 #> LO-REDUCTION     256 17289.562699 17289.366344 #> EXTENSION        258 17289.553928 17289.355186 #> REFLECTION       260 17289.524309 17289.347390 #> EXTENSION        262 17289.463415 17289.256311 #> LO-REDUCTION     264 17289.438892 17289.256311 #> EXTENSION        266 17289.430319 17289.194525 #> LO-REDUCTION     268 17289.422342 17289.194525 #> LO-REDUCTION     270 17289.366344 17289.194525 #> REFLECTION       272 17289.355186 17289.169478 #> HI-REDUCTION     274 17289.347390 17289.169478 #> LO-REDUCTION     276 17289.258763 17289.169478 #> LO-REDUCTION     278 17289.256311 17289.169478 #> LO-REDUCTION     280 17289.233544 17289.169478 #> HI-REDUCTION     282 17289.220868 17289.169478 #> LO-REDUCTION     284 17289.211407 17289.169478 #> LO-REDUCTION     286 17289.194525 17289.169478 #> LO-REDUCTION     288 17289.192199 17289.169478 #> LO-REDUCTION     290 17289.186075 17289.169478 #> REFLECTION       292 17289.177779 17289.164394 #> LO-REDUCTION     294 17289.177465 17289.164394 #> LO-REDUCTION     296 17289.176353 17289.164394 #> LO-REDUCTION     298 17289.173142 17289.164394 #> LO-REDUCTION     300 17289.171672 17289.164394 #> REFLECTION       302 17289.170351 17289.162643 #> LO-REDUCTION     304 17289.169550 17289.162479 #> REFLECTION       306 17289.169478 17289.160797 #> REFLECTION       308 17289.165906 17289.159411 #> LO-REDUCTION     310 17289.165109 17289.159411 #> LO-REDUCTION     312 17289.164417 17289.159411 #> LO-REDUCTION     314 17289.164394 17289.159411 #> REFLECTION       316 17289.162643 17289.158035 #> LO-REDUCTION     318 17289.162479 17289.158035 #> LO-REDUCTION     320 17289.161336 17289.158035 #> LO-REDUCTION     322 17289.160972 17289.158035 #> REFLECTION       324 17289.160797 17289.157923 #> LO-REDUCTION     326 17289.160192 17289.157923 #> REFLECTION       328 17289.159411 17289.157174 #> LO-REDUCTION     330 17289.159135 17289.157174 #> LO-REDUCTION     332 17289.159042 17289.157174 #> REFLECTION       334 17289.158322 17289.156947 #> REFLECTION       336 17289.158042 17289.156521 #> LO-REDUCTION     338 17289.158035 17289.156521 #> LO-REDUCTION     340 17289.157923 17289.156521 #> REFLECTION       342 17289.157547 17289.156342 #> LO-REDUCTION     344 17289.157424 17289.156342 #> REFLECTION       346 17289.157174 17289.156151 #> LO-REDUCTION     348 17289.157122 17289.156151 #> LO-REDUCTION     350 17289.157110 17289.156151 #> REFLECTION       352 17289.156947 17289.155928 #> LO-REDUCTION     354 17289.156532 17289.155928 #> EXTENSION        356 17289.156521 17289.155659 #> EXTENSION        358 17289.156501 17289.155347 #> EXTENSION        360 17289.156342 17289.155165 #> LO-REDUCTION     362 17289.156239 17289.155165 #> EXTENSION        364 17289.156151 17289.154673 #> LO-REDUCTION     366 17289.156024 17289.154673 #> EXTENSION        368 17289.155928 17289.153645 #> LO-REDUCTION     370 17289.155659 17289.153645 #> LO-REDUCTION     372 17289.155347 17289.153645 #> LO-REDUCTION     374 17289.155336 17289.153645 #> LO-REDUCTION     376 17289.155165 17289.153645 #> REFLECTION       378 17289.155017 17289.153558 #> EXTENSION        380 17289.154673 17289.153090 #> LO-REDUCTION     382 17289.154524 17289.153090 #> EXTENSION        384 17289.154080 17289.152577 #> EXTENSION        386 17289.154065 17289.152162 #> REFLECTION       388 17289.153701 17289.152077 #> LO-REDUCTION     390 17289.153645 17289.152077 #> REFLECTION       392 17289.153558 17289.151837 #> LO-REDUCTION     394 17289.153156 17289.151837 #> LO-REDUCTION     396 17289.153090 17289.151837 #> LO-REDUCTION     398 17289.152577 17289.151837 #> HI-REDUCTION     400 17289.152418 17289.151837 #> EXTENSION        402 17289.152162 17289.150909 #> LO-REDUCTION     404 17289.152109 17289.150909 #> LO-REDUCTION     406 17289.152077 17289.150909 #> LO-REDUCTION     408 17289.152055 17289.150909 #> LO-REDUCTION     410 17289.151913 17289.150909 #> LO-REDUCTION     412 17289.151868 17289.150909 #> LO-REDUCTION     414 17289.151837 17289.150909 #> EXTENSION        416 17289.151677 17289.150529 #> LO-REDUCTION     418 17289.151620 17289.150529 #> EXTENSION        420 17289.151536 17289.150258 #> LO-REDUCTION     422 17289.151371 17289.150258 #> EXTENSION        424 17289.151226 17289.149282 #> LO-REDUCTION     426 17289.151019 17289.149282 #> LO-REDUCTION     428 17289.150909 17289.149282 #> LO-REDUCTION     430 17289.150778 17289.149282 #> LO-REDUCTION     432 17289.150529 17289.149282 #> LO-REDUCTION     434 17289.150459 17289.149282 #> LO-REDUCTION     436 17289.150258 17289.149282 #> EXTENSION        438 17289.150196 17289.149030 #> LO-REDUCTION     440 17289.150015 17289.149030 #> EXTENSION        442 17289.149732 17289.148215 #> LO-REDUCTION     444 17289.149724 17289.148215 #> LO-REDUCTION     446 17289.149661 17289.148215 #> EXTENSION        448 17289.149490 17289.148082 #> REFLECTION       450 17289.149282 17289.147882 #> HI-REDUCTION     452 17289.149154 17289.147882 #> EXTENSION        454 17289.149030 17289.147689 #> EXTENSION        456 17289.148634 17289.146503 #> LO-REDUCTION     458 17289.148548 17289.146503 #> LO-REDUCTION     460 17289.148356 17289.146503 #> LO-REDUCTION     462 17289.148215 17289.146503 #> LO-REDUCTION     464 17289.148082 17289.146503 #> LO-REDUCTION     466 17289.147882 17289.146503 #> LO-REDUCTION     468 17289.147689 17289.146503 #> LO-REDUCTION     470 17289.147390 17289.146503 #> EXTENSION        472 17289.147372 17289.146209 #> EXTENSION        474 17289.147325 17289.145509 #> LO-REDUCTION     476 17289.147206 17289.145509 #> LO-REDUCTION     478 17289.147159 17289.145509 #> EXTENSION        480 17289.146556 17289.144353 #> LO-REDUCTION     482 17289.146550 17289.144353 #> LO-REDUCTION     484 17289.146503 17289.144353 #> EXTENSION        486 17289.146209 17289.143600 #> LO-REDUCTION     488 17289.145788 17289.143600 #> LO-REDUCTION     490 17289.145629 17289.143600 #> EXTENSION        492 17289.145509 17289.142801 #> LO-REDUCTION     494 17289.145288 17289.142801 #> EXTENSION        496 17289.144749 17289.142580 #> LO-REDUCTION     498 17289.144353 17289.142580 #> REFLECTION       500 17289.143924 17289.142388 #> LO-REDUCTION     502 17289.143813 17289.142388 #> LO-REDUCTION     504 17289.143710 17289.142388 #> EXTENSION        506 17289.143600 17289.141784 #> LO-REDUCTION     508 17289.142801 17289.141784 #> HI-REDUCTION     510 17289.142748 17289.141784 #> LO-REDUCTION     512 17289.142616 17289.141784 #> LO-REDUCTION     514 17289.142580 17289.141784 #> REFLECTION       516 17289.142500 17289.141716 #> LO-REDUCTION     518 17289.142388 17289.141716 #> REFLECTION       520 17289.142334 17289.141585 #> LO-REDUCTION     522 17289.142234 17289.141585 #> EXTENSION        524 17289.141991 17289.140765 #> LO-REDUCTION     526 17289.141796 17289.140765 #> LO-REDUCTION     528 17289.141786 17289.140765 #> LO-REDUCTION     530 17289.141784 17289.140765 #> LO-REDUCTION     532 17289.141772 17289.140765 #> EXTENSION        534 17289.141716 17289.140229 #> LO-REDUCTION     536 17289.141585 17289.140229 #> EXTENSION        538 17289.141362 17289.139857 #> LO-REDUCTION     540 17289.141111 17289.139857 #> EXTENSION        542 17289.140987 17289.139368 #> LO-REDUCTION     544 17289.140866 17289.139368 #> LO-REDUCTION     546 17289.140765 17289.139368 #> REFLECTION       548 17289.140709 17289.139248 #> LO-REDUCTION     550 17289.140229 17289.139248 #> REFLECTION       552 17289.139904 17289.139012 #> REFLECTION       554 17289.139857 17289.138897 #> LO-REDUCTION     556 17289.139487 17289.138897 #> LO-REDUCTION     558 17289.139371 17289.138897 #> LO-REDUCTION     560 17289.139368 17289.138897 #> LO-REDUCTION     562 17289.139253 17289.138897 #> EXTENSION        564 17289.139248 17289.138535 #> LO-REDUCTION     566 17289.139012 17289.138535 #> LO-REDUCTION     568 17289.139007 17289.138535 #> LO-REDUCTION     570 17289.138999 17289.138535 #> LO-REDUCTION     572 17289.138990 17289.138535 #> LO-REDUCTION     574 17289.138975 17289.138535 #> LO-REDUCTION     576 17289.138897 17289.138535 #> REFLECTION       578 17289.138817 17289.138485 #> LO-REDUCTION     580 17289.138745 17289.138485 #> EXTENSION        582 17289.138723 17289.138282 #> LO-REDUCTION     584 17289.138641 17289.138282 #> LO-REDUCTION     586 17289.138571 17289.138282 #> LO-REDUCTION     588 17289.138543 17289.138282 #> LO-REDUCTION     590 17289.138535 17289.138282 #> LO-REDUCTION     592 17289.138526 17289.138282 #> EXTENSION        594 17289.138485 17289.138060 #> EXTENSION        596 17289.138356 17289.137752 #> LO-REDUCTION     598 17289.138332 17289.137752 #> LO-REDUCTION     600 17289.138307 17289.137752 #> LO-REDUCTION     602 17289.138302 17289.137752 #> EXTENSION        604 17289.138289 17289.137475 #> LO-REDUCTION     606 17289.138282 17289.137475 #> LO-REDUCTION     608 17289.138060 17289.137475 #> EXTENSION        610 17289.138056 17289.137172 #> LO-REDUCTION     612 17289.137937 17289.137172 #> EXTENSION        614 17289.137833 17289.136763 #> LO-REDUCTION     616 17289.137808 17289.136763 #> EXTENSION        618 17289.137752 17289.136209 #> LO-REDUCTION     620 17289.137512 17289.136209 #> EXTENSION        622 17289.137475 17289.135715 #> EXTENSION        624 17289.137183 17289.134720 #> LO-REDUCTION     626 17289.137172 17289.134720 #> LO-REDUCTION     628 17289.136910 17289.134720 #> EXTENSION        630 17289.136763 17289.133898 #> LO-REDUCTION     632 17289.136395 17289.133898 #> EXTENSION        634 17289.136209 17289.132040 #> LO-REDUCTION     636 17289.135715 17289.132040 #> LO-REDUCTION     638 17289.135220 17289.132040 #> EXTENSION        640 17289.134996 17289.130704 #> LO-REDUCTION     642 17289.134720 17289.130704 #> EXTENSION        644 17289.133962 17289.130357 #> EXTENSION        646 17289.133898 17289.128792 #> EXTENSION        648 17289.132444 17289.125823 #> LO-REDUCTION     650 17289.132232 17289.125823 #> LO-REDUCTION     652 17289.132040 17289.125823 #> LO-REDUCTION     654 17289.130832 17289.125823 #> LO-REDUCTION     656 17289.130704 17289.125823 #> LO-REDUCTION     658 17289.130357 17289.125823 #> LO-REDUCTION     660 17289.128792 17289.125823 #> LO-REDUCTION     662 17289.128276 17289.125823 #> LO-REDUCTION     664 17289.128208 17289.125823 #> EXTENSION        666 17289.128166 17289.124162 #> LO-REDUCTION     668 17289.128165 17289.124162 #> EXTENSION        670 17289.127639 17289.122521 #> LO-REDUCTION     672 17289.126750 17289.122521 #> LO-REDUCTION     674 17289.126352 17289.122521 #> EXTENSION        676 17289.125995 17289.120555 #> LO-REDUCTION     678 17289.125823 17289.120555 #> EXTENSION        680 17289.125122 17289.120009 #> EXTENSION        682 17289.124162 17289.118228 #> LO-REDUCTION     684 17289.122960 17289.118228 #> LO-REDUCTION     686 17289.122937 17289.118228 #> REFLECTION       688 17289.122521 17289.118049 #> LO-REDUCTION     690 17289.121998 17289.118049 #> EXTENSION        692 17289.120555 17289.114665 #> HI-REDUCTION     694 17289.120009 17289.114665 #> LO-REDUCTION     696 17289.119590 17289.114665 #> LO-REDUCTION     698 17289.119356 17289.114665 #> LO-REDUCTION     700 17289.118291 17289.114665 #> LO-REDUCTION     702 17289.118288 17289.114665 #> EXTENSION        704 17289.118228 17289.113381 #> LO-REDUCTION     706 17289.118049 17289.113381 #> LO-REDUCTION     708 17289.117504 17289.113381 #> EXTENSION        710 17289.116483 17289.112471 #> EXTENSION        712 17289.115678 17289.109345 #> LO-REDUCTION     714 17289.115541 17289.109345 #> LO-REDUCTION     716 17289.114665 17289.109345 #> LO-REDUCTION     718 17289.114477 17289.109345 #> LO-REDUCTION     720 17289.113634 17289.109345 #> LO-REDUCTION     722 17289.113381 17289.109345 #> LO-REDUCTION     724 17289.112766 17289.109345 #> LO-REDUCTION     726 17289.112471 17289.109345 #> EXTENSION        728 17289.111818 17289.107773 #> LO-REDUCTION     730 17289.111746 17289.107773 #> LO-REDUCTION     732 17289.111245 17289.107773 #> EXTENSION        734 17289.111091 17289.106063 #> LO-REDUCTION     736 17289.110663 17289.106063 #> LO-REDUCTION     738 17289.109600 17289.106063 #> EXTENSION        740 17289.109345 17289.105024 #> LO-REDUCTION     742 17289.108880 17289.105024 #> EXTENSION        744 17289.107989 17289.103245 #> LO-REDUCTION     746 17289.107773 17289.103245 #> EXTENSION        748 17289.106271 17289.102524 #> EXTENSION        750 17289.106140 17289.100785 #> HI-REDUCTION     752 17289.106063 17289.100785 #> LO-REDUCTION     754 17289.105467 17289.100785 #> LO-REDUCTION     756 17289.105024 17289.100785 #> EXTENSION        758 17289.104800 17289.099737 #> LO-REDUCTION     760 17289.103902 17289.099737 #> HI-REDUCTION     762 17289.103245 17289.099737 #> EXTENSION        764 17289.102760 17289.098971 #> EXTENSION        766 17289.102723 17289.097388 #> LO-REDUCTION     768 17289.102524 17289.097388 #> EXTENSION        770 17289.101955 17289.095649 #> LO-REDUCTION     772 17289.100785 17289.095649 #> LO-REDUCTION     774 17289.100237 17289.095649 #> EXTENSION        776 17289.099737 17289.094176 #> LO-REDUCTION     778 17289.098971 17289.094176 #> LO-REDUCTION     780 17289.098143 17289.094176 #> LO-REDUCTION     782 17289.097880 17289.094176 #> EXTENSION        784 17289.097591 17289.091226 #> EXTENSION        786 17289.097388 17289.089069 #> LO-REDUCTION     788 17289.095649 17289.089069 #> LO-REDUCTION     790 17289.094674 17289.089069 #> LO-REDUCTION     792 17289.094652 17289.089069 #> LO-REDUCTION     794 17289.094566 17289.089069 #> EXTENSION        796 17289.094176 17289.087095 #> LO-REDUCTION     798 17289.092354 17289.087095 #> LO-REDUCTION     800 17289.092156 17289.087095 #> LO-REDUCTION     802 17289.091715 17289.087095 #> EXTENSION        804 17289.091226 17289.083939 #> LO-REDUCTION     806 17289.089665 17289.083939 #> LO-REDUCTION     808 17289.089506 17289.083939 #> EXTENSION        810 17289.089069 17289.080477 #> LO-REDUCTION     812 17289.087649 17289.080477 #> LO-REDUCTION     814 17289.087188 17289.080477 #> LO-REDUCTION     816 17289.087095 17289.080477 #> LO-REDUCTION     818 17289.085216 17289.080477 #> LO-REDUCTION     820 17289.084941 17289.080477 #> LO-REDUCTION     822 17289.084029 17289.080477 #> EXTENSION        824 17289.083939 17289.078527 #> LO-REDUCTION     826 17289.082956 17289.078527 #> LO-REDUCTION     828 17289.082866 17289.078527 #> EXTENSION        830 17289.081381 17289.076568 #> LO-REDUCTION     832 17289.081227 17289.076568 #> LO-REDUCTION     834 17289.080496 17289.076568 #> EXTENSION        836 17289.080477 17289.074508 #> HI-REDUCTION     838 17289.079939 17289.074508 #> LO-REDUCTION     840 17289.079200 17289.074508 #> EXTENSION        842 17289.078527 17289.073373 #> EXTENSION        844 17289.077815 17289.072709 #> LO-REDUCTION     846 17289.077222 17289.072709 #> LO-REDUCTION     848 17289.076735 17289.072709 #> LO-REDUCTION     850 17289.076568 17289.072709 #> EXTENSION        852 17289.074832 17289.070756 #> LO-REDUCTION     854 17289.074508 17289.070756 #> LO-REDUCTION     856 17289.074125 17289.070756 #> LO-REDUCTION     858 17289.073623 17289.070756 #> EXTENSION        860 17289.073373 17289.068622 #> LO-REDUCTION     862 17289.073250 17289.068622 #> LO-REDUCTION     864 17289.072709 17289.068622 #> LO-REDUCTION     866 17289.072460 17289.068622 #> LO-REDUCTION     868 17289.072372 17289.068622 #> LO-REDUCTION     870 17289.071455 17289.068622 #> LO-REDUCTION     872 17289.071020 17289.068622 #> LO-REDUCTION     874 17289.070882 17289.068622 #> EXTENSION        876 17289.070756 17289.068081 #> EXTENSION        878 17289.070498 17289.065876 #> LO-REDUCTION     880 17289.069611 17289.065876 #> LO-REDUCTION     882 17289.069527 17289.065876 #> EXTENSION        884 17289.069417 17289.064672 #> EXTENSION        886 17289.068794 17289.061734 #> LO-REDUCTION     888 17289.068622 17289.061734 #> LO-REDUCTION     890 17289.068081 17289.061734 #> EXTENSION        892 17289.066584 17289.057845 #> LO-REDUCTION     894 17289.066230 17289.057845 #> LO-REDUCTION     896 17289.065876 17289.057845 #> EXTENSION        898 17289.064672 17289.055947 #> EXTENSION        900 17289.063358 17289.053844 #> EXTENSION        902 17289.063141 17289.052345 #> EXTENSION        904 17289.061734 17289.050642 #> EXTENSION        906 17289.059974 17289.047222 #> EXTENSION        908 17289.058292 17289.043892 #> LO-REDUCTION     910 17289.057845 17289.043892 #> LO-REDUCTION     912 17289.055947 17289.043892 #> LO-REDUCTION     914 17289.053844 17289.043892 #> HI-REDUCTION     916 17289.052345 17289.043892 #> HI-REDUCTION     918 17289.050642 17289.043892 #> LO-REDUCTION     920 17289.048103 17289.043892 #> HI-REDUCTION     922 17289.047899 17289.043892 #> LO-REDUCTION     924 17289.047866 17289.043892 #> LO-REDUCTION     926 17289.047222 17289.043892 #> LO-REDUCTION     928 17289.047131 17289.043892 #> EXTENSION        930 17289.046353 17289.042209 #> LO-REDUCTION     932 17289.046255 17289.042209 #> LO-REDUCTION     934 17289.045471 17289.042209 #> EXTENSION        936 17289.044714 17289.040269 #> EXTENSION        938 17289.044649 17289.037362 #> LO-REDUCTION     940 17289.044112 17289.037362 #> LO-REDUCTION     942 17289.043892 17289.037362 #> LO-REDUCTION     944 17289.042584 17289.037362 #> LO-REDUCTION     946 17289.042324 17289.037362 #> LO-REDUCTION     948 17289.042209 17289.037362 #> EXTENSION        950 17289.040382 17289.033960 #> LO-REDUCTION     952 17289.040269 17289.033960 #> LO-REDUCTION     954 17289.039777 17289.033960 #> EXTENSION        956 17289.039477 17289.031085 #> LO-REDUCTION     958 17289.039384 17289.031085 #> EXTENSION        960 17289.037477 17289.029757 #> LO-REDUCTION     962 17289.037362 17289.029757 #> LO-REDUCTION     964 17289.036963 17289.029757 #> EXTENSION        966 17289.034508 17289.025230 #> LO-REDUCTION     968 17289.033960 17289.025230 #> LO-REDUCTION     970 17289.033351 17289.025230 #> EXTENSION        972 17289.031085 17289.023573 #> LO-REDUCTION     974 17289.030785 17289.023573 #> LO-REDUCTION     976 17289.030431 17289.023573 #> LO-REDUCTION     978 17289.029757 17289.023573 #> LO-REDUCTION     980 17289.029215 17289.023573 #> LO-REDUCTION     982 17289.027198 17289.023573 #> EXTENSION        984 17289.026203 17289.022041 #> LO-REDUCTION     986 17289.025551 17289.022041 #> LO-REDUCTION     988 17289.025295 17289.022041 #> LO-REDUCTION     990 17289.025230 17289.022041 #> HI-REDUCTION     992 17289.024774 17289.022041 #> REFLECTION       994 17289.023776 17289.021364 #> LO-REDUCTION     996 17289.023573 17289.021364 #> LO-REDUCTION     998 17289.023375 17289.021364 #> EXTENSION       1000 17289.023258 17289.020647 #> Exiting from Nelder Mead minimizer #>     1002 function evaluations used # extract results  # regression coefficient vector res2$beta #> [1] -2.32798372  0.58760533 -0.09963433  0.63521793  0.41916222 -0.36081430 #> [7]  0.27574700   # check likelihood -ll(res2$beta) #> [1] -17289.02  # number of calls to log lik function # since optim does not return the number of # iterations res2$iter #> function gradient  #>     1002       NA   # optim does not calculated working weights head(res2$weights) #> [1] 1 # }"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/farmsubmission.html","id":null,"dir":"Reference","previous_headings":"","what":"The British farm submissions data â€” farmsubmission","title":"The British farm submissions data â€” farmsubmission","text":"Data British animal farms submissions AHVLA. British farms able submit samples AHVLA cause death animal determined private veterinary surgeon decides submit , unless notifiable disease suspected submission required. data set contains information farms. submissions farms included data frame carcasses also blood samples etc.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/farmsubmission.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The British farm submissions data â€” farmsubmission","text":"","code":"data(\"farmsubmission\")"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/farmsubmission.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"The British farm submissions data â€” farmsubmission","text":"Data frame 12,036 rows 4 columns. TOTAL_SUB Number submissions animal material. log_size Numerical value equal logarithm size farm. log_distance Numerical value equal logarithm distance nearest AHVLA center. C_TYPE Factor describing type activity farm animals used . Either Dairy Beef","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/farmsubmission.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The British farm submissions data â€” farmsubmission","text":"data set description provided publication: BÃ¶hning, D., Vidal Diez, ., Lerdsuwansri, R., Viwatwongkasem, C., Arnold, M. (2013). \"generalization Chao's estimator covariate information\". Biometrics, 69(4), 1033-1042. doi:10.1111/biom.12082","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":null,"dir":"Reference","previous_headings":"","what":"Observed and fitted marginal frequencies â€” marginalFreq","title":"Observed and fitted marginal frequencies â€” marginalFreq","text":"function given fitted singleR class object computed marginal frequencies sum probability density functions unit data point .e. kth element marginal frequency table given \\(\\sum_{j=1}^{N_{obs}}\\mathbb{P}(Y_{j}=k|\\eta_{j})\\). k=0 (specified call) computed \\(\\hat{N}-N_{obs}\\) \\(\\boldsymbol{f}_{0}\\) assumed unobserved part studied population. frequencies useful diagnostics count data regression, assessment fit.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Observed and fitted marginal frequencies â€” marginalFreq","text":"","code":"marginalFreq(   object,   includeones = TRUE,   includezeros = TRUE,   onecount = NULL,   range,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Observed and fitted marginal frequencies â€” marginalFreq","text":"object object singleR class. includeones logical value indicating whether include estimated number zero counts. includezeros logical value indicating whether include one counts zero-one truncated models. onecount numeric value indicating number one counts null trcount object assumed number one counts. range optional argument specifying range selected Y values. ... currently nothing.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Observed and fitted marginal frequencies â€” marginalFreq","text":"list observed name fitted model family degrees freedom observed fitted marginal frequencies.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Observed and fitted marginal frequencies â€” marginalFreq","text":"Piotr Chlebicki MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}};","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/netherlandsimmigrant.html","id":null,"dir":"Reference","previous_headings":"","what":"Immigration data in the Netherlands â€” netherlandsimmigrant","title":"Immigration data in the Netherlands â€” netherlandsimmigrant","text":"data set contains information immigrants four cities (Amsterdam, Rotterdam, Hague Utrecht) Netherlands staying country illegally 1995 appeared police records year.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/netherlandsimmigrant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Immigration data in the Netherlands â€” netherlandsimmigrant","text":"","code":"data(\"netherlandsimmigrant\")"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/netherlandsimmigrant.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Immigration data in the Netherlands â€” netherlandsimmigrant","text":"Data frame 1,880 rows 5 columns. capture Number times person captured police. gender Factor describing gender apprehended person. age Factor describing age apprehended person. Either bellow 40 years old. reason Factor describing reason apprehended police either illegal stay Netherlands reasons. nation Factor nation origin captured person. 6 levels variable: \"American Australia\",   \"Asia\", \"North Africa\", \"Rest Africa\", \"Surinam\", \"Turkey\".","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/netherlandsimmigrant.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Immigration data in the Netherlands â€” netherlandsimmigrant","text":"data set description provided publication: van Der Heijden, P. G., Bustami, R., Cruyff, M. J., Engbersen, G., Van Houwelingen, H. C. (2003). Point interval estimation population size using truncated Poisson regression model. Statistical Modelling, 3(4), 305-322. doi:10.1191/1471082X03st057oa","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleRStaticCountData.html","id":null,"dir":"Reference","previous_headings":"","what":"Diagnostic plots for regression and population size estimation â€” plot.singleRStaticCountData","title":"Diagnostic plots for regression and population size estimation â€” plot.singleRStaticCountData","text":"Simple diagnostic plots singleRStaticCountData class objects.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleRStaticCountData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Diagnostic plots for regression and population size estimation â€” plot.singleRStaticCountData","text":"","code":"# S3 method for class 'singleRStaticCountData' plot(   x,   plotType = c(\"qq\", \"marginal\", \"fitresid\", \"bootHist\", \"rootogram\", \"dfpopContr\",     \"dfpopBox\", \"scaleLoc\", \"cooks\", \"hatplot\", \"strata\"),   confIntStrata = c(\"normal\", \"logNormal\"),   histKernels = TRUE,   dfpop,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleRStaticCountData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Diagnostic plots for regression and population size estimation â€” plot.singleRStaticCountData","text":"x object singleRStaticCountData class. plotType character parameter (default \"qq\") specifying type plot made. following list presents briefly explains possible type plots: qq â€“ quantile-quantile plot pearson residuals (standardized pearson residuals available model) .e. empirical quantiles residuals plotted theoretical quantiles standard distribution. marginal â€“ plot made matplot fitted observed marginal frequencies labels. fitresid â€“ Plot fitted linear predictors (standardized) pearson residuals. bootHist â€“ Simple histogram statistics obtained bootstrapping (one performed statistics saved). rootogram â€“ Rootogram, full explanation see: Kleiber Zeileis Visualizing Count Data Regressions Using Rootograms (2016), short barplot height square root observed marginal frequencies adjusted difference square root observed fitted marginal frequencies connected line representing fitted marginal frequencies. less difference 0 line beginning bar accurate fitt produced model. dfpopContr â€“ Plot dfpopsize unit contribution. plot y = x line .e. deletion effect removing unit model effect regression coefficients. away observation line influential . dfpopBox â€“ Boxplot dfpopsize getting general idea distribution \"influence\" unit population size estimate. scaleLoc â€“ scale - location plot .e. square root absolute values (standardized) pearson residuals linear predictors column linear predictors. cooks â€“ Plot cooks distance detecting influential observations. hatplot â€“ Plot hat values linear predictor detecting influential observations. strata â€“ Plot confidence intervals point estimates strata provided ... argument confIntStrata confidence interval type use strata plot. Currently supported values \"normal\" \"logNormal\". histKernels logical value indicating whether add density lines histogram. dfpop TODO ... additional optional arguments passed following functions: plotType = \"bootHist\" graphics::hist â€“ x, main, xlab, ylab parameters fixed. plotType = \"rootogram\" graphics::barplot â€“ height, offset, ylab, xlab, ylim parameters fixed. graphics::lines â€“ x, y, pch, type, lwd, col parameters fixed. plotType = \"dfpopContr\" dfpopsize â€“ model, observedPop parameters fixed. plot.default â€“ x, y, xlab, main parameters fixed. plotType = \"dfpopBox\" dfpopsize â€“ model, observedPop parameters fixed. graphics::boxplot â€“ x, ylab, main parameters fixed. plotType = \"scaleLoc\" plot.default â€“ x, y, xlab, ylab, main, sub parameters fixed. plotType = \"fitresid\" plot.default â€“ x, y, xlab, ylab, main, sub parameters fixed. plotType = \"cooks\" plot.default â€“ x, xlab, ylab, main parameters fixed. plotType = \"hatplot\" hatvalues.singleRStaticCountData plot.default â€“ x, xlab, ylab, main parameters fixed. plotType = \"strata\" stratifyPopsize.singleRStaticCountData","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleRStaticCountData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Diagnostic plots for regression and population size estimation â€” plot.singleRStaticCountData","text":"return value plot made.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleRStaticCountData.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Diagnostic plots for regression and population size estimation â€” plot.singleRStaticCountData","text":"Piotr Chlebicki","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/popSizeEst.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract population size estimation results â€” popSizeEst","title":"Extract population size estimation results â€” popSizeEst","text":"extractor function singleRStaticCountData method extracting important information regarding pop size estimate.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/popSizeEst.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract population size estimation results â€” popSizeEst","text":"","code":"popSizeEst(object, ...)  # S3 method for class 'singleRStaticCountData' popSizeEst(object, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/popSizeEst.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract population size estimation results â€” popSizeEst","text":"object object population size estimates. ... additional optional arguments, currently used singleRStaticCountData class method.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/popSizeEst.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract population size estimation results â€” popSizeEst","text":"object class popSizeEstResults containing population size estimation results.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/predict.singleRStaticCountData.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict method for singleRStaticCountData class â€” predict.singleRStaticCountData","title":"Predict method for singleRStaticCountData class â€” predict.singleRStaticCountData","text":"method predict function, works analogous predict.glm gives possibility get standard errors mean/distribution parameters directly get pop size estimates new data.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/predict.singleRStaticCountData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict method for singleRStaticCountData class â€” predict.singleRStaticCountData","text":"","code":"# S3 method for class 'singleRStaticCountData' predict(   object,   newdata,   type = c(\"response\", \"link\", \"mean\", \"popSize\", \"contr\"),   se.fit = FALSE,   na.action = NULL,   weights,   cov,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/predict.singleRStaticCountData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict method for singleRStaticCountData class â€” predict.singleRStaticCountData","text":"object object singleRStaticCountData class. newdata optional data.frame containing new data. type type prediction required, possible values : \"response\"â€“ matrix containing estimated distributions parameters. \"link\"    â€“ matrix linear predictors. \"mean\"    â€“ fitted values \\(Y\\) \\(Y|Y>0\\). \"contr\"   â€“ inverse probability weights (named observation contribution population size estimate). \"popSize\" â€“ population size estimation. Note results call redoPopEstimation usually better call function directly. default set \"response\". se.fit logical value indicating whether standard errors computed. matters type \"response\", \"mean\", \"link\". na.action nothing yet. weights optional vector weights type \"contr\", \"popSize\". cov optional matrix function character specifying either covariance matrix function compute covariance matrix. default vcov.singleRStaticCountData can set e.g. vcovHC. ... arguments passed functions, now affects vcov.singleRStaticCountData method cov function.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/predict.singleRStaticCountData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict method for singleRStaticCountData class â€” predict.singleRStaticCountData","text":"Depending type argument one \"response\", \"link\", \"mean\" matrix fitted values possibly standard errors se.fit argument set TRUE, type set \"contr\" vector inverses probabilities, finally \"popSize\" object class popSizeEstResults methods containing population size estimation results.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/predict.singleRStaticCountData.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict method for singleRStaticCountData class â€” predict.singleRStaticCountData","text":"MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}}; Standard errors computed assumption regression coefficients asymptotically normally distributed, assumption holds linear predictors .e. row \\(\\boldsymbol{\\eta}=\\boldsymbol{X}_{vlm}\\boldsymbol{\\beta}\\) asymptotically normally distributed variances expressed well known formula. mean \\(\\mu\\) distribution parameters differentiable functions asymptotically normally distributed variables therefore variances can computed using (multivariate) delta method.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":null,"dir":"Reference","previous_headings":"","what":"Updating population size estimation results â€” redoPopEstimation","title":"Updating population size estimation results â€” redoPopEstimation","text":"function applies post-hoc procedures taken (heteroscedastic consistent covariance matrix estimation bias reduction) population size estimation standard error estimation.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Updating population size estimation results â€” redoPopEstimation","text":"","code":"redoPopEstimation(object, newdata, ...)  # S3 method for class 'singleRStaticCountData' redoPopEstimation(   object,   newdata,   cov,   weights,   coef,   control,   popVar,   offset,   weightsAsCounts,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Updating population size estimation results â€” redoPopEstimation","text":"object object update population size estimation results done. newdata optional data.frame new data pop size estimation. ... additional optional arguments, currently used singleRStaticCountData class method. cov updated covariance matrix estimate. weights optional vector weights use population size estimation. coef optional vector coefficients regression base population size estimation. missing set coef(object). control similar controlPopVar estimatePopsize(). missing set controls provided call object. popVar similar popVar estimatePopsize(). missing set \"analytic\". offset offset argument new data weightsAsCounts singleRStaticCountData method used specify whether weights treated number occurrences rows data","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Updating population size estimation results â€” redoPopEstimation","text":"object class popSizeEstResults containing updated population size estimation results.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Updating population size estimation results â€” redoPopEstimation","text":"MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}}; non specified arguments inferred object","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Updating population size estimation results â€” redoPopEstimation","text":"","code":"# Create simple model Model <- estimatePopsize(   formula = capture ~ nation + gender,    data = netherlandsimmigrant,    model = ztpoisson,    method = \"IRLS\" ) # Apply heteroscedasticity consistent covariance matrix estimation require(sandwich) #> Loading required package: sandwich cov <- vcovHC(Model, type = \"HC3\") summary(Model, cov = cov, popSizeEst = redoPopEstimation(Model, cov = cov)) #>  #> Call: #> estimatePopsize.default(formula = capture ~ nation + gender,  #>     data = netherlandsimmigrant, model = ztpoisson, method = \"IRLS\") #>  #> Pearson Residuals: #>       Min.    1st Qu.     Median       Mean    3rd Qu.       Max.  #> -0.4796685 -0.4796685 -0.3518333  0.0004493 -0.2257173 14.0588575  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.3977     0.2553  -5.475 4.37e-08 *** #> nationAsia            -1.0560     0.3940  -2.680  0.00736 **  #> nationNorth Africa     0.2327     0.2399   0.970  0.33200     #> nationRest of Africa  -0.8864     0.3514  -2.523  0.01164 *   #> nationSurinam         -2.3519     1.0273  -2.289  0.02205 *   #> nationTurkey          -1.6845     0.6110  -2.757  0.00583 **  #> gendermale             0.3833     0.2014   1.904  0.05695 .   #> --- #> Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 #>  #> AIC: 1718.993 #> BIC: 1757.766 #> Residual deviance: 1136.645 #>  #> Log-likelihood: -852.4963 on 1873 Degrees of freedom  #> Number of iterations: 8 #> ----------------------- #> Population size estimation results:  #> Point estimate 11879.92 #> Observed proportion: 15.8% (N obs = 1880) #> Std. Error 2531.196 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      6918.872   16840.98 #> logNormal   8015.862   18177.38 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      11.16325   27.17206 #> logNormal   10.34252   23.45350 # Compare to results with usual covariance matrix estimation summary(Model) #>  #> Call: #> estimatePopsize.default(formula = capture ~ nation + gender,  #>     data = netherlandsimmigrant, model = ztpoisson, method = \"IRLS\") #>  #> Pearson Residuals: #>       Min.    1st Qu.     Median       Mean    3rd Qu.       Max.  #> -0.4796685 -0.4796685 -0.3518333  0.0004493 -0.2257173 14.0588575  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.3977     0.2146  -6.514 7.33e-11 *** #> nationAsia            -1.0560     0.3016  -3.501 0.000464 *** #> nationNorth Africa     0.2327     0.1939   1.200 0.230002     #> nationRest of Africa  -0.8864     0.3009  -2.946 0.003224 **  #> nationSurinam         -2.3519     1.0137  -2.320 0.020337 *   #> nationTurkey          -1.6845     0.6029  -2.794 0.005203 **  #> gendermale             0.3833     0.1630   2.352 0.018686 *   #> --- #> Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 #>  #> AIC: 1718.993 #> BIC: 1757.766 #> Residual deviance: 1136.645 #>  #> Log-likelihood: -852.4963 on 1873 Degrees of freedom  #> Number of iterations: 8 #> ----------------------- #> Population size estimation results:  #> Point estimate 11879.92 #> Observed proportion: 15.8% (N obs = 1880) #> Std. Error 2448.792 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      7080.380   16679.47 #> logNormal   8111.333   17927.69 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      11.27134   26.55225 #> logNormal   10.48657   23.17745  ## get confidence interval with larger significance level redoPopEstimation(Model, control = controlPopVar(alpha = .000001)) #> Point estimate: 11879.92 #> Variance: 5996583 #> 99.9999% confidence intervals: #>           lowerBound upperBound #> normal      1880.000   23858.53 #> logNormal   4951.313   34438.87"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Regression diagnostics in singleRcapture â€” regDiagSingleR","title":"Regression diagnostics in singleRcapture â€” regDiagSingleR","text":"List regression diagnostics implemented singleRStaticCountData class. Functions either require changes glm class relevant context singleRcapture omitted.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regression diagnostics in singleRcapture â€” regDiagSingleR","text":"","code":"dfpopsize(model, ...)  # S3 method for class 'singleRStaticCountData' dfpopsize(model, dfbeta = NULL, ...)  # S3 method for class 'singleRStaticCountData' dfbeta(model, maxitNew = 1, trace = FALSE, cores = 1, ...)  # S3 method for class 'singleRStaticCountData' hatvalues(model, ...)  # S3 method for class 'singleRStaticCountData' residuals(   object,   type = c(\"pearson\", \"pearsonSTD\", \"response\", \"working\", \"deviance\", \"all\"),   ... )  # S3 method for class 'singleRStaticCountData' cooks.distance(model, ...)  # S3 method for class 'singleRStaticCountData' sigma(object, ...)  # S3 method for class 'singleRStaticCountData' influence(model, do.coef = FALSE, ...)  # S3 method for class 'singleRStaticCountData' rstudent(model, ...)  # S3 method for class 'singleRStaticCountData' rstandard(model, type = c(\"deviance\", \"pearson\"), ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regression diagnostics in singleRcapture â€” regDiagSingleR","text":"model, object object singleRStaticCountData class. ... arguments passed methods. Notably dfpopsize.singleRStaticCountData calls dfbeta.singleRStaticCountData dfbeta argument provided controlMethod called dfbeta method. dfbeta dfbeta already obtained possible pass function need computed second time. maxitNew maximal number iterations regressions starting points \\(\\hat{\\boldsymbol{\\beta}}\\) data specified call model removal k'th row. default 1. trace logical value specifying whether tracking results cores > 1 result progress bar created. cores number processor cores used, number greater 1 activates code designed doParallel, foreach parallel packages. Note now using parallel computing makes tracing impossible trace parameter ignored case. type type residual return. .coef logical indicating dfbeta computation influence done. FALSE default.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regression diagnostics in singleRcapture â€” regDiagSingleR","text":"hatvalues â€“ matrix n rows p columns n number observations data p number regression parameters. dfpopsize â€“ vector k'th element corresponds difference point estimate population size estimation full data set point estimate population size estimation removal k'th unit data set. dfbeta â€“ matrix n rows p observations p number units data p number regression parameters. K'th row matrix corresponds \\(\\hat{\\boldsymbol{\\beta}}-\\hat{\\boldsymbol{\\beta}}_{-k}\\) \\(\\hat{\\boldsymbol{\\beta}}_{-k}\\) vector estimates regression parameters removal k'th row data. cooks.distance â€“ matrix single columns values cooks distance every unit model.matrix residuals.singleRStaticCountData â€“ data.frame chosen residuals.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Regression diagnostics in singleRcapture â€” regDiagSingleR","text":"MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}}; dfpopsize dfbeta closely related. dfbeta fits regression removing specific row data returns difference regression coefficients estimated full data set data set obtained deletion row, repeats procedure every unit present data.dfpopsize population size estimation utilizing coefficients computed dfbeta. cooks.distance implemented (now) models single linear predictor works exactly like method glm class. sigma computes standard errors predicted means. Returns matrix two columns first truncated mean non-truncated mean. residuals.singleRStaticCountData (can abbreviated resid) works like residuals.glm exception : \"pearson\" â€“ returns non standardized residuals. \"pearsonSTD\" â€“ currently defined single predictors models extended models near future, families one distribution parameter multivariate residual. \"response\" â€“ returns residuals computed truncated non truncated fitted value. \"working\" â€“ possibly multivariate one linear predictor present. \"deviance\" â€“ yet defined families singleRmodels() e.g. negative binomial based methods. \"\" â€“ returns available residual types. hatvalues.singleRStaticCountData method singleRStaticCountData class extracting diagonal elements projection matrix. Since singleRcapture supports regular glm's also vglm's hatvalues returns matrix number columns corresponding number linear predictors model, kth column corresponds elements diagonal projection matrix associated kth linear predictor. glm's \\[\\boldsymbol{W}^{\\frac{1}{2}}\\boldsymbol{X} \\left(\\boldsymbol{X}^{T}\\boldsymbol{W}\\boldsymbol{X}\\right)^{-1} \\boldsymbol{X}^{T}\\boldsymbol{W}^{\\frac{1}{2}}\\] : \\(\\boldsymbol{W}=\\mathbb{E}\\left(\\text{Diag} \\left(\\frac{\\partial^{2}\\ell}{\\partial\\boldsymbol{\\eta}^{T} \\partial\\boldsymbol{\\eta}}\\right)\\right)\\) \\(\\boldsymbol{X}\\) model (lm) matrix. vglm's present package instead : \\[\\boldsymbol{X}_{vlm} \\left(\\boldsymbol{X}_{vlm}^{T}\\boldsymbol{W}\\boldsymbol{X}_{vlm}\\right)^{-1} \\boldsymbol{X}_{vlm}^{T}\\boldsymbol{W}\\] : \\[ \\boldsymbol{W} = \\mathbb{E}\\left(\\begin{bmatrix} \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{1}^{T}\\partial\\eta_{1}}\\right) & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{1}^{T}\\partial\\eta_{2}}\\right) & \\dotso & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{1}^{T}\\partial\\eta_{p}}\\right)\\cr \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{2}^{T}\\partial\\eta_{1}}\\right) & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{2}^{T}\\partial\\eta_{2}}\\right) & \\dotso & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{2}^{T}\\partial\\eta_{p}}\\right)\\cr \\vdots & \\vdots & \\ddots & \\vdots\\cr \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{p}^{T}\\partial\\eta_{1}}\\right) & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{p}^{T}\\partial\\eta_{2}}\\right) & \\dotso & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{p}^{T}\\partial\\eta_{p}}\\right) \\end{bmatrix}\\right)\\] block matrix constructed taking expected  value diagonal matrixes corresponding second derivatives respect linear predictor (mixed derivatives) \\(\\boldsymbol{X}_{vlm}\\) model (vlm) matrix constructed using specifications controlModel call estimatePopsize. influence works like glm counterpart computing important influence measures.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Regression diagnostics in singleRcapture â€” regDiagSingleR","text":"Piotr Chlebicki, Maciej BerÄ™sewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Regression diagnostics in singleRcapture â€” regDiagSingleR","text":"","code":"# \\donttest{ # For singleRStaticCountData class # Get simple model Model <- estimatePopsize(   formula = capture ~ nation + age + gender,    data = netherlandsimmigrant,    model = ztpoisson,    method = \"IRLS\" ) # Get dfbeta dfb <- dfbeta(Model) # The dfpopsize results are obtained via (It is also possible to not provide  # dfbeta then they will be computed manually): res <- dfpopsize(Model, dfbeta = dfb) summary(res) #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -4236.412     2.663     2.663     5.448    17.284   117.448  plot(res)  # see vaious types of residuals: head(resid(Model, \"all\")) #>       lambda truncatedResponse nontruncatedResponse    pearson pearsonSTD #> 1 -0.9328875       -0.25364898            0.5294668 -0.4864422 -0.4867283 #> 2 -0.9328875       -0.25364898            0.5294668 -0.4864422 -0.4867283 #> 3 -0.9328875       -0.25364898            0.5294668 -0.4864422 -0.4867283 #> 4 -0.9791760       -0.06666172            0.8695135 -0.2554869 -0.2559964 #> 5 -0.9791760       -0.06666172            0.8695135 -0.2554869 -0.2559964 #> 6  2.7449807        0.74635102            1.5294668  1.4313347  1.4321768 #>     deviance #> 1 -0.6992491 #> 2 -0.6992491 #> 3 -0.6992491 #> 4 -0.3631875 #> 5 -0.3631875 #> 6  1.0619767 # }"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/simulate.html","id":null,"dir":"Reference","previous_headings":"","what":"Generating data in singleRcapture â€” simulate","title":"Generating data in singleRcapture â€” simulate","text":"S3 method stats::simulate handle singleRStaticCountData singleRfamily classes.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/simulate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generating data in singleRcapture â€” simulate","text":"","code":"# S3 method for class 'singleRStaticCountData' simulate(object, nsim = 1, seed = NULL, ...)  # S3 method for class 'singleRfamily' simulate(object, nsim, seed = NULL, eta, truncated = FALSE, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/simulate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generating data in singleRcapture â€” simulate","text":"object object representing fitted model. nsim numeric scalar specifying: number response vectors simulate simulate.singleRStaticCountData, defaults 1L. number units draw simulate.singleRfamily, defaults NROW(eta). seed object specifying random number generator initialized (â€˜seededâ€™). ... additional optional arguments. eta matrix linear predictors truncated logical value indicating whether sample truncated full distribution.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/simulate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generating data in singleRcapture â€” simulate","text":"data.frame n rows nsim columns.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/simulate.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Generating data in singleRcapture â€” simulate","text":"Maciej BerÄ™sewicz, Piotr Chlebicki","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/simulate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generating data in singleRcapture â€” simulate","text":"","code":"N <- 10000 ###gender <- rbinom(N, 1, 0.2) gender <- rep(0:1, c(8042, 1958)) eta <- -1 + 0.5*gender counts <- simulate(ztpoisson(), eta = cbind(eta), seed = 1) df <- data.frame(gender, eta, counts) df2 <- subset(df, counts > 0) ### check coverage with summary mod1 <-  estimatePopsize(   formula       = counts ~ 1 + gender,    data          = df2,    model         = ztpoisson,    controlMethod = list(silent = TRUE) ) mod1_sims <- simulate(mod1, nsim=10, seed = 1) colMeans(mod1_sims) #>    sim_1    sim_2    sim_3    sim_4    sim_5    sim_6    sim_7    sim_8  #> 1.241014 1.259281 1.239246 1.244255 1.226871 1.237773 1.239540 1.234532  #>    sim_9   sim_10  #> 1.230701 1.244844  mean(df2$counts) #> [1] 1.240424"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":null,"dir":"Reference","previous_headings":"","what":"Family functions in singleRcapture package â€” chao","title":"Family functions in singleRcapture package â€” chao","text":"Package singleRcapture utilizes various family type functions specify variable parts population size estimation, regression, diagnostics necessary information depends model. functions used model argument estimatePopsize function.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Family functions in singleRcapture package â€” chao","text":"","code":"chao(lambdaLink = \"loghalf\", ...)  Hurdleztgeom(   lambdaLink = c(\"log\", \"neglog\"),   piLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  Hurdleztnegbin(   nSim = 1000,   epsSim = 1e-08,   eimStep = 6,   lambdaLink = c(\"log\", \"neglog\"),   alphaLink = c(\"log\", \"neglog\"),   piLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  Hurdleztpoisson(   lambdaLink = c(\"log\", \"neglog\"),   piLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  oiztgeom(   lambdaLink = c(\"log\", \"neglog\"),   omegaLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  oiztnegbin(   nSim = 1000,   epsSim = 1e-08,   eimStep = 6,   lambdaLink = c(\"log\", \"neglog\"),   alphaLink = c(\"log\", \"neglog\"),   omegaLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  oiztpoisson(   lambdaLink = c(\"log\", \"neglog\"),   omegaLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  zelterman(lambdaLink = \"loghalf\", ...)  zotgeom(lambdaLink = c(\"log\", \"neglog\"), ...)  zotnegbin(   nSim = 1000,   epsSim = 1e-08,   eimStep = 6,   lambdaLink = c(\"log\", \"neglog\"),   alphaLink = c(\"log\", \"neglog\"),   ... )  zotpoisson(lambdaLink = c(\"log\", \"neglog\"), ...)  ztHurdlegeom(   lambdaLink = c(\"log\", \"neglog\"),   piLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  ztHurdlenegbin(   nSim = 1000,   epsSim = 1e-08,   eimStep = 6,   lambdaLink = c(\"log\", \"neglog\"),   alphaLink = c(\"log\", \"neglog\"),   piLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  ztHurdlepoisson(   lambdaLink = c(\"log\", \"neglog\"),   piLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  ztgeom(lambdaLink = c(\"log\", \"neglog\"), ...)  ztnegbin(   nSim = 1000,   epsSim = 1e-08,   eimStep = 6,   lambdaLink = c(\"log\", \"neglog\"),   alphaLink = c(\"log\", \"neglog\"),   ... )  ztoigeom(   lambdaLink = c(\"log\", \"neglog\"),   omegaLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  ztoinegbin(   nSim = 1000,   epsSim = 1e-08,   eimStep = 6,   lambdaLink = c(\"log\", \"neglog\"),   alphaLink = c(\"log\", \"neglog\"),   omegaLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  ztoipoisson(   lambdaLink = c(\"log\", \"neglog\"),   omegaLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  ztpoisson(lambdaLink = c(\"log\", \"neglog\"), ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Family functions in singleRcapture package â€” chao","text":"lambdaLink link Poisson parameter, \"log\" default except zelterman's chao's models \\(\\ln\\left(\\frac{x}{2}\\right)\\) possible. ... Additional arguments, used now. piLink link probability parameter,  \"logit\" default nSim, epsSim working weights computed analytically arguments specify maximum number simulations allowed precision level finding numerically respectively. eimStep non negative integer describing many values used step approximation information matrixes analytic solution available (e.g. \"ztnegbin\"), default varies depending function. Higher value usually means faster convergence may potentially cause issues convergence. alphaLink link dispersion parameter, \"log\" default omegaLink link inflation parameter, \"logit\" default","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Family functions in singleRcapture package â€” chao","text":"object class family containing objects: makeMinusLogLike â€“ factory function creating following functions: \\(\\ell(\\boldsymbol{\\beta}), \\frac{\\partial\\ell}{\\partial\\boldsymbol{\\beta}}, \\frac{\\partial^{2}\\ell}{\\partial\\boldsymbol{\\beta}^{T}\\partial\\boldsymbol{\\beta}} \\) functions \\(\\boldsymbol{y}\\) vector \\(\\boldsymbol{X}_{vlm}\\) matrix (just \\(\\boldsymbol{X}\\) applied model single linear predictor)deriv argument possible values c(0, 1, 2) determine derivative return; default value 0, represents minus log-likelihood. links â€“ list link functions. mu.eta, variance â€“ Functions linear predictors return expected value variance. type argument 2 possible values (\"trunc\" \"nontrunc\") specifies whether return \\(\\mathbb{E}(Y|Y>0), \\text{var}(Y|Y>0)\\) \\(\\mathbb{E}(Y), \\text{var}(Y)\\) respectively; deriv argument values c(0, 1, 2) used indicating derivative respect linear predictors, used providing standard errors predict method. family â€“ string specifies name model. valideta, validmu â€“ now returns TRUE. near future, used check whether applied linear predictors valid (.e. transformed elements parameter space subjected inverse link function). funcZ, Wfun â€“ Functions create pseudo residuals working weights used IRLS algorithm. devResids â€“ function given linear predictors prior weights vector response vector returns deviance residuals. family functions functions implemented yet. pointEst, popVar â€“ Functions given prior weights linear predictors latter case also estimate \\(\\text{cov}(\\hat{\\boldsymbol{\\beta}})\\) \\(\\boldsymbol{X_{vlm}}\\) matrix return point estimate population size analytic estimation variance.additional boolean parameter contr former function set true returns contribution unit. etaNames â€“ Names linear predictors. densityFunction â€“ function given linear predictors returns value PMF values x. Additional argument type specifies whether return \\(\\mathbb{P}(Y|Y>0)\\) \\(\\mathbb{P}(Y)\\). simulate â€“ function generates values dependent vector given linear predictors. getStart â€“ expression generating starting points.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Family functions in singleRcapture package â€” chao","text":"MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}}; functions based \"base\" distribution support \\(\\mathbb{N}_{0}=\\mathbb{N}\\cup\\lbrace 0\\rbrace\\) describe distribution \\(Y\\) truncation. Currently include: \\[\\mathbb{P}(Y=y|\\lambda,\\alpha)=\\left\\lbrace \\begin{array}{cc} \\frac{\\lambda^{y}e^{-\\lambda}}{y!}    & \\text{Poisson distribution}  \\cr \\frac{\\Gamma(y+\\alpha^{-1})}{\\Gamma(\\alpha^{-1})y!} \\left(\\frac{\\alpha^{-1}}{\\alpha^{-1}+\\lambda}\\right)^{\\alpha^{-1}} \\left(\\frac{\\lambda}{\\alpha^{-1}+\\lambda}\\right)^{y} & \\text{negative binomial distribution} \\cr \\frac{\\lambda^{y}}{(1+\\lambda)^{y+1}} & \\text{geometric distribution} \\end{array} \\right.\\] \\(\\lambda\\) Poisson parameter \\(\\alpha\\) dispersion parameter. Geometric distribution special case negative binomial distribution \\(\\alpha=1\\) included negative binomial distribution quite troublesome numerical regression fitting. important know PMF negative binomial distribution approaches PMF Poisson distribution \\(\\alpha\\rightarrow 0^{+}\\). Note literature single source capture recapture models dispersion parameter introduces greater variability negative binomial distribution compared Poisson distribution generally interpreted explaining unobserved heterogeneity .e. presence important unobserved independent variables. methods estimating population size tied Poisson processes hence use \\(\\lambda\\) parameter symbol instead \\(\\mu\\) emphasize connection. Also hard see estimators derived modifying \"base\" distribution unbiased assumptions made respective models violated. zero-truncated models corresponding \"base\" distributions characterized relation: \\[\\mathbb{P}(Y=y|Y>0)=\\left\\lbrace \\begin{array}{cc} \\frac{\\mathbb{P}(Y=y)}{1-\\mathbb{P}(Y=0)} & \\text{}y\\neq 0 \\cr 0 & \\text{}y=0 \\end{array}\\right.\\] allows us estimate parameter values using observed part population. models lead following estimates, respectively: \\[ \\begin{aligned} \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1}{1-\\exp(-\\lambda_{k})} & \\text{ Poisson distribution} \\cr \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1}{1-(1+\\alpha_{k}\\lambda_{k})^{-\\alpha_{k}^{-1}}} & \\text{ negative binomial distribution} \\cr \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1+\\lambda_{k}}{\\lambda_{k}} & \\text{ geometric distribution} \\end{aligned} \\] One common way assumptions zero-truncated models violated presence one-inflation presence somewhat similar single source capture-recapture models zero-inflation usual count data analysis. two ways one-inflation may understood, relate whether \\(\\mathbb{P}(Y=0)\\) modified inflation. first approach inflate (\\(\\omega\\) parameter) zero-truncated distribution : \\[ \\mathbb{P}_{new}(Y=y|Y>0) = \\left\\lbrace\\begin{array}{cc} \\omega + (1 - \\omega)\\mathbb{P}_{old}(Y=1|Y>0)& \\text{: } y = 1 \\cr (1 - \\omega) \\mathbb{P}_{old}(Y=y|Y>0) & \\text{: } y \\neq 1 \\end{array}\\right.\\] corresponds : \\[ \\mathbb{P}_{new}(Y=y) = \\left\\lbrace\\begin{array}{cc} \\mathbb{P}_{old}(Y=0) & \\text{: } y = 0 \\cr \\omega(1 - \\mathbb{P}(Y=0)) + (1 - \\omega)\\mathbb{P}_{old}(Y=1) & \\text{: } y = 1 \\cr (1 - \\omega) \\mathbb{P}_{old}(Y=y) & \\text{: } y > 1 \\end{array}\\right. \\] zero-truncation. Models utilize approach commonly referred one-inflated zero-truncated models (oizt*() family). Another way accommodating one-inflation SSCR putting inflation parameter base distribution : \\[ \\mathbb{P}_{new}(Y=y) = \\left\\lbrace\\begin{array}{cc} \\omega + (1 - \\omega)\\mathbb{P}_{old}(Y=1)& \\text{: } y = 1 \\cr (1 - \\omega) \\mathbb{P}_{old}(Y=y) & \\text{: } y \\neq 1 \\end{array}\\right. \\] becomes: \\[ \\mathbb{P}_{new}(Y=y|Y>0) = \\left\\lbrace\\begin{array}{cc} \\frac{\\omega}{1 - (1-\\omega)\\mathbb{P}_{old}(Y=0)} + \\frac{(1 - \\omega)}{1 - (1-\\omega)\\mathbb{P}_{old}(Y=0)}\\mathbb{P}_{old}(Y=1)& \\text{: } y = 1 \\cr \\frac{(1 - \\omega)}{1 - (1-\\omega)\\mathbb{P}_{old}(Y=0)}\\mathbb{P}_{old}(Y=y) & \\text{: } y > 1 \\end{array}\\right. \\] truncation commonly referred zero-truncated one-inflated models (ztoi*() family). shown BÃ¶hning 2022 paper approaches equivalent terms maximizing likelihoods put formula \\(\\omega\\). can however lead different population size estimates. one-inflated zero-truncated models formula population size estimate \\(\\hat{N}\\) change since \\(\\mathbb{P}(y=0)\\) remains estimation parameters changes calculations. zero-truncated one-inflated models population size estimates expressed, respectively : \\[ \\begin{aligned} \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1}{1-(1-\\omega_{k})\\exp(-\\lambda_{k})} &\\text{ base Poisson distribution} \\cr \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1}{1-(1-\\omega_{k})(1+\\alpha_{k}\\lambda_{k})^{-\\alpha_{k}^{-1}}} &\\text{ base negative binomial distribution} \\cr \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1+\\lambda_{k}}{\\lambda_{k} + \\omega_{k}} &\\text{ base geometric distribution} \\end{aligned} \\] Zero-one-truncated models ignore one counts instead accommodating one-inflation utilizing identity \\[ \\ell_{\\text{ztoi}}=\\boldsymbol{f}_{1}\\ln{\\frac{\\boldsymbol{f}_{1}}{N_{obs}}} +(N_{obs}-\\boldsymbol{f}_{1})\\ln{\\left(1-\\frac{\\boldsymbol{f}_{1}}{N_{obs}} \\right)} + \\ell_{\\text{zot}} \\] \\(\\ell_{\\text{zot}}\\) log likelihood zero-one-truncated distribution characterized probability mass function: \\[\\mathbb{P}(Y=y|Y>1)=\\left\\lbrace \\begin{array}{cc} \\frac{\\mathbb{P}(Y=y)}{1-\\mathbb{P}(Y=0)-\\mathbb{P}(Y=1)} & \\text{}y > 1 \\cr 0 & \\text{}y\\\\lbrace 0, 1\\rbrace \\end{array}\\right.\\] \\(\\mathbb{P}(Y)\\) probability mass function \"base\" distribution. identity justifies use zero-one-truncated, unfortunately proven intercept models, however numerical simulations seem indicate even theorem extended (non trivial) regression population size estimation still possible. zero-one-truncated models population size estimates expressed : \\[ \\begin{aligned} \\hat{N} &= \\boldsymbol{f}_{1} + \\sum_{k=1}^{N_{obs}} \\frac{1-\\lambda_{k}\\exp(-\\lambda_{k})}{1-\\exp(-\\lambda_{k})-\\lambda_{k}\\exp(-\\lambda_{k})} &\\text{ base Poisson distribution} \\cr \\hat{N} &= \\boldsymbol{f}_{1} + \\sum_{k=1}^{N_{obs}} \\frac{1-\\lambda_{k}(1+\\alpha_{k}\\lambda_{k})^{-1-\\alpha_{k}^{-1}}}{ 1-(1+\\alpha_{k}\\lambda_{k})^{-\\alpha_{k}^{-1}}-\\lambda_{k}(1+\\alpha_{k}\\lambda_{k})^{-1-\\alpha_{k}^{-1}}} &\\text{ base negative binomial distribution} \\cr \\hat{N} &= \\boldsymbol{f}_{1} + \\sum_{k=1}^{N_{obs}} \\frac{\\lambda_{k}^{2}+\\lambda_{k}+1}{\\lambda_{k}^{2}} &\\text{ base geometric distribution} \\end{aligned} \\] Pseudo hurdle models experimental yet described literature. Lastly chao zelterman models based logistic regression dummy variable \\[ Z = \\left\\lbrace\\begin{array}{cc} 0     & \\text{}Y = 1  \\cr 1     & \\text{}Y = 2 \\end{array}\\right.\\] based equation: \\[ \\text{logit}(p_{k})= \\ln\\left(\\frac{\\lambda_{k}}{2}\\right)= \\boldsymbol{\\beta}\\mathbf{x}_{k}=\\eta_{k}\\] \\(\\lambda_{k}\\) Poisson parameter. zelterman estimator population size expressed : \\[\\hat{N}=\\sum_{k=1}^{N_{obs}}{1-\\exp\\left(-\\lambda_{k}\\right)}\\] chao estimator form: \\[ \\hat{N}=N_{obs}+\\sum_{k=1}^{\\boldsymbol{f}_{1}+\\boldsymbol{f}_{2}} \\frac{1}{\\lambda_{k}+ \\frac{\\lambda_{k}^{2}}{2}} \\]","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Family functions in singleRcapture package â€” chao","text":"Piotr Chlebicki, Maciej BerÄ™sewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate size of sub-populations â€” stratifyPopsize","title":"Estimate size of sub-populations â€” stratifyPopsize","text":"function estimates sizes specific sub populations based capture-recapture model whole population.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate size of sub-populations â€” stratifyPopsize","text":"","code":"stratifyPopsize(object, strata, alpha, ...)  # S3 method for class 'singleRStaticCountData' stratifyPopsize(object, strata, alpha, cov = NULL, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate size of sub-populations â€” stratifyPopsize","text":"object object population size estimates based singleRcapture package fitter singleRStaticCountData class object. strata specification sub populations given one : formula â€“ formula applied model.frame extracted object. Logical vector number entries equal number rows dataset. (named) list element logical vector, names list used specify names variable returned object. Vector names explanatory variables. singleRStaticCountData method function specification strata parameter result every level explanatory variable sub population variable specified. value provided singleRStaticCountData method function create sub populations based levels factor variables model.frame. alpha significance level confidence intervals â€“ Either single numeric value vector length equal number sub populations specified strata. missing set .05 singleRStaticCountData method. ... vector arguments passed functions. singleRStaticCountData method functions arguments ... passed either cov argument provided function vcov cov argument missing call. cov singleRStaticCountData method estimate variance-covariance matrix estimate regression parameters. possible pass function example sandwich::vcovHC called : foo(object, ...) user may specify additional arguments function ... argument. provided estimate covariance matrix set calling appropriate vcov method.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate size of sub-populations â€” stratifyPopsize","text":"data.frame object row names names specified sub populations either provided inferred.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate size of sub-populations â€” stratifyPopsize","text":"MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}}; single source capture-recapture models frequently used estimate population size Horvitz-Thompson type estimate: \\[\\hat{N} = \\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)} = \\sum_{k=1}^{N_{obs}}\\frac{1}{1-\\mathbb{P}(Y_{k}=0)}\\] \\(I_{k}=I_{Y_{k} > 0}\\) indicator variables, value 1 kth unit observed least 0 otherwise inverse probabilistic weights weights units observed data \\(\\tfrac{1}{\\mathbb{P}(Y_{k}>0)}\\) estimated using fitted linear predictors. estimates different sub populations made changing \\(I_{k}=I_{Y_{k} > 0}\\) indicator variables refer population whole sub populations considered .e. changing values 1 0 kth unit member sub population considered moment. estimation variance estimates estimation variance estimate population size whole population follow relation one described .","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRStaticCountData.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary statistics for model of singleRStaticCountData class â€” summary.singleRStaticCountData","title":"Summary statistics for model of singleRStaticCountData class â€” summary.singleRStaticCountData","text":"summary method singleRStaticCountData class","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRStaticCountData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary statistics for model of singleRStaticCountData class â€” summary.singleRStaticCountData","text":"","code":"# S3 method for class 'singleRStaticCountData' summary(   object,   test = c(\"t\", \"z\"),   resType = \"pearson\",   correlation = FALSE,   confint = FALSE,   cov,   popSizeEst,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRStaticCountData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary statistics for model of singleRStaticCountData class â€” summary.singleRStaticCountData","text":"object object singleRStaticCountData class. test type test significance parameters \"t\" t-test \"z\" normal approximation students t distribution, default \"z\" used 30 degrees freedom \"t\" used cases. resType type residuals summarize value allowed residuals.singleRStaticCountData except \"\" allowed. default pearson residuals used. correlation logical value indicating whether correlation matrix computed covariance matrix default FALSE. confint logical value indicating whether confidence intervals regression parameters constructed. default FALSE. cov covariance matrix corresponding regression parameters. possible give cov argument function object. specified constructed using vcov.singleRStaticCountData method. (.e using Cramer-Rao lower bound) popSizeEst popSizeEstResults class object. specified population size estimation results drawn object. post-hoc procedures, sandwich covariance matrix estimation bias reduction, taken possible include population size estimation results calling redoPopEstimation. ... additional optional arguments passed following functions: vcov.singleRStaticCountData â€“ cov argument provided. cov â€“ cov parameter specified call function. confint.singleRStaticCountData â€“ confint parameter set TRUE function call. particular possible set confidence level ....","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRStaticCountData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary statistics for model of singleRStaticCountData class â€” summary.singleRStaticCountData","text":"object summarysingleRStaticCountData class containing: call â€“ call created object. coefficients â€“ dataframe estimated regression coefficients summary statistics standard error Wald test statistic p value Wald test. residuals â€“ vector residuals type specified call. aic â€“ Akaike's information criterion. bic â€“ Bayesian (Schwarz's) information criterion. iter â€“ Number iterations taken fitting regression. logL â€“ Logarithm likelihood function evaluated coefficients. deviance â€“ Residual deviance. populationSize â€“ Object population size estimation results. dfResidual â€“ Residual degrees freedom. sizeObserved â€“ Size observed population. correlation â€“ Correlation matrix correlation parameter set TRUE test â€“ Type statistical test performed. model â€“ Family class object specified call object. skew â€“ bootstrap sample saved contains estimate skewness.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRStaticCountData.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summary statistics for model of singleRStaticCountData class â€” summary.singleRStaticCountData","text":"MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}}; Works analogically summary.glm includes population size estimation results. additional statistics, confidence intervals coefficients coefficient correlation, specified printed.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":null,"dir":"Reference","previous_headings":"","what":"Statistical tests of goodness of fit â€” summary.singleRmargin","title":"Statistical tests of goodness of fit â€” summary.singleRmargin","text":"Performs two statistical test observed fitted marginal frequencies. G test test statistic computed : MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}};  \\[G = 2\\sum_{k}O_{k}\\ln{\\left(\\frac{O_{k}}{E_{k}}\\right)}\\] \\(\\chi^{2}\\) test statistic computed : \\[\\chi^{2} = \\sum_{k}\\frac{\\left(O_{k}-E_{k}\\right)^{2}}{E_{k}}\\] \\(O_{k},E_{k}\\) denoted observed fitted frequencies respectively. statistics converge \\(\\chi^2\\) distribution asymptotically degrees freedom. convergence \\(G, \\chi^2\\) statistics \\(\\chi^2\\) distribution may violated expected counts cells low, say < 5, customary either censor omit cells.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Statistical tests of goodness of fit â€” summary.singleRmargin","text":"","code":"# S3 method for class 'singleRmargin' summary(object, df, dropl5 = c(\"drop\", \"group\", \"no\"), ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Statistical tests of goodness of fit â€” summary.singleRmargin","text":"object object singleRmargin class. df degrees freedom provided function try manually always possible. dropl5 character indicating treatment cells frequencies < 5 either grouping , dropping leaving . Defaults drop. ... currently nothing.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Statistical tests of goodness of fit â€” summary.singleRmargin","text":"chi squared test G test comparison fitted observed marginal frequencies.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Statistical tests of goodness of fit â€” summary.singleRmargin","text":"","code":"# Create a simple model Model <- estimatePopsize(   formula = capture ~ .,    data = netherlandsimmigrant,    model = ztpoisson,    method = \"IRLS\" ) plot(Model, \"rootogram\")  # We see a considerable lack of fit summary(marginalFreq(Model), df = 1, dropl5 = \"group\") #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           50.06  1 1.5e-12 #> G-test                     34.31  1 4.7e-09 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been grouped  #> Names of cells used in calculating test(s) statistic: 1 2 3"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleRStaticCountData.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain covariance matrix estimation â€” vcov.singleRStaticCountData","title":"Obtain covariance matrix estimation â€” vcov.singleRStaticCountData","text":"vcov method singleRStaticCountData class.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleRStaticCountData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain covariance matrix estimation â€” vcov.singleRStaticCountData","text":"","code":"# S3 method for class 'singleRStaticCountData' vcov(object, type = c(\"Fisher\", \"observedInform\"), ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleRStaticCountData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain covariance matrix estimation â€” vcov.singleRStaticCountData","text":"object object singleRStaticCountData class. type type estimate covariance matrix now either expected (Fisher) information matrix observed information matrix. ... additional arguments method functions","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleRStaticCountData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain covariance matrix estimation â€” vcov.singleRStaticCountData","text":"covariance matrix fitted coefficients, rows columns correspond parameters returned coef method.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleRStaticCountData.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Obtain covariance matrix estimation â€” vcov.singleRStaticCountData","text":"MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}}; Returns estimated covariance matrix model coefficients calculated analytic hessian Fisher information matrix usually utilizing asymptotic effectiveness maximum likelihood estimates. Covariance type taken control parameter provided call created object arguments type specified.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleRStaticCountData.html","id":null,"dir":"Reference","previous_headings":"","what":"Heteroscedasticity-consistent covariance matrix estimation for singleRStaticCountData class â€” estfun.singleRStaticCountData","title":"Heteroscedasticity-consistent covariance matrix estimation for singleRStaticCountData class â€” estfun.singleRStaticCountData","text":"S3 method vcovHC handle singleRStaticCountData class objects. Works exactly like vcovHC.default difference method handles vector generalised linear models. Updating covariance matrix variance/standard error estimation population size estimator can done via redoPopEstimation()","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleRStaticCountData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Heteroscedasticity-consistent covariance matrix estimation for singleRStaticCountData class â€” estfun.singleRStaticCountData","text":"","code":"# S3 method for class 'singleRStaticCountData' estfun(x, ...)  # S3 method for class 'singleRStaticCountData' bread(x, ...)  # S3 method for class 'singleRStaticCountData' vcovHC(   x,   type = c(\"HC3\", \"const\", \"HC\", \"HC0\", \"HC1\", \"HC2\", \"HC4\", \"HC4m\", \"HC5\"),   omega = NULL,   sandwich = TRUE,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleRStaticCountData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Heteroscedasticity-consistent covariance matrix estimation for singleRStaticCountData class â€” estfun.singleRStaticCountData","text":"x fitted singleRStaticCountData class object. ... vcovHC additional optional arguments passed following functions: estfun â€“ empirical estimating functions. hatvalues â€“ diagonal elements projection matrix. sandwich â€“ sandwich argument function call set TRUE. vcov â€“ calling bread internally. type character string specifying estimation type, sandwich::vcovHC.default. HC3 default value. omega vector function depending arguments residuals (.e. derivative log-likelihood respect linear predictor), diaghat (diagonal corresponding hat matrix) df (residual degrees freedom), sandwich::vcovHC.default. sandwich logical. sandwich estimator computed? set FALSE meat matrix returned. sandwich::vcovHC()","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleRStaticCountData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Heteroscedasticity-consistent covariance matrix estimation for singleRStaticCountData class â€” estfun.singleRStaticCountData","text":"Variance-covariance matrix estimation corrected heteroscedasticity regression errors","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleRStaticCountData.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Heteroscedasticity-consistent covariance matrix estimation for singleRStaticCountData class â€” estfun.singleRStaticCountData","text":"Piotr Chlebicki, Maciej BerÄ™sewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleRStaticCountData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Heteroscedasticity-consistent covariance matrix estimation for singleRStaticCountData class â€” estfun.singleRStaticCountData","text":"","code":"set.seed(1) N <- 10000 gender <- rbinom(N, 1, 0.2) eta <- -1 + 0.5*gender counts <- rpois(N, lambda = exp(eta)) df <- data.frame(gender, eta, counts) df2 <- subset(df, counts > 0) mod1 <-  estimatePopsize(   formula = counts ~ 1 + gender,    data = df2,    model = \"ztpoisson\",    method = \"optim\",    popVar = \"analytic\" ) require(sandwich) HC <- sandwich::vcovHC(mod1, type = \"HC4\") Fisher <- vcov(mod1, \"Fisher\") # variance covariance matrix obtained from  #Fisher (expected) information matrix HC #>             (Intercept)       gender #> (Intercept)  0.00201216 -0.002012160 #> gender      -0.00201216  0.004790297 Fisher #>              (Intercept)       gender #> (Intercept)  0.002022145 -0.002022145 #> gender      -0.002022145  0.004881858 # usual results summary(mod1) #>  #> Call: #> estimatePopsize.default(formula = counts ~ 1 + gender, data = df2,  #>     model = \"ztpoisson\", method = \"optim\", popVar = \"analytic\") #>  #> Pearson Residuals: #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #> -0.5503 -0.4267 -0.4267  0.0000 -0.4267  6.2261  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>             Estimate Std. Error z value  P(>|z|)     #> (Intercept) -1.01346    0.04497 -22.537  < 2e-16 *** #> gender       0.50288    0.06987   7.197 6.14e-13 *** #> --- #> Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 #>  #> AIC: 3990.538 #> BIC: 4002.804 #> Residual deviance: 2386.29 #>  #> Log-likelihood: -1993.269 on 3403 Degrees of freedom  #> Number of calls to log-likelihood function: 35 #> ----------------------- #> Population size estimation results:  #> Point estimate 10146.02 #> Observed proportion: 33.6% (N obs = 3405) #> Std. Error 341.7287 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      9476.239   10815.79 #> logNormal   9508.827   10849.72 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      31.48175   35.93198 #> logNormal   31.38330   35.80883 # updated results summary(mod1, cov = HC, popSizeEst = redoPopEstimation(mod1, cov = HC)) #>  #> Call: #> estimatePopsize.default(formula = counts ~ 1 + gender, data = df2,  #>     model = \"ztpoisson\", method = \"optim\", popVar = \"analytic\") #>  #> Pearson Residuals: #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #> -0.5503 -0.4267 -0.4267  0.0000 -0.4267  6.2261  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>             Estimate Std. Error z value  P(>|z|)     #> (Intercept) -1.01346    0.04486 -22.593  < 2e-16 *** #> gender       0.50288    0.06921   7.266 3.71e-13 *** #> --- #> Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1 #>  #> AIC: 3990.538 #> BIC: 4002.804 #> Residual deviance: 2386.29 #>  #> Log-likelihood: -1993.269 on 3403 Degrees of freedom  #> Number of calls to log-likelihood function: 35 #> ----------------------- #> Population size estimation results:  #> Point estimate 10146.02 #> Observed proportion: 33.6% (N obs = 3405) #> Std. Error 340.7902 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      9478.078   10813.95 #> logNormal   9510.489   10847.69 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      31.48710   35.92500 #> logNormal   31.38916   35.80257 # estimating equations mod1_sims <- sandwich::estfun(mod1) head(mod1_sims) #>   (Intercept)    gender #> 1  -0.1924342 0.0000000 #> 2   0.6700925 0.6700925 #> 3  -0.1924342 0.0000000 #> 4  -0.1924342 0.0000000 #> 5  -0.1924342 0.0000000 #> 6  -0.1924342 0.0000000 # bread method all(vcov(mod1, \"Fisher\") * nrow(df2) == sandwich::bread(mod1, type = \"Fisher\")) #> [1] TRUE"},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-100","dir":"Changelog","previous_headings":"","what":"singleRcapture 1.0.0","title":"singleRcapture 1.0.0","text":"Fixed mixed ztoi* oizt* families Fixed documentation estimatePopsize() Fixed vignette Fixed README.Rmd Logo added [thanks Oliwia Awuku ] CITATION file added reference JSS paper","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-023","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.2.3","title":"singleRcapture 0.2.3","text":"CRAN release: 2025-02-13 BugFix anova working methods Tests working methods added Small changes documentation","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-022","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.2.2","title":"singleRcapture 0.2.2","text":"CRAN release: 2025-02-04 Fixing documentation typos errors plot now default value qq Vignette added based paper submitted JSS","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-0212","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.2.1.2","title":"singleRcapture 0.2.1.2","text":"CRAN release: 2024-07-18 Bugfix interaction terms formula considered Small changes summary marginal count distributions Small fixes standard errors predicted means Code coverage raised nearly 90% logLik.singleRStaticCountData method now type argument , set \"function\" makes function return minus log-likelihood function (default) deriv argument set 1 2 respectively either gradient hessian log-likelihood function.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-0211","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.2.1.1","title":"singleRcapture 0.2.1.1","text":"CRAN release: 2023-10-23 Bugfix tests failing noLongDouble","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-021","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.2.1","title":"singleRcapture 0.2.1","text":"CRAN release: 2023-10-14 Fixed bugs IRLS fitting providing weights argument calling estimatePopsize weightsAsCounts option controlModel now works properly, dfbeta dfpopsize decrease weight selected row model matrix instead deleting set TRUE simulate method now works family object (like ztpoisson()) objects returned estimatePopsize Introduced singleRStaticCountData sub class singleRclass made estimatePopsize method new package singleRcaptureExtra (development) can make necessary calculations pop size estimation providing object fitted countreg::zerotrunc VGAM::vglm/VGAM::vgam bugfixes multicore bootstrap Code re-factored make development/maintenance package much easier Update uploaded CRAN semiparametric bootstrap now much faster sampling algorithm (job) Unit tests: * Reduced computational burden unit tests * Multicore tests performed TEST_SINGLERCAPTURE_MULTICORE_DEVELOPER set \"true\" via Sys.setenv _R_CHECK_LIMIT_CORES_ false","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-0201","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.2.0.1","title":"singleRcapture 0.2.0.1","text":"Added offset argument estimatePopsize Added options parallel computing bootstrap dfbeta Added deviance negative binomial based models. (NOTE: slow now believe may change verify one theoretical results lead significant speed increase computations) Overhaul starting points (new methods added linear predictors start IRLS) Code weights IRLS fitting speed Minor bugfixes","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-020","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.2.0","title":"singleRcapture 0.2.0","text":"CRAN release: 2023-06-11","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"the-package-is-now-at-cran-0-2-0","dir":"Changelog","previous_headings":"","what":"The package is now at CRAN","title":"singleRcapture 0.2.0","text":"Added final Hurdleztnegbin model Vastly improved redoPopSize now handles bootstrap fitted model non standard covariance matrixes newdata argument user supplied coef etc. Added predict.singleR method offers standard error link, response well mean predictions unexpected warnings occur now main function using package correctly control arguments now verified passed Fitting now reliable Added information stats::optim error codes Added warnings functions computing deviance fixed bugs occurring using mathematical functions part formulas .e.Â setting formula something like: y ~ log(x) + (x ^ t) + (t ^ 2)","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-014","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.4","title":"singleRcapture 0.1.4","text":"Added ztoinegbin, oiztnegbin ztHurdlenegbin models Added optional arguments family-functions specify link function distribution parameters Updated standardized documentation Added warnings Added methods singleR class commonly used glm functions, particular texreg::screenreg work well now Changed default arguments Added option save logs IRLS fitting Fixed issues intercept models Fixed slight miscalculations information matrixes one inflated models making fitting much reliable better Rcmd tests","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-0132--ntts","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.3.2 â€“ NTTS","title":"singleRcapture 0.1.3.2 â€“ NTTS","text":"Added function implements population size estimates stratas warnings fitting options control functions Corrected/implemented deviance residuals models Now whole package uses cammelCase Performance upgrades Corrected miss calculated moments Change exported data factors actually factors just characters Removed unused dependency Added automated R-cmd check","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-0131","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.3.1","title":"singleRcapture 0.1.3.1","text":"Basically documentation redone now features important theory SSCR methods information (v)glms Added checks positivity working weights matrixes stabilise \"IRLS\" algorithm S3 method vcovHC implemented vcovCL work singleR class objects work \"HC0\" \"HC1\" type argument values Basic version function redoPopEstimation updating population size estimation post-hoc procedures implemented popSizeEst function extracting population size estimation results implemented Minor improvements memory usage made computation speed little Changed names mle robust fitting methods optim IRLS respectively bugfixes warnings messages estimate_popsize.fit","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-013","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.3","title":"singleRcapture 0.1.3","text":"Multiple new models IRLS generalised distributions multiple parameters bugfixes QOL improvements extended bootstrap methods new models","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-012","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.2","title":"singleRcapture 0.1.2","text":"control parameters model control parameters regression bootstrap sampling leave one diagnostics popsize regression parameters (dfbetas corrected) fixes Goodness fit tests zero one truncated models computational improvements IRLS small bugfixes","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-011","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.1","title":"singleRcapture 0.1.1","text":"tiny tests fixes marginal frequencies Deviance implemented dfbetas levarage matrix Parametric bootstraps work correctly part just polishing left ","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-010","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.0","title":"singleRcapture 0.1.0","text":"first version package released","code":""}]
