[{"path":"https://ncn-foreigners.github.io/singleRcapture/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 singleRcapture authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Piotr Chlebicki. Author, maintainer. Maciej Beręsewicz. Author, contributor.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Chlebicki P, Beręsewicz M (2023). singleRcapture: package single-source capture-recapture models. R package version 0.1.3.2.1, https://github.com/ncn-foreigners/singleRcapture.","code":"@Manual{,   title = {singleRcapture: A package for single-source capture-recapture models},   author = {Piotr Chlebicki and Maciej Beręsewicz},   year = {2023},   note = {R package version 0.1.3.2.1},   url = {https://github.com/ncn-foreigners/singleRcapture}, }"},{"path":"https://ncn-foreigners.github.io/singleRcapture/index.html","id":"overview","dir":"","previous_headings":"","what":"A package for single-source capture-recapture models","title":"A package for single-source capture-recapture models","text":"Capture-recapture type experiments used estimate total population size situations observing part population feasible. recent years types experiments seen interest. Single source models distinct capture-recapture models estimate population size based many units observed two three sources standard approach. Instead single source models utilise count data regression models positive distributions (.e. counts greater 0) dependent variable number times particular unit observed source data. package aims implement already existing introduce new methods estimating population size single source simplify research process. Currently ’ve implemented frequentist approaches used literature : Zero truncated poisson, geometric negative binomial regression. Zero truncated one inflated one inflated zero truncated poisson gemetric models. (Negative binomial currently development.) Zero one truncated poisson geometric negative binomial models. Generalised Chao Zelterman’s models based logistic regression. Three types bootstrap parametric, semi-parametric non parametric. wide range additional functionalities associated (vector) generalised linear models relevant topic.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"A package for single-source capture-recapture models","text":"can install development version singleRcapture GitHub :","code":"# install.packages(\"devtools\") remotes::install_github(\"ncn-foreigners/singleRcapture\")"},{"path":"https://ncn-foreigners.github.io/singleRcapture/index.html","id":"examples","dir":"","previous_headings":"Installation","what":"Examples","title":"A package for single-source capture-recapture models","text":"main function package estimatePopsize fitts regression specified distribution uses fitted regression estimate population size. Lets look model 2003 publication : Point interval estimation population size using truncated Poisson regression model Heijden, Peter GM van der et al. call estimatePopsize look simmilar anyone used stats::glm function: implemented method plot function visualise model fit usefull diagnostic information. One rootogram, type plot compares fitted observed marginal frequencies:  possible values plotType argument : qq - normal quantile-quantile plot pearson residuals. marginal - matplot comparing fitted observed marginal frequencies. fitresid - plot linear predictor values contrasted pearson residuals. bootHist - histogram bootstrap sample. rootogram - rootogram, example presented . dfpopContr - contrasting two deletion effects identify presence influential observations. dfpopBox - boxplot results dfpopsize function see documentation. scaleLoc - scale-location plot. cooks - plot cooks.values distributions defined. hatplot - plot hatvalues. strata - plot confidence intervals selected su populations. user can also pass arguments specify additional information plot title, subtitle etc. similar calling plot data. info check plot.singleR method documentation. seen significant differences fitted observed marginal frequencies. check intuition let’s perform goodness fit test fitted observed marginal frequencies. call summary function marginalFreq function computes marginal frequencies fitted singleR class object: Finally let us check influential observations. comparing deletion effect every observation population size estimate removing entirely model (population size estimate regression) omitting pop size estimation (called contribution observation). observation influential two actions approximately effect:  easy deduce plot influential observations dataset (one particular). Lastly singleRcapture offers posthoc procedures example function stratifyPopsize estimates sizes user specified sub populations returns data.frame: stratas argument may specified various ways example: singleRcapture package also includes option estimate standard error population size estimate bootstrap common non standard argument significance levels different usual 5%:  models one distribution parameter allow parameters covariate dependent exapmle wish modify model : results significantly different (warning issued concerns second derivative test existence local minimum, inconclusive manually checked fitting process found optimal regression coefficients ’s provide information user):  information criteria support second model:","code":"library(singleRcapture) model <- estimatePopsize(   formula = capture ~ gender + age + nation + reason, # specify formula   data = netherlandsimmigrant,   popVar = \"analytic\", # specify    model = \"ztpoisson\", # distribution used   method = \"IRLS\" # fitting method one of three currently supported ) summary(model) # a summary method for singleR class with standard glm-like output and population size estimation resutls #>  #> Call: #> estimatePopsize(formula = capture ~ gender + age + nation + reason,  #>     data = netherlandsimmigrant, model = \"ztpoisson\", method = \"IRLS\",  #>     popVar = \"analytic\") #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.488779 -0.486085 -0.297859  0.002075 -0.210439 13.921578  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)          -1.33179    0.25486  -5.226 1.74e-07 *** #> gendermale            0.39741    0.16305   2.437 0.014796 *   #> age>40yrs            -0.97463    0.40824  -2.387 0.016969 *   #> nationAsia           -1.09241    0.30164  -3.622 0.000293 *** #> nationNorth Africa    0.18997    0.19400   0.979 0.327471     #> nationRest of Africa -0.91129    0.30097  -3.028 0.002463 **  #> nationSurinam        -2.33665    1.01357  -2.305 0.021146 *   #> nationTurkey         -1.67453    0.60291  -2.777 0.005479 **  #> reasonOther reason   -0.01093    0.16153  -0.068 0.946048     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> AIC: 1714.896 #> BIC: 1764.747 #> Residual deviance: 1128.549 #>  #> Log-likelihood: -848.4481 on 1871 Degrees of freedom  #> Number of iterations: 8 #> ----------------------- #> Population size estimation results:  #> Point estimate 12691.45 #> Observed proportion: 14.8% (N obs = 1880) #> Std. Error 2809.508 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      7184.917   18197.99 #> logNormal   8430.749   19723.38 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal     10.330814   26.16592 #> logNormal   9.531836   22.29932 plot(model, plotType = \"rootogram\") summary(marginalFreq(model), df = 2, dropl5 = \"group\") #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           50.06  2 1.4e-11 #> G-test                     34.31  2 3.6e-08 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been grouped  #> Names of cells used in calculating test(s) statistic: 1 2 3 plot(model, plotType = \"dfpopContr\") stratifyPopsize(model, alpha = c(.01, .02, .03, .05), # different significance level for each sub population     stratas = list(     \"Females from Surinam\" = netherlandsimmigrant$gender == \"female\" & netherlandsimmigrant$nation == \"Surinam\",     \"Males from Turkey\" = netherlandsimmigrant$gender == \"male\" & netherlandsimmigrant$nation == \"Turkey\",     \"Younger males\" = netherlandsimmigrant$gender == \"male\" & netherlandsimmigrant$age == \"<40yrs\",     \"Older males\" = netherlandsimmigrant$gender == \"male\" & netherlandsimmigrant$age == \">40yrs\" )) #>   Observed Estimated ObservedPercentage  StdError normalLowerBound #> 1       20   932.371           2.145069  956.1229     -1530.438420 #> 2       78  1291.514           6.039425  741.1843      -432.738939 #> 3     1391  7337.175          18.958251 1281.9295      4555.271881 #> 4       91  1542.882           5.898055  782.2326         9.733753 #>   normalUpperBound logNormalLowerBound logNormalUpperBound                 name #> 1         3395.180            119.3464            8398.972 Females from Surinam #> 2         3015.766            405.4748            4574.882    Males from Turkey #> 3        10119.078           5135.1856           10834.174        Younger males #> 4         3076.029            630.7808            3996.215          Older males #>   confLevel #> 1      0.01 #> 2      0.02 #> 3      0.03 #> 4      0.05 stratifyPopsize(model, stratas = ~ gender / age) #>   Observed Estimated ObservedPercentage  StdError normalLowerBound #> 1      398 3811.3954          10.442370 1154.7825      1548.063241 #> 2     1482 8880.0563          16.689083 1812.6286      5327.369600 #> 3      378 3169.5475          11.925992  881.2932      1442.244687 #> 4     1391 7337.1748          18.958251 1281.9295      4824.639108 #> 5       20  641.8478           3.116003  408.1451      -158.101825 #> 6       91 1542.8815           5.898055  782.2326         9.733753 #>   normalUpperBound logNormalLowerBound logNormalUpperBound #> 1         6074.727           2188.5341            6905.147 #> 2        12432.743           6090.8584           13357.226 #> 3         4896.850           1903.7278            5485.554 #> 4         9849.710           5306.6899           10420.570 #> 5         1441.797            212.4088            2029.756 #> 6         3076.029            630.7808            3996.215 #>                     name confLevel #> 1         gender==female      0.05 #> 2           gender==male      0.05 #> 3 genderfemale:age<40yrs      0.05 #> 4   gendermale:age<40yrs      0.05 #> 5 genderfemale:age>40yrs      0.05 #> 6   gendermale:age>40yrs      0.05 set.seed(123) modelInflated <- estimatePopsize(     formula = capture ~ nation + gender + age,     data = netherlandsimmigrant,     popVar = \"bootstrap\",     model = \"oiztgeom\",     method = \"IRLS\",     controlMethod = controlMethod(stepsize = .2), # control parameters for regression fitting check documentation of controlMethod     controlPopVar = controlPopVar( # control parameters for population size estimation check documentation of controlPopVar         B = 1250, # number of boostrap samples         alpha = .01, # significance level          bootType = \"semiparametric\" # type of bootstrap see documentation for estimatePopsize     ) ) summary(modelInflated) #>  #> Call: #> estimatePopsize(formula = capture ~ nation + gender + age, data = netherlandsimmigrant,  #>     model = \"oiztgeom\", method = \"IRLS\", popVar = \"bootstrap\",  #>     controlMethod = controlMethod(stepsize = 0.2), controlPopVar = controlPopVar(B = 1250,  #>         alpha = 0.01, bootType = \"semiparametric\")) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.416300 -0.416300 -0.292541  0.004086 -0.188313 13.733512  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.5518     0.2395  -6.480 9.19e-11 *** #> nationAsia            -0.8294     0.2573  -3.224  0.00126 **  #> nationNorth Africa     0.2082     0.1854   1.123  0.26147     #> nationRest of Africa  -0.6800     0.2578  -2.638  0.00834 **  #> nationSurinam         -1.5370     0.6403  -2.401  0.01637 *   #> nationTurkey          -1.1880     0.4336  -2.740  0.00614 **  #> gendermale             0.3145     0.1466   2.145  0.03194 *   #> age>40yrs             -0.6692     0.3116  -2.148  0.03171 *   #> ----------------------- #> For linear predictors associated with: omega  #>             Estimate Std. Error z value  P(>|z|)     #> (Intercept)  -2.2241     0.4556  -4.882 1.05e-06 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> AIC: 1676.961 #> BIC: 1726.813 #> Residual deviance: 941.3779 #>  #> Log-likelihood: -829.4807 on 3751 Degrees of freedom  #> Number of iterations: 52 #> ----------------------- #> Population size estimation results:  #> Point estimate 7559.606 #> Observed proportion: 24.9% (N obs = 1880) #> Boostrap sample skewness: 0.3109832 #> 0 skewness is expected for normally distributed vairable #> --- #> Bootstrap Std. Error 3194.534 #> 99% CI for the population size: #> lowerBound upperBound  #>   4517.296  18967.029  #> 99% CI for the share of observed population: #> lowerBound upperBound  #>   9.911937  41.617818 plot(modelInflated, plotType = \"bootHist\", labels = TRUE, ylim = c(0, 300)) modelInflated2 <- estimatePopsize(     formula = capture ~ nation  + age,     data = netherlandsimmigrant,     popVar = \"bootstrap\",     model = \"oiztgeom\",     method = \"IRLS\",     controlMethod = controlMethod(stepsize = .2),     controlPopVar = controlPopVar(         B = 1250,         alpha = .01,         bootType = \"semiparametric\",         covType = \"Fisher\" # use fisher information matrix to construct cross covariance matrix instead of observed information matrix     ),     controlModel = controlModel(omegaFormula = ~ gender) # put covariates on omega i.e. the inflation parameter ) #> Warning in estimatePopsize(formula = capture ~ nation + age, data = netherlandsimmigrant, : The (analytically computed) hessian of the score function is not negative define. #> NOTE: Second derivative test failing does not necessarily mean that the maximum of score function that was found numericaly is invalid since R^k is not a bounded space. #> Additionally in one inflated and hurdle models second derivative test often fails even on valid arguments. plot(modelInflated2, plotType = \"bootHist\", labels = TRUE, ylim = c(0, 220)) cat(\" First model: AIC = \", AIC(modelInflated), \" BIC = \", BIC(modelInflated),     \"\\nSecond model: AIC = \", AIC(modelInflated2), \" BIC = \", BIC(modelInflated2), \"\\n\", sep = \"\") #>  First model: AIC = 1676.961 BIC = 1726.813 #> Second model: AIC = 1675.318 BIC = 1725.169"},{"path":"https://ncn-foreigners.github.io/singleRcapture/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"A package for single-source capture-recapture models","text":"Work package supported National Science Center, OPUS 22 grant . 2020/39/B/HS4/00941.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/bread.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Extracting bread matrix for singleR class — bread.singleR","title":"Extracting bread matrix for singleR class — bread.singleR","text":"Extracting bread matrix singleR class","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/bread.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extracting bread matrix for singleR class — bread.singleR","text":"","code":"# S3 method for singleR bread(object, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/bread.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extracting bread matrix for singleR class — bread.singleR","text":"object object representing fitted model. ... additional optional arguments passed following functions: stats::vcov -- extracting \"usual\" variance-covariance matrix, vcov.singleR one additional argument type values \"Fisher\" \"observedInform\", defaults one specified controlPopVar specified call object.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/bread.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extracting bread matrix for singleR class — bread.singleR","text":"bread matrix, .e. hessian based estimation variance-covariance matrix scaled degrees freedom.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/bread.singleR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Extracting bread matrix for singleR class — bread.singleR","text":"Piotr Chlebicki, Maciej Beręsewicz S3class sandwich::bread handle singleR objects. function developed based sandwich:::bread.glm","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/bread.singleR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extracting bread matrix for singleR class — bread.singleR","text":"","code":"Model <- estimatePopsize(   formula = capture ~ .,    data = netherlandsimmigrant,    model = ztpoisson,    method = \"IRLS\" ) sandwich::bread(Model) #>                      (Intercept) gendermale   age>40yrs reasonOther reason #> (Intercept)            122.10868 -34.311532 -10.9034770        -41.6072585 #> gendermale             -34.31153  49.979685  -2.5603625         -1.0221200 #> age>40yrs              -10.90348  -2.560362 313.3232550          0.1153169 #> reasonOther reason     -41.60726  -1.022120   0.1153169         49.0525800 #> nationAsia             -56.25448  -6.805030   6.9235321         -0.8766691 #> nationNorth Africa     -55.61099  -9.030616   8.2485110          0.1373466 #> nationRest of Africa   -60.88260  -4.806497   4.5385472          2.9626704 #> nationSurinam          -60.40757  -2.801890  -3.5269990          1.1476629 #> nationTurkey           -51.41920  -9.448466  -2.1998382         -3.8913678 #>                       nationAsia nationNorth Africa nationRest of Africa #> (Intercept)          -56.2544755        -55.6109935           -60.882602 #> gendermale            -6.8050296         -9.0306164            -4.806497 #> age>40yrs              6.9235321          8.2485110             4.538547 #> reasonOther reason    -0.8766691          0.1373466             2.962670 #> nationAsia           171.0514100         62.9320747            62.223177 #> nationNorth Africa    62.9320747         70.7547976            62.510353 #> nationRest of Africa  62.2231766         62.5103529           170.291804 #> nationSurinam         61.8198398         61.9519618            61.820909 #> nationTurkey          62.8528821         63.1825931            62.171390 #>                      nationSurinam nationTurkey #> (Intercept)             -60.407570   -51.419195 #> gendermale               -2.801890    -9.448466 #> age>40yrs                -3.526999    -2.199838 #> reasonOther reason        1.147663    -3.891368 #> nationAsia               61.819840    62.852882 #> nationNorth Africa       61.951962    63.182593 #> nationRest of Africa     61.820909    62.171390 #> nationSurinam          1931.372466    62.008295 #> nationTurkey             62.008295   683.378471 vcov(Model) #>                       (Intercept)    gendermale     age>40yrs #> (Intercept)           0.064951423 -0.0182508147 -5.799722e-03 #> gendermale           -0.018250815  0.0265849388 -1.361895e-03 #> age>40yrs            -0.005799722 -0.0013618949  1.666613e-01 #> reasonOther reason   -0.022131520 -0.0005436809  6.133879e-05 #> nationAsia           -0.029922593 -0.0036196966  3.682730e-03 #> nationNorth Africa   -0.029580316 -0.0048035194  4.387506e-03 #> nationRest of Africa -0.032384363 -0.0025566472  2.414121e-03 #> nationSurinam        -0.032131686 -0.0014903669 -1.876063e-03 #> nationTurkey         -0.027350636 -0.0050257797 -1.170127e-03 #>                      reasonOther reason    nationAsia nationNorth Africa #> (Intercept)               -2.213152e-02 -0.0299225934      -2.958032e-02 #> gendermale                -5.436809e-04 -0.0036196966      -4.803519e-03 #> age>40yrs                  6.133879e-05  0.0036827298       4.387506e-03 #> reasonOther reason         2.609180e-02 -0.0004663133       7.305668e-05 #> nationAsia                -4.663133e-04  0.0909847926       3.347451e-02 #> nationNorth Africa         7.305668e-05  0.0334745078       3.763553e-02 #> nationRest of Africa       1.575889e-03  0.0330974344       3.325019e-02 #> nationSurinam              6.104590e-04  0.0328828935       3.295317e-02 #> nationTurkey              -2.069876e-03  0.0334323841       3.360776e-02 #>                      nationRest of Africa nationSurinam nationTurkey #> (Intercept)                  -0.032384363  -0.032131686 -0.027350636 #> gendermale                   -0.002556647  -0.001490367 -0.005025780 #> age>40yrs                     0.002414121  -0.001876063 -0.001170127 #> reasonOther reason            0.001575889   0.000610459 -0.002069876 #> nationAsia                    0.033097434   0.032882893  0.033432384 #> nationNorth Africa            0.033250188   0.032953171  0.033607762 #> nationRest of Africa          0.090580747   0.032883462  0.033069888 #> nationSurinam                 0.032883462   1.027325780  0.032983136 #> nationTurkey                  0.033069888   0.032983136  0.363499187 # This function just scales. all(vcov(Model) * nrow(netherlandsimmigrant) == sandwich::bread(Model)) #> [1] TRUE # We can choose Fisher information matrix instead of default observed information matrix. vcov(Model, \"Fisher\") #>                       (Intercept)    gendermale     age>40yrs #> (Intercept)           0.064951423 -0.0182508146 -5.799722e-03 #> gendermale           -0.018250815  0.0265849387 -1.361895e-03 #> age>40yrs            -0.005799722 -0.0013618949  1.666613e-01 #> reasonOther reason   -0.022131520 -0.0005436809  6.133875e-05 #> nationAsia           -0.029922593 -0.0036196966  3.682730e-03 #> nationNorth Africa   -0.029580316 -0.0048035193  4.387506e-03 #> nationRest of Africa -0.032384363 -0.0025566472  2.414121e-03 #> nationSurinam        -0.032131686 -0.0014903669 -1.876063e-03 #> nationTurkey         -0.027350636 -0.0050257797 -1.170127e-03 #>                      reasonOther reason    nationAsia nationNorth Africa #> (Intercept)               -2.213152e-02 -0.0299225934      -2.958032e-02 #> gendermale                -5.436809e-04 -0.0036196966      -4.803519e-03 #> age>40yrs                  6.133875e-05  0.0036827298       4.387506e-03 #> reasonOther reason         2.609180e-02 -0.0004663133       7.305668e-05 #> nationAsia                -4.663133e-04  0.0909847926       3.347451e-02 #> nationNorth Africa         7.305668e-05  0.0334745078       3.763553e-02 #> nationRest of Africa       1.575889e-03  0.0330974344       3.325019e-02 #> nationSurinam              6.104590e-04  0.0328828935       3.295317e-02 #> nationTurkey              -2.069876e-03  0.0334323841       3.360776e-02 #>                      nationRest of Africa nationSurinam nationTurkey #> (Intercept)                  -0.032384363  -0.032131686 -0.027350636 #> gendermale                   -0.002556647  -0.001490367 -0.005025780 #> age>40yrs                     0.002414121  -0.001876063 -0.001170127 #> reasonOther reason            0.001575889   0.000610459 -0.002069876 #> nationAsia                    0.033097434   0.032882893  0.033432384 #> nationNorth Africa            0.033250188   0.032953171  0.033607762 #> nationRest of Africa          0.090580747   0.032883462  0.033069888 #> nationSurinam                 0.032883462   1.027324675  0.032983136 #> nationTurkey                  0.033069888   0.032983136  0.363499187 sandwich::bread(Model, type = \"Fisher\") #>                      (Intercept) gendermale   age>40yrs reasonOther reason #> (Intercept)            122.10868 -34.311531 -10.9034769        -41.6072583 #> gendermale             -34.31153  49.979685  -2.5603625         -1.0221200 #> age>40yrs              -10.90348  -2.560362 313.3232522          0.1153168 #> reasonOther reason     -41.60726  -1.022120   0.1153168         49.0525798 #> nationAsia             -56.25448  -6.805030   6.9235321         -0.8766691 #> nationNorth Africa     -55.61099  -9.030616   8.2485110          0.1373466 #> nationRest of Africa   -60.88260  -4.806497   4.5385472          2.9626704 #> nationSurinam          -60.40757  -2.801890  -3.5269989          1.1476629 #> nationTurkey           -51.41920  -9.448466  -2.1998381         -3.8913678 #>                       nationAsia nationNorth Africa nationRest of Africa #> (Intercept)          -56.2544756        -55.6109936           -60.882602 #> gendermale            -6.8050296         -9.0306164            -4.806497 #> age>40yrs              6.9235321          8.2485110             4.538547 #> reasonOther reason    -0.8766691          0.1373466             2.962670 #> nationAsia           171.0514100         62.9320747            62.223177 #> nationNorth Africa    62.9320747         70.7547976            62.510353 #> nationRest of Africa  62.2231766         62.5103529           170.291804 #> nationSurinam         61.8198398         61.9519618            61.820909 #> nationTurkey          62.8528821         63.1825931            62.171390 #>                      nationSurinam nationTurkey #> (Intercept)             -60.407570   -51.419195 #> gendermale               -2.801890    -9.448466 #> age>40yrs                -3.526999    -2.199838 #> reasonOther reason        1.147663    -3.891368 #> nationAsia               61.819840    62.852882 #> nationNorth Africa       61.951962    63.182593 #> nationRest of Africa     61.820909    62.171390 #> nationSurinam          1931.370389    62.008295 #> nationTurkey             62.008295   683.378471 all(vcov(Model, \"Fisher\") * nrow(netherlandsimmigrant) == sandwich::bread(Model, type = \"Fisher\")) #> [1] TRUE"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/carcassubmission.html","id":null,"dir":"Reference","previous_headings":"","what":"British farm carcass submissions data — carcassubmission","title":"British farm carcass submissions data — carcassubmission","text":"Data British animal farms submissions AHVLA. British farms able submit samples AHVLA cause death animal determined private veterinary surgeon decides submit , unless notifiable disease suspected submission required. data set contains information farms. submissions included data frame submissions carcasses .e. submissions blood samples etc. excluded.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/carcassubmission.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"British farm carcass submissions data — carcassubmission","text":"","code":"data(\"carcassubmission\")"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/carcassubmission.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"British farm carcass submissions data — carcassubmission","text":"Data frame 1,858 rows 4 columns. TOTAL_SUB Number submissions animal carcasses. log_size Numerical value equal logarithm size farm. log_distance Numerical value equal logarith distance nearest AHVLA center. C_TYPE Factor describing type activity farm animals used . Either Dairy Beef","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/carcassubmission.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"British farm carcass submissions data — carcassubmission","text":"data set description provided publication: Böhning, D., Vidal Diez, ., Lerdsuwansri, R., Viwatwongkasem, C., Arnold, M. (2013). \"generalization Chao's estimator covariate information\". Biometrics, 69(4), 1033-1042. doi:10.1111/biom.12082","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/confint.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence Intervals for Model Parameters — confint.singleR","title":"Confidence Intervals for Model Parameters — confint.singleR","text":"function computes studentized confidence intervals model coefficients.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/confint.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence Intervals for Model Parameters — confint.singleR","text":"","code":"# S3 method for singleR confint(object, parm, level = 0.95, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/confint.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence Intervals for Model Parameters — confint.singleR","text":"object Object singleR class. parm Names parameters confidence intervals computed, missing parameters considered. level Confidence level intervals. ... Currently nothing.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/confint.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence Intervals for Model Parameters — confint.singleR","text":"object named columns include upper lower limit confidence intervals.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":null,"dir":"Reference","previous_headings":"","what":"Control parameters for regression — controlMethod","title":"Control parameters for regression — controlMethod","text":"controlMethod constructs list necessary control parameters regression fitting estimatePopsize.fit estimatePopsize.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control parameters for regression — controlMethod","text":"","code":"controlMethod(   epsilon = 1e-08,   maxiter = 1000,   verbose = 0,   printEveryN = 1,   start = NULL,   alphaStart = NULL,   omegaStart = NULL,   piStart = NULL,   optimMethod = \"L-BFGS-B\",   silent = FALSE,   optimPass = FALSE,   stepsize = 1,   checkDiagWeights = TRUE,   weightsEpsilon = .Machine$double.eps^0.75,   momentumFactor = 0,   saveIRLSlogs = FALSE,   useZtpoissonAsStart = FALSE,   momentumActivation = 5,   criterion = c(\"coef\", \"abstol\", \"reltol\") )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control parameters for regression — controlMethod","text":"epsilon Tolerance fitting algorithms default 1e-8. maxiter Maximum number iterations. verbose Value indicating whether trace steps fitting algorithm IRLS fitting method different values verbose give following information: 1 -- Returns information number current iteration current log-likelihood. 2 -- Returns information vector regression parameters current iteration (). 3 -- Returns information reduction log-likelihood current iteration (). 4 -- Returns information value log-likelihood function gradient current iteration (). 5 -- Returns information convergence criterion values taken account considering convergence (). optim method chosen verbose passed stats::optim() trace. printEveryN Integer value indicating often print information specified verbose, default set 1. start initial parameters regression associated main formula specified function call NULL derived simple poisson regression. alphaStart initial parameters dispersion parameter applies. omegaStart initial parameters inflation parameter applies. piStart initial parameters probability parameter applies. optimMethod method stats::optim() used L-BFGS-B default except negative binomial one inflated models \"Nelder-Mead\" used. silent Logical, indicating whether warnings IRLS method suppressed. optimPass Optional list parameters passed stats::optim(..., control = optimPass) FALSE list control parameters inferred parameters. stepsize IRLS, scaling updates beta vector lower value means slower convergence accuracy default 1. general fitting algorithm fails lowering value tends effective correcting . checkDiagWeights Logical value indicating whether check diagonal elements working weights matrixes IRLS sufficiently positive matrixes positive defined. default TRUE. weightsEpsilon Small number ensure positivity weights matrixes. matters checkDiagWeights set TRUE. default \\(\\approx 1.818989\\cdot 10^{-12}\\) momentumFactor Experimental parameter IRLS allowing taking previous step account current step, .e instead updating regression parameters : \\[\\boldsymbol{\\beta}_{()} = \\boldsymbol{\\beta}_{(-1)} + \\text{stepsize}  \\cdot \\text{step}_{()}\\] update made : \\[\\boldsymbol{\\beta}_{()} = \\boldsymbol{\\beta}_{(-1)} + \\text{stepsize}  \\cdot (\\text{step}_{()} + \\text{momentum}\\cdot\\text{step}_{(-1)})\\] saveIRLSlogs Logical value indicating information specified verbose saved output object, default FALSE. useZtpoissonAsStart boolean value indicating whether chose starting parameters ztpoisson regression one useful mostly various one inflated models. momentumActivation value log-likelihood reduction bellow momentum apply. criterion Criterion used determine convergence IRLS, multiple values may provided. default c(\"coef\", \"abstol\").","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Control parameters for regression — controlMethod","text":"List selected parameters, also possible call list directly.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Control parameters for regression — controlMethod","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Control parameters specific to some models — controlModel","title":"Control parameters specific to some models — controlModel","text":"controlModel constructs list necessary control parameters estimatePopsize either specific selected model fit anywhere else. Specifying additional formulas done using right hand side formula also now variables additional formulas also included \"main\" formula.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control parameters specific to some models — controlModel","text":"","code":"controlModel(   weightsAsCounts = FALSE,   omegaFormula = ~1,   alphaFormula = ~1,   piFormula = ~1 )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control parameters specific to some models — controlModel","text":"weightsAsCounts now nothing. plan indicate whether prior.weights treated counts sub populations adjust necessary methods functionalities, like adjustments bootstrap decreasing weights dfbeta instead deleting rows data, accommodate form data. omegaFormula Formula inflation parameter one inflated zero truncated zero truncated one inflated models. alphaFormula Formula dispersion parameter negative binomial based models. piFormula Formula probability parameter pseudo hurdle zero truncated zero truncated pseudo hurdle models.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Control parameters specific to some models — controlModel","text":"list selected parameters, also possible call list directly.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Control parameters specific to some models — controlModel","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":null,"dir":"Reference","previous_headings":"","what":"Control parameters for population size estimation — controlPopVar","title":"Control parameters for population size estimation — controlPopVar","text":"Creating control parameters population size estimation respective standard error variance estimation.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control parameters for population size estimation — controlPopVar","text":"","code":"controlPopVar(   alpha = 0.05,   trcount = 0,   bootType = c(\"parametric\", \"semiparametric\", \"nonparametric\"),   B = 500,   confType = c(\"percentilic\", \"normal\", \"basic\"),   keepbootStat = TRUE,   traceBootstrapSize = FALSE,   bootstrapVisualTrace = FALSE,   fittingMethod = NULL,   bootstrapFitcontrol = NULL,   sd = c(\"sqrtVar\", \"normalMVUE\"),   covType = c(\"observedInform\", \"Fisher\") )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control parameters for population size estimation — controlPopVar","text":"alpha Significance level, 0.05 used default. trcount Truncated count - number added point estimator sides confidence intervals. bootType Bootstrap type. Default \"parametric\", possible values : \"semiparametric\" \"nonparametric\". B Number bootstrap samples performed (default 500). confType Type confidence interval bootstrap confidence interval, \"percentile\" default. possibility: \"studentized\" \"basic\". keepbootStat Boolean value indicating whether keep vector statistics produced bootstrap. traceBootstrapSize Boolean value indicating whether print size bootstrapped sample truncation semi- fully parametric bootstraps. bootstrapVisualTrace Boolean value indicating whether plot bootstrap statistics real time. fittingMethod Method used fitting models bootstrap samples. bootstrapFitcontrol Control parameters regression works exactly like controlMethod fitting models bootstrap samples. sd Indicates compute standard deviation population size estimator either :   \\[\\hat{\\sigma}=\\sqrt{\\hat{\\text{var}}(\\hat{N})}\\] sqrt normalMVUE unbiased minimal variance estimator normal distribution: \\[\\hat{\\sigma}=\\sqrt{\\hat{\\text{var}}(\\hat{N})}\\frac{\\Gamma\\left((N_{obs}-1)/2\\right)}{\\Gamma\\left(N_{obs}/2\\right)}\\sqrt{\\frac{N_{obs}}{2}}\\] ration involving gamma functions computed loggamma function. covType type covariance matrix regression parameters default observed information matrix, options future.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Control parameters for population size estimation — controlPopVar","text":"list selected parameters, also possible call list directly.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Control parameters for population size estimation — controlPopVar","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/dfbetasingleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Regression deletion diagnostics.\n — dfbetasingleR","title":"Regression deletion diagnostics.\n — dfbetasingleR","text":"dfbeta method singleR class.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/dfbetasingleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regression deletion diagnostics.\n — dfbetasingleR","text":"","code":"dfbetasingleR(model, maxitNew = 1, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/dfbetasingleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regression deletion diagnostics.\n — dfbetasingleR","text":"model Fitted object singleR class maxitNew Maximal number iterations regressions starting points \\(\\hat{\\boldsymbol{\\beta}}\\) data specified call model romoval kth row. default 1. ... Additional optional arguments passed following functions: controlMethod -- controlling simulation dfbeta.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/dfbetasingleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regression deletion diagnostics.\n — dfbetasingleR","text":"matrix n rows p observations p number units data p number regression parameters. K'th row matrix corresponds \\(\\hat{\\boldsymbol{\\beta}}-\\hat{\\boldsymbol{\\beta}}_{-k}\\) \\(\\hat{\\boldsymbol{\\beta}}_{-k}\\) vector estimates regression parameters removal k'th row data.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/dfpopsize.html","id":null,"dir":"Reference","previous_headings":"","what":"Regression deletion diagnostics for Population size estimation. — dfpopsize","title":"Regression deletion diagnostics for Population size estimation. — dfpopsize","text":"dfpopsize population size estimation.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/dfpopsize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regression deletion diagnostics for Population size estimation. — dfpopsize","text":"","code":"dfpopsize(model, ...)  # S3 method for singleR dfpopsize(model, dfbeta = NULL, observedPop = FALSE, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/dfpopsize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regression deletion diagnostics for Population size estimation. — dfpopsize","text":"model Model leave one diagnostic popsize done. ... Additional optional arguments passed following functions (singleR class): dfbetas -- dfbeta parameter provided. dfbeta dfbeta already obtained possible pass function need computed second time. observedPop Logical. singleR class object set TRUE indicates 1 returned units take part population size estimation (e.g. 1's zero one truncated models units count => 3 zelterman basic chao model) set FALSE (default) units included results.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/dfpopsize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regression deletion diagnostics for Population size estimation. — dfpopsize","text":"vector k'th element corresponds difference point estimate population size estimation full data set point estimate population size estimation removal k'th unit data set.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/dfpopsize.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Regression deletion diagnostics for Population size estimation. — dfpopsize","text":"","code":"# For singleR class # Get simple model Model <- estimatePopsize(   formula = capture ~ nation + age + gender,    data = netherlandsimmigrant,    model = ztpoisson,    method = \"IRLS\" ) # Get df beta dfb <- dfbeta(Model) # The results res <- dfpopsize(Model, dfbeta = dfb) summary(res) #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -4236.412     2.664     2.664     5.448    17.284   117.448  plot(res)  # It is also possible to not provide dfbeta then they will be # computed manually dfpopsize(Model) #>    [1]     2.663536     2.663536     2.663536    17.284239    17.284239 #>    [6]     2.639998    17.284239     2.663536     2.663536    17.284239 #>   [11]    17.284239     2.663536    14.450792     2.663536     2.663536 #>   [16]  -432.215069     2.663536     2.663536    17.284239     2.663536 #>   [21]    17.284239     2.663536     2.663536    14.450792     2.663536 #>   [26]     2.663536     2.663536    28.980161    28.980161     2.663536 #>   [31]     2.663536    34.051934    34.051934    14.450792    14.450792 #>   [36]    28.980161    14.450792    14.450792    17.284239    17.284239 #>   [41]     2.663536     2.663536    34.051934    70.815819     2.639998 #>   [46]     2.639998    28.980161    14.450792    29.200120    70.815819 #>   [51]    14.450792     2.663536    17.284239    17.284239    17.284239 #>   [56]     2.663536     2.663536    29.200120    17.284239     2.663536 #>   [61]    28.980161     2.663536    14.450792  -602.137338     2.663536 #>   [66]    28.980161    14.450792     2.663536    29.200120     2.663536 #>   [71]     2.663536     2.639998    31.460173     2.663536     2.639998 #>   [76]     2.663536     2.663536     2.663536    34.051934     2.639998 #>   [81]     2.639998     2.639998     2.663536     2.663536     2.663536 #>   [86]     2.663536    31.460173     2.663536     2.663536     2.663536 #>   [91]    17.284239     2.663536     2.663536     2.663536     2.639998 #>   [96]     2.639998     2.663536     2.663536     2.663536    14.450792 #>  [101]     2.663536     2.663536     2.663536     2.663536     2.663536 #>  [106]     2.663536     2.663536     2.663536     2.639998     2.663536 #>  [111]     2.663536     2.663536     2.639998    17.284239     9.803414 #>  [116]     2.663536     2.663536    34.051934     2.545136     2.006834 #>  [121]    17.284239     2.663536     2.663536    14.450792     2.663536 #>  [126]     2.639998    17.284239    14.450792     2.663536    70.815819 #>  [131]     2.663536    14.450792    14.450792    14.450792     2.663536 #>  [136]     2.663536    70.815819    70.815819     2.663536     2.663536 #>  [141]     2.663536     2.663536     2.663536     2.663536     2.663536 #>  [146]     2.663536     2.639998     2.639998     2.639998     2.663536 #>  [151]     2.663536     2.639998     2.663536    17.284239     2.663536 #>  [156]    14.450792    34.051934    70.815819    34.051934   -73.459991 #>  [161]     6.956869    34.051934    34.051934    34.051934     2.639998 #>  [166]     2.663536     2.663536    17.284239    17.284239    14.450792 #>  [171]    17.284239     2.663536  -273.065266     2.006834    34.051934 #>  [176]    14.450792    70.815819    70.815819     2.006834    70.815819 #>  [181]     2.663536     2.663536     2.663536     2.663536    14.450792 #>  [186]    14.450792  -186.033785     2.663536    89.029798    34.051934 #>  [191]    14.450792     2.663536  -123.406425     2.663536     2.663536 #>  [196]     2.639998    17.284239     2.663536     2.663536     2.639998 #>  [201]    70.815819    70.815819    70.815819    34.051934     2.639998 #>  [206]    70.815819    14.450792     2.663536    17.284239    33.222149 #>  [211]     2.006834    14.450792    28.980161    34.051934     2.545136 #>  [216]     2.663536     2.663536     2.663536     2.663536    17.284239 #>  [221]     2.663536     2.639998     2.663536     2.663536     2.663536 #>  [226]     2.663536     2.663536     2.006834    17.284239  -431.175229 #>  [231]     2.663536    34.051934  -602.137338     2.663536     2.663536 #>  [236]     2.663536     2.545136    17.284239     2.006834     2.663536 #>  [241]    34.051934    34.051934     2.663536    17.284239     2.639998 #>  [246]    14.450792    34.051934    34.051934     2.663536    17.284239 #>  [251]    14.450792    33.222149     2.663536     9.803414    17.284239 #>  [256]    34.051934     2.663536   -82.487268     2.663536    14.450792 #>  [261]    70.815819     2.006834     2.006834     2.006834     6.956869 #>  [266]    17.284239    33.222149     2.663536    33.222149    11.195682 #>  [271]     2.378930    17.284239     2.663536  -181.460658    17.284239 #>  [276]     2.545136     2.663536    34.051934    17.284239     2.663536 #>  [281]     2.639998     2.663536     2.663536   -82.487268     2.663536 #>  [286]     2.663536     2.663536    17.284239     2.006834    89.029798 #>  [291]    17.284239     2.663536    33.222149    33.222149     2.663536 #>  [296]    17.284239    17.448909     2.663536    14.450792     2.663536 #>  [301]    14.450792     2.663536     2.663536    14.450792    34.051934 #>  [306]    14.450792     2.663536    17.284239     2.663536     2.663536 #>  [311]    14.450792     2.663536    14.450792     2.663536     2.663536 #>  [316]     9.803414    14.450792    17.284239    11.043640    14.450792 #>  [321]    14.450792     2.006834   -82.487268    14.450792     2.663536 #>  [326]    17.448909     2.663536     2.639998     2.663536     2.663536 #>  [331]     2.378930     2.639998    17.284239     2.639998    17.284239 #>  [336]    34.051934     2.663536     2.663536     2.663536     2.663536 #>  [341]     1.832409    34.051934    14.450792     2.663536    28.980161 #>  [346]     2.663536    17.284239    17.284239     2.006834    70.815819 #>  [351]    34.051934    31.460173     2.663536     2.663536    33.222149 #>  [356]     2.663536    70.815819    70.815819     2.663536    70.815819 #>  [361]     2.663536     2.663536     2.663536     2.639998     2.663536 #>  [366]     2.663536     2.663536     2.663536     2.663536     2.663536 #>  [371]    28.980161    17.284239     2.663536    17.284239     2.639998 #>  [376]     2.663536     2.006834     2.663536     2.639998    14.450792 #>  [381]     2.006834    34.051934     2.639998    33.222149    17.448909 #>  [386]     2.663536     2.663536     2.663536    14.450792    17.284239 #>  [391]    17.284239    17.284239     2.545136    70.815819    11.043640 #>  [396]  -123.406425    17.284239     2.663536     2.663536    33.222149 #>  [401]     2.663536     2.663536     2.663536    14.250667     2.663536 #>  [406]     2.663536     2.639998  -123.406425     2.639998    70.815819 #>  [411]    17.284239    70.815819    14.450792    17.284239     2.639998 #>  [416]     2.006834    14.450792    14.450792     2.639998  -186.033785 #>  [421]    14.450792    34.051934    14.450792    14.450792    14.450792 #>  [426]    14.450792    34.051934    14.450792    14.450792    17.284239 #>  [431]     2.663536     2.639998     2.006834    17.448909    34.051934 #>  [436]    48.199453    14.450792    70.815819    70.815819     2.663536 #>  [441]     2.663536    14.450792     2.663536     2.663536    70.815819 #>  [446]    29.200120     2.663536    31.460173     6.956869     2.639998 #>  [451]     2.639998     2.663536    14.450792    17.284239     2.663536 #>  [456]    70.815819    70.815819     2.006834    17.284239     2.006834 #>  [461]     2.639998    17.284239     2.663536    33.222149     2.639998 #>  [466]     2.663536     2.006834    34.051934     2.663536    17.284239 #>  [471]     2.545136     2.663536     2.663536     2.663536     2.545136 #>  [476]  -186.033785    17.284239     2.663536    17.284239     2.006834 #>  [481]    17.284239     2.663536     2.663536     2.663536    70.815819 #>  [486]     2.663536     2.663536     2.663536     2.663536     2.663536 #>  [491]     2.006834    17.284239     2.545136     2.663536    14.450792 #>  [496]     2.663536    17.284239    17.284239    48.199453     2.639998 #>  [501]    70.815819    70.815819     2.663536     2.006834     2.639998 #>  [506]     2.663536    34.051934    14.450792    14.450792     2.639998 #>  [511]    70.815819    34.051934    17.284239     2.663536     2.639998 #>  [516]     2.545136    70.815819     2.663536    34.051934    17.284239 #>  [521]    14.450792     2.663536     2.663536     2.663536     2.663536 #>  [526]     2.378930     2.663536    34.051934    34.051934    14.450792 #>  [531]    17.284239     2.663536     2.663536    14.450792    14.450792 #>  [536]    14.450792    34.051934    34.051934     6.956869     9.803414 #>  [541]     2.663536 -4236.412366    70.815819     2.663536     2.663536 #>  [546]     2.545136   -82.487268     2.006834    14.450792    14.450792 #>  [551]    89.029798    14.450792    14.450792     2.663536     2.639998 #>  [556]     2.663536     2.006834    34.051934     2.663536     2.663536 #>  [561]    34.051934     2.663536    17.284239    17.284239     2.663536 #>  [566]    17.284239     2.639998     2.663536     2.639998    17.284239 #>  [571]     2.663536     2.663536    17.284239     2.663536     2.663536 #>  [576]     2.006834    33.222149     2.663536   -30.943957     2.663536 #>  [581]     2.663536     2.006834    14.450792    17.284239    17.284239 #>  [586]     2.663536     2.006834    14.450792     2.663536     2.663536 #>  [591]    14.450792     2.663536     2.663536     2.663536     2.663536 #>  [596]     2.663536     2.663536    17.284239     2.006834    17.284239 #>  [601]    17.284239     2.663536    17.284239     2.639998    17.284239 #>  [606]     2.663536    17.284239     2.663536     2.006834    17.284239 #>  [611]    17.284239    34.051934     2.663536    17.284239    17.284239 #>  [616]     2.663536    17.284239     6.956869    14.450792     2.663536 #>  [621]    17.284239    17.284239     2.639998     2.545136    33.222149 #>  [626]    14.450792    14.450792     2.663536     2.639998     2.006834 #>  [631]    17.284239     2.663536     2.006834    17.284239    14.450792 #>  [636]     2.663536     2.006834    11.195682    19.982326    11.195682 #>  [641]    38.553547    19.982326    19.982326    11.195682    11.195682 #>  [646]   -34.558010    19.982326    29.627385    11.195682    11.195682 #>  [651]    11.195682    17.448909    11.195682    11.195682  -166.715316 #>  [656]    17.448909    19.982326    11.195682    11.195682    11.195682 #>  [661]    17.448909    11.195682    11.195682    11.195682    17.448909 #>  [666]    29.627385    19.982326    11.195682    11.195682    17.448909 #>  [671]    11.195682   -81.899248    11.195682   -34.558010    35.229210 #>  [676]    11.195682  -125.391486    11.195682   -34.558010     9.803414 #>  [681]    69.702223    11.195682    11.195682     9.803414     9.803414 #>  [686]   -81.899248    11.195682    11.195682    19.982326    11.195682 #>  [691]    11.195682   -34.558010    11.195682   -34.558010    11.195682 #>  [696]    11.195682     9.803414     9.803414    11.195682    11.195682 #>  [701]   -30.943957    11.195682     9.803414     9.803414     9.803414 #>  [706]    19.982326    11.195682   -34.558010     9.803414    11.195682 #>  [711]     9.803414    62.532530    19.982326    17.448909    19.982326 #>  [716]    19.982326    11.195682  -166.715316    11.195682    69.702223 #>  [721]    19.982326    11.195682    11.195682     9.803414    35.229210 #>  [726]    17.448909     9.803414     9.803414    17.448909    11.195682 #>  [731]    11.195682    11.195682    11.195682   -34.558010     9.803414 #>  [736]     9.803414    11.195682    17.448909    11.195682    19.982326 #>  [741]   -34.558010    11.195682    11.195682    11.195682    19.982326 #>  [746]    38.553547    19.982326    11.195682    11.195682     9.803414 #>  [751]     9.803414    19.982326    19.982326    17.448909    11.195682 #>  [756]    11.195682    11.195682    11.195682     9.803414    19.982326 #>  [761]    19.982326    11.195682    11.195682     9.803414    17.448909 #>  [766]    69.702223    17.448909     9.803414    11.195682  -166.715316 #>  [771]    11.195682    11.195682    11.195682    11.195682   -34.558010 #>  [776]    11.195682    35.229210    11.195682    11.195682    11.195682 #>  [781]    11.195682    11.195682    11.195682    11.195682    11.195682 #>  [786]    11.195682    11.195682    19.982326    11.195682     9.803414 #>  [791]    17.448909    19.982326     9.803414    11.195682    17.448909 #>  [796]   -34.558010    11.195682    19.982326    17.448909   117.447911 #>  [801]    11.195682    11.195682    11.195682     9.803414    17.448909 #>  [806]    11.195682    62.532530    11.195682    11.195682   -34.558010 #>  [811]    19.982326    11.195682    19.982326    17.448909    11.195682 #>  [816]    17.448909    11.195682    11.195682    34.277056    35.229210 #>  [821]    11.195682    11.195682    11.195682    29.627385    69.702223 #>  [826]    69.702223     9.803414    17.448909    11.195682    19.982326 #>  [831]    11.195682    19.982326    34.277056    69.702223    19.982326 #>  [836]    11.195682    17.448909    27.444960    11.195682     9.803414 #>  [841]    11.195682     9.803414    17.448909     9.803414    11.195682 #>  [846]     9.803414  -125.391486    11.195682    11.195682     9.803414 #>  [851]     9.803414    19.982326    19.982326    11.195682    11.195682 #>  [856]    11.195682   -34.558010    11.195682    11.195682    19.982326 #>  [861]    19.982326    11.195682    19.982326    17.448909   -34.558010 #>  [866]    11.195682    17.448909    19.982326    19.982326  -125.391486 #>  [871]    19.982326    11.195682    11.195682    11.195682    69.702223 #>  [876]    62.532530    69.702223  -340.114430    27.444960    11.195682 #>  [881]    17.448909    17.448909    19.982326    11.195682    35.229210 #>  [886]     9.803414    17.448909    11.195682     9.803414     9.803414 #>  [891]    17.448909     9.803414    69.702223    17.448909     9.803414 #>  [896]    17.448909    11.195682    11.195682    11.195682  -575.048260 #>  [901]    11.195682     9.803414    11.195682    11.195682    19.982326 #>  [906]    11.195682    11.195682    11.195682     9.803414     9.803414 #>  [911]    11.195682     9.803414    19.982326    69.702223     9.803414 #>  [916]    17.448909   -81.899248   -34.558010    11.195682     9.803414 #>  [921]    35.229210    17.448909    19.982326    19.982326    11.195682 #>  [926]    11.195682    19.982326    11.195682    11.195682    11.195682 #>  [931]     9.803414    11.195682     9.803414    17.448909    27.444960 #>  [936]    11.195682    69.702223    11.195682    19.982326     9.803414 #>  [941]    27.444960    69.702223    17.448909    17.448909    11.195682 #>  [946]    35.229210    11.195682    19.982326    11.195682    19.982326 #>  [951]    11.195682    11.195682   -81.899248     2.663536    34.051934 #>  [956]     2.006834     2.006834     2.663536     2.663536     2.663536 #>  [961]    14.450792     2.639998     6.956869     2.639998     2.663536 #>  [966]     2.663536     2.663536     2.663536     2.639998     2.663536 #>  [971]     2.663536     2.663536    17.448909     2.663536    17.284239 #>  [976]     2.663536     2.663536     2.663536     2.663536    33.222149 #>  [981]     2.006834    11.195682     2.006834     2.663536     2.006834 #>  [986]     2.006834    17.448909    17.448909    17.448909     2.663536 #>  [991]     2.663536     2.006834    19.982326    14.450792     2.663536 #>  [996]     2.663536     2.663536     2.663536    17.284239    17.284239 #> [1001]    17.284239    17.448909     2.663536    17.284239    11.195682 #> [1006]     2.663536     2.663536     2.639998     2.663536    14.450792 #> [1011]     2.663536     2.663536    33.222149     2.663536    14.450792 #> [1016]    17.448909     2.663536     2.663536     2.663536     2.663536 #> [1021]     2.663536     2.663536    34.051934     2.663536     2.006834 #> [1026]     2.663536     2.663536    14.450792     2.663536    70.815819 #> [1031]     2.639998     2.663536     2.663536    17.284239     2.663536 #> [1036]     2.639998     2.639998    69.702223     2.639998     2.639998 #> [1041]     2.639998     2.006834     2.639998     2.639998     2.663536 #> [1046]     2.663536     2.639998     2.006834     2.639998     2.545136 #> [1051]    35.229210     2.639998  -602.137338    17.284239     2.663536 #> [1056]     2.639998     2.639998     2.663536     2.006834     2.639998 #> [1061]     2.006834    14.450792     2.663536    14.450792     2.663536 #> [1066]     2.663536     2.639998     2.663536     2.663536    69.702223 #> [1071]     2.006834     2.639998     2.663536    17.284239     2.663536 #> [1076]     2.663536     2.639998     2.663536     2.545136     2.663536 #> [1081]     2.663536     2.639998    14.250667     2.378930     2.006834 #> [1086]    28.980161    34.051934     2.663536     2.663536     2.663536 #> [1091]     2.663536     2.639998     2.663536     2.663536     2.006834 #> [1096]     2.006834     2.663536    14.450792     2.663536     2.663536 #> [1101]     2.663536     2.639998    70.815819    35.229210     2.663536 #> [1106]    34.051934     2.663536    17.284239    17.284239    27.444960 #> [1111]    27.444960     2.663536     2.663536   -73.459991     2.663536 #> [1116]    33.222149     2.663536     2.639998     2.663536    17.284239 #> [1121]     2.639998     2.639998     2.663536     2.663536     2.006834 #> [1126]     2.663536    17.284239     2.663536     2.006834     2.639998 #> [1131]     2.663536    17.284239   117.447911    29.200120    34.051934 #> [1136]     2.663536     2.639998     2.663536    19.982326    14.450792 #> [1141]    17.284239     2.663536    14.450792     2.663536     9.803414 #> [1146]     2.663536     2.663536     2.663536     2.663536     2.663536 #> [1151]     2.663536     2.639998    19.982326     2.639998     2.663536 #> [1156]     2.663536    35.229210     2.663536     2.663536     2.639998 #> [1161]     2.639998     2.639998    14.450792    14.450792     2.545136 #> [1166]    14.450792    48.199453    48.199453     2.663536     2.663536 #> [1171]     2.545136    17.284239     2.663536     2.639998    11.043640 #> [1176]     2.639998     2.663536     2.663536     2.378930    14.450792 #> [1181]     2.663536     2.639998     2.545136    28.980161    14.450792 #> [1186]    14.450792    70.815819     2.663536     2.663536     2.639998 #> [1191]    69.702223    17.284239     2.663536    17.284239    17.284239 #> [1196]    17.284239    17.284239    17.284239    17.284239    17.284239 #> [1201]    17.284239     2.663536     2.663536     2.663536     2.663536 #> [1206]     9.803414     2.663536     2.663536     2.663536     2.663536 #> [1211]     2.663536    69.702223     2.378930    34.051934     2.663536 #> [1216]     2.663536     2.663536    34.051934    34.051934    14.450792 #> [1221]    33.222149     2.663536     2.663536     2.639998    14.450792 #> [1226]     2.639998     2.639998     2.006834     2.663536     2.639998 #> [1231]    17.284239    17.284239    17.284239     2.663536     2.663536 #> [1236]     2.639998  -289.107107    17.284239     2.663536    17.284239 #> [1241]     2.639998     2.006834     2.639998     2.006834     2.006834 #> [1246]     2.663536     2.663536     2.663536    14.450792    14.450792 #> [1251]    14.450792     2.006834  -125.391486    17.284239     2.663536 #> [1256]     2.663536    14.450792    14.450792    17.284239     2.663536 #> [1261]     2.663536     2.663536    17.284239     2.378930     2.639998 #> [1266]     2.663536    14.450792     2.663536    17.284239    17.284239 #> [1271]    17.284239    17.448909     2.663536     2.639998    14.450792 #> [1276]     2.639998    17.284239     2.663536     2.663536    14.450792 #> [1281]     2.663536    17.284239    17.284239    17.284239    17.284239 #> [1286]     2.663536    14.450792     2.663536    29.200120     2.006834 #> [1291]     2.639998     6.956869     2.663536     2.663536     2.545136 #> [1296]     2.663536     2.663536     2.663536     6.956869     2.663536 #> [1301]     2.639998     2.663536     2.545136     2.545136     2.663536 #> [1306]    34.051934     2.663536     2.006834     2.663536    17.284239 #> [1311]    17.284239    19.982326     2.663536     2.663536    17.284239 #> [1316]     2.639998     2.663536     2.663536    17.284239     2.663536 #> [1321]   -82.487268    14.450792     2.639998     2.663536     2.663536 #> [1326]     2.663536     2.378930     2.006834    14.450792     2.663536 #> [1331]     2.639998     2.663536     2.663536     2.663536     2.663536 #> [1336]     2.639998    69.702223     2.639998     2.663536     2.639998 #> [1341]     2.639998    17.284239    17.284239    14.450792     2.006834 #> [1346]     2.663536     2.663536     2.545136     2.663536    14.450792 #> [1351]     2.663536     2.663536     2.663536     2.639998     2.639998 #> [1356]     2.663536    14.450792     2.006834     2.663536     2.663536 #> [1361]    14.450792     2.006834    17.284239    17.448909     6.956869 #> [1366]     2.663536     2.663536    17.284239     9.803414     2.663536 #> [1371]     2.663536     2.663536     2.639998     2.663536     2.663536 #> [1376]     2.663536     2.663536     2.663536   -82.487268     2.639998 #> [1381]     2.663536     2.663536     2.545136     2.663536    14.450792 #> [1386]     2.663536     2.663536    11.195682     2.663536     2.639998 #> [1391]    17.284239     2.663536     2.663536    11.195682     2.663536 #> [1396]     2.663536     2.663536     2.663536    17.284239     2.663536 #> [1401]     2.663536     2.663536     2.663536    17.284239     2.663536 #> [1406]     2.663536     2.663536     2.663536     2.663536     2.663536 #> [1411]     2.663536     2.663536    17.284239     2.006834     2.663536 #> [1416]     2.663536     2.663536     2.663536     2.663536     2.663536 #> [1421]     2.663536     2.639998     2.663536     2.006834     2.663536 #> [1426]     2.663536     2.663536     2.663536     2.663536     2.663536 #> [1431]     2.663536    14.450792     2.663536     2.663536     2.663536 #> [1436]     2.663536     2.006834     2.663536     2.663536    31.460173 #> [1441]     2.663536     2.663536    69.702223     2.663536     2.663536 #> [1446]    17.284239     2.663536    33.222149     2.663536     2.663536 #> [1451]     2.663536     2.663536     2.663536    31.460173     2.663536 #> [1456]     2.663536     2.639998     2.663536     2.639998    33.222149 #> [1461]    11.195682    14.450792     2.663536     2.663536     2.663536 #> [1466]     2.663536     2.663536     2.663536     2.663536    17.448909 #> [1471]     2.663536     2.663536     2.663536     2.663536     2.639998 #> [1476]     2.663536     2.663536     2.663536     2.663536     2.663536 #> [1481]    29.200120     2.663536    17.284239     2.663536     9.803414 #> [1486]  -289.107107     2.639998     2.663536     2.663536     2.663536 #> [1491]     2.663536     2.663536     2.663536     2.663536     2.663536 #> [1496]    14.450792    14.450792    14.450792     2.663536    17.284239 #> [1501]    17.284239    17.284239    17.448909     2.663536     2.639998 #> [1506]     2.663536     2.663536     2.663536     2.663536     2.663536 #> [1511]     2.006834     2.663536     2.663536     2.006834    31.460173 #> [1516]     2.006834     2.545136     2.663536     2.663536     2.663536 #> [1521]     2.663536     2.663536     2.663536     2.663536     2.663536 #> [1526]     2.663536    14.450792     2.663536     2.663536     2.663536 #> [1531]     2.639998     2.663536     2.663536     2.663536    17.448909 #> [1536]    14.450792     2.663536    17.284239    17.284239     2.663536 #> [1541]     2.545136     2.663536     2.663536    14.450792    34.051934 #> [1546]     2.663536     2.663536     2.663536    17.448909    17.448909 #> [1551]     2.663536     2.663536     2.663536     2.663536     9.803414 #> [1556]    17.284239     2.663536     6.956869    11.195682     2.663536 #> [1561]     2.006834     2.663536     2.663536     2.663536     2.663536 #> [1566]     2.006834     2.663536    14.450792     2.663536     2.663536 #> [1571]     2.663536     2.663536     2.663536     2.663536     2.663536 #> [1576]    62.532530     2.663536    11.195682     2.663536     2.006834 #> [1581]    34.051934    17.284239    89.029798    34.051934    14.450792 #> [1586]    70.815819    17.284239    19.982326    17.284239    33.222149 #> [1591]    17.284239    19.982326    11.195682     2.663536    34.051934 #> [1596]    34.051934     2.663536     2.663536    17.284239    17.284239 #> [1601]     2.663536  -123.406425    17.284239    17.284239     9.803414 #> [1606]    35.229210    14.450792    14.450792    11.195682    33.222149 #> [1611]     2.663536    17.284239     2.663536    48.199453     2.663536 #> [1616]    29.200120    11.195682     2.663536     2.663536     2.663536 #> [1621]    33.222149     2.663536    14.450792    14.450792    14.450792 #> [1626]    14.450792    14.450792    28.980161     2.663536    29.200120 #> [1631]     2.006834  -123.406425    17.284239    34.051934     2.663536 #> [1636]    17.284239     2.663536    34.051934     2.639998    14.450792 #> [1641]    34.051934    70.815819     2.663536    33.222149    14.450792 #> [1646]    11.195682     2.663536    17.284239    17.284239     2.663536 #> [1651]    14.450792    14.450792    33.222149    14.450792    33.222149 #> [1656]     2.663536    19.982326     2.663536    17.284239    17.448909 #> [1661]    17.448909     2.663536     2.006834     2.663536     2.663536 #> [1666]    34.051934    34.051934    33.222149    17.284239     2.663536 #> [1671]     2.006834     2.006834     2.006834     2.663536    17.284239 #> [1676]    14.450792    17.448909    28.980161    29.200120    19.982326 #> [1681]     2.639998     2.663536     2.663536     2.663536     9.803414 #> [1686]    17.284239    17.284239    14.450792     2.663536     2.663536 #> [1691]    17.284239    17.284239    17.284239    34.051934    33.222149 #> [1696]    17.284239    89.029798    17.284239    17.284239    33.222149 #> [1701]    14.450792    19.982326     2.663536     2.663536    14.450792 #> [1706]     2.663536     2.663536     2.663536     2.663536    17.284239 #> [1711]     9.803414     2.663536    48.199453    17.284239    33.222149 #> [1716]    17.284239    17.284239    17.284239    14.450792     2.663536 #> [1721]    19.982326     2.663536    34.051934    34.051934    14.450792 #> [1726]     2.663536    17.448909     2.663536     2.663536    70.815819 #> [1731]     2.639998     2.639998     2.663536    17.284239  -289.107107 #> [1736]     2.006834    17.284239    17.284239     2.663536     2.663536 #> [1741]    19.982326     2.663536     2.663536    17.284239    17.284239 #> [1746]     2.663536     2.663536     2.663536     2.663536     2.663536 #> [1751]     2.639998     2.663536     2.663536     2.663536    17.284239 #> [1756]    14.450792    31.460173    31.460173     2.663536     2.545136 #> [1761]    17.284239    14.450792     2.639998     2.663536    34.051934 #> [1766]    34.051934    17.284239     2.378930    34.051934    17.284239 #> [1771]    17.284239    17.284239    17.284239    14.450792     2.663536 #> [1776]    14.450792    14.450792    14.450792    14.450792    14.450792 #> [1781]    14.450792    19.982326    14.450792    14.450792    17.284239 #> [1786]     2.663536     2.006834    14.450792   -82.487268    17.284239 #> [1791]    17.284239     6.956869    29.200120     2.663536    33.222149 #> [1796]    33.222149    17.284239     2.663536     2.663536     2.663536 #> [1801]    48.199453    17.448909     2.663536    17.284239    17.284239 #> [1806]     2.663536    17.284239    29.200120     2.663536     2.639998 #> [1811]    34.051934     2.663536     2.663536    33.222149    11.195682 #> [1816]    33.222149     2.663536     2.663536     2.663536    33.222149 #> [1821]    34.051934     2.663536    17.284239     2.663536     2.663536 #> [1826]     2.663536    14.450792     2.663536     2.639998    14.450792 #> [1831]    17.284239     2.663536     2.663536    14.450792     2.663536 #> [1836]     2.663536    33.222149     2.663536     2.663536     2.663536 #> [1841]    17.448909     2.663536     9.803414     2.663536     2.663536 #> [1846]     2.663536    14.450792    31.460173    48.199453    17.284239 #> [1851]     2.639998     2.663536     2.663536     2.663536    17.284239 #> [1856]    17.284239     2.663536     2.663536    14.450792    31.460173 #> [1861]    33.222149    17.284239     2.663536    17.448909    17.448909 #> [1866]    14.450792     2.663536     2.663536     2.663536    33.222149 #> [1871]     2.006834     2.663536    17.284239    17.284239     2.663536 #> [1876]     2.663536    14.450792    28.980161    17.284239    14.450792"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estfun.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Empirical Estimating Functions — estfun.singleR","title":"Empirical Estimating Functions — estfun.singleR","text":"Empirical Estimating Functions","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estfun.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Empirical Estimating Functions — estfun.singleR","text":"","code":"# S3 method for singleR estfun(object, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estfun.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Empirical Estimating Functions — estfun.singleR","text":"object object representing fitted model. ... additional optional arguments.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estfun.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Empirical Estimating Functions — estfun.singleR","text":"matrix n rows k columns k denotes number variables.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estfun.singleR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Empirical Estimating Functions — estfun.singleR","text":"Piotr Chlebicki, Maciej Beręsewicz S3method sandwich::estfun handle singleR objects.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estfun.singleR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Empirical Estimating Functions — estfun.singleR","text":"","code":"set.seed(1) N <- 10000 gender <- rbinom(N, 1, 0.2) eta <- -1 + 0.5*gender counts <- rpois(N, lambda = exp(eta)) df <- data.frame(gender, eta, counts) df2 <- subset(df, counts > 0) mod1 <-  estimatePopsize(   formula = counts ~ 1 + gender,    data = df2,    model = \"ztpoisson\",    method = \"optim\",    popVar = \"analytic\" ) mod1_sims <- sandwich::estfun(mod1) head(mod1_sims)  #>   (Intercept)    gender #> 1  -0.1924342 0.0000000 #> 2   0.6700925 0.6700925 #> 3  -0.1924342 0.0000000 #> 4  -0.1924342 0.0000000 #> 5  -0.1924342 0.0000000 #> 6  -0.1924342 0.0000000"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"estimatePopsize.fit estimatePopsize glm.fit glm. internally called estimatePopsize. Since estimatePopsize much just regression fitting estimatePopsize.fit much faster.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"","code":"estimatePopsize.fit(y, X, family, control, method, priorWeights, start, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"y vector dependent variables. X model matrix, vglm one. family model estimatePopsize. control control parameters created controlModel. method method estimation estimatePopsize. priorWeights vector prior weights argument weights estimatePopsize. start initial value regression parameters. ... arguments pass methods.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"List regression parameters, working weights (IRLS fitting method) chosen number iterations taken.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"method argument set \"optim\" stats::optim function used fit regression analyticly computed gradient (minus) log likelihood functions gr fn arguments. Unfortunately optim allow hessian specified. information modify optim fitting included controlMethod(). method argument set \"IRLS\" iteratively reweighted least squares. algorithm well know generalised linear models. Thomas W. Yee later extended algorithm vector generalised linear models general terms can roughly described (Yee's description changing conventions): Initialise : converged <- FALSE iter <- 1 \\(\\boldsymbol{\\beta}\\) <- start \\(\\boldsymbol{W}\\) <- prior \\(\\ell\\) <- \\(\\ell(\\boldsymbol{\\beta})\\) converged iter > Maxiter move step 7. Store values previous algorithm step: \\(\\boldsymbol{W}_{-}\\) <- \\(\\boldsymbol{W}\\) \\(\\ell_{-}\\) <- \\(\\ell\\) \\(\\boldsymbol{\\beta}_{-}\\) <- \\(\\boldsymbol{\\beta}\\) assign values current step: \\(\\boldsymbol{\\eta}\\) <- \\(\\boldsymbol{X}_{vlm}\\boldsymbol{\\beta}\\) \\(Z_{}\\) <- \\(\\eta_{}+\\frac{\\partial\\ell_{}}{\\partial\\eta_{}}\\mathbb{E}\\left(\\frac{\\partial^{2}\\ell_{}}{\\partial\\eta_{}^{T}\\partial\\eta_{}}\\right)^{-1}\\) \\(\\boldsymbol{W}_{ij}\\) <- \\(\\mathbb{E}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\boldsymbol{\\eta}_{j}^{T}\\partial\\boldsymbol{\\eta}_{}}\\right)\\) \\(\\ell_{}\\) ith component log likelihood function, \\(\\eta_{}\\) vector linear predictors associated ith row  \\(\\mathbb{E}\\left(\\frac{\\partial^{2}\\ell_{}}{\\partial\\eta_{}^{T}\\partial\\eta_{}}\\right)\\) corresponds weights associated ith row \\(\\boldsymbol{W}\\) block matrix, made diagonal matrixes \\(\\mathbb{E}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\boldsymbol{\\eta}_{j}^{T}\\partial\\boldsymbol{\\eta}_{}}\\right)\\). Regress \\(\\boldsymbol{Z}\\) \\(\\boldsymbol{X}_{vlm}\\) obtain \\(\\boldsymbol{\\beta}\\) : \\[\\boldsymbol{\\beta}=\\left(\\boldsymbol{X}_{vlm}^{T}\\boldsymbol{W}\\boldsymbol{X}_{vlm}\\right)^{-1}\\boldsymbol{X}_{vlm}^{T}\\boldsymbol{W}\\boldsymbol{Z}\\] Assign: converged <- \\(\\ell(\\boldsymbol{\\beta})-\\ell_{-} \\(||\\boldsymbol{\\beta}-\\boldsymbol{\\beta}_{-}||_{\\infty} iter <- iter + 1 \\(\\varepsilon\\) relative tolerance level, default 1e-8. Return step 2. Return \\(\\boldsymbol{\\beta}, \\boldsymbol{W}\\), iter. package use different conventions \\(\\boldsymbol{X}_{vlm}\\) matrix hence slight differences present algorithm description results identical.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"Yee, T. W. (2015). Vector Generalized Linear Additive Models: Implementation R. New York, USA: Springer. ISBN 978-1-4939-2817-0.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"","code":"# Get data summary(farmsubmission) #>    TOTAL_SUB        log_size       log_distance      C_TYPE     #>  Min.   : 1.00   Min.   : 0.000   Min.   : 4.102   Beef :5336   #>  1st Qu.: 1.00   1st Qu.: 4.673   1st Qu.:10.351   Dairy:6700   #>  Median : 1.00   Median : 5.347   Median :10.778                #>  Mean   : 2.34   Mean   : 5.259   Mean   :10.662                #>  3rd Qu.: 3.00   3rd Qu.: 5.940   3rd Qu.:11.099                #>  Max.   :47.00   Max.   :10.480   Max.   :12.097                 # construct vglm model matrix X <- matrix(data = 0, nrow = 2 * NROW(farmsubmission), ncol = 7) X[1:NROW(farmsubmission), 1:4] <- model.matrix(~ 1 + log_size + log_distance + C_TYPE,                                                 farmsubmission) X[-(1:NROW(farmsubmission)), 5:7] <- X[1:NROW(farmsubmission), c(1, 3, 4)] # this atrrtibute tells the function which elements of the design matrix  # correspond to which linear predictor  attr(X, \"hwm\") <- c(4, 3)  # get starting points start <- glm.fit(y = farmsubmission$TOTAL_SUB,                   x = X[1:NROW(farmsubmission), 1:4],                   family = poisson())$coefficients start <- c(start, start)[-6]  # call function res <- estimatePopsize.fit(   y = farmsubmission$TOTAL_SUB, X = X,    method = \"IRLS\",    priorWeights = 1,    family = ztnegbin(),    control = controlMethod(verbose = 5, stepsize = .75),    start = start ) #> Iteration number 1 log-likelihood: -17823.492 #> Parameter vector:  -1.863614065  0.475204649 -0.059013713  0.508672485 -0.327870990  0.086003420 -0.412206957 #> log-likelihood reduction:  901.05077 #> Value of gradient at current step: #>   -1990.34010 -10046.53984 -21321.73078   -881.45383   -716.47124  -7710.75827   -223.33215 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 1.0377746 #> ---- #> Iteration number 2 log-likelihood: -17437.869 #> Parameter vector:  -2.83898717  0.57720341 -0.10523301  1.12722093  0.56681686  0.10483184 -1.23067278 #> log-likelihood reduction:  385.62317 #> Value of gradient at current step: #>    -952.47949  -4741.57983 -10212.19812   -343.98249   -618.99677  -6663.81837   -154.63246 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.9753731 #> ---- #> Iteration number 3 log-likelihood: -17295.881 #> Parameter vector:  -4.277654805  0.634942790 -0.094367704  2.034974650  2.129255661  0.045962697 -2.151527944 #> log-likelihood reduction:  141.98855 #> Value of gradient at current step: #>   -413.877606 -2040.706942 -4437.013207  -109.135778  -335.406082 -3613.098860   -58.889591 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 1.5624388 #> ---- #> Iteration number 4 log-likelihood: -17254.788 #> Parameter vector:  -5.074237097  0.657164096 -0.065241752  2.383629778  2.963616845 -0.012076137 -2.400279250 #> log-likelihood reduction:  41.092258 #> Value of gradient at current step: #>   -139.233750  -688.045460 -1494.707463   -31.451417  -119.220834 -1289.011111   -18.285995 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.83436118 #> ---- #> Iteration number 5 log-likelihood: -17249.547 #> Parameter vector:  -4.774524360  0.662053670 -0.044529503  1.836061126  2.726829334 -0.051866915 -1.757369114 #> log-likelihood reduction:  5.2412309 #> Value of gradient at current step: #>   -63.5748960 -321.6545983 -684.1437189   -8.2718619  -53.2100503 -575.5959048   -4.9379602 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.64291014 #> ---- #> Iteration number 6 log-likelihood: -17248.249 #> Parameter vector:  -4.835540464  0.662167608 -0.035783429  1.804157770  2.839194697 -0.069600686 -1.687091493 #> log-likelihood reduction:  1.297721 #> Value of gradient at current step: #>   -18.1670449  -93.5635288 -195.4516204   -1.8801929  -15.2974529 -166.1966860   -1.1055869 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.11236536 #> ---- #> Iteration number 7 log-likelihood: -17248.124 #> Parameter vector:  -4.855173778  0.661631136 -0.030951097  1.775866425  2.893117770 -0.078930576 -1.643617473 #> log-likelihood reduction:  0.12542882 #> Value of gradient at current step: #>   -5.09474726 -26.86182291 -54.68025446  -0.31599164  -4.30159131 -46.99053242  -0.15658923 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.053923072 #> ---- #> Iteration number 8 log-likelihood: -17248.111 #> Parameter vector:  -4.869222066  0.661291201 -0.028553463  1.766492854  2.925234681 -0.083337860 -1.629297554 #> log-likelihood reduction:  0.012733557 #> Value of gradient at current step: #>   -1.3853783943  -7.4936132003 -14.7775491504  -0.0029837741  -1.1725847577 -12.9317767769   0.0210690304 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.032116912 #> ---- #> Iteration number 9 log-likelihood: -17248.11 #> Parameter vector:  -4.878601512  0.661142449 -0.027356478  1.764027333  2.943714416 -0.085451652 -1.625364637 #> log-likelihood reduction:  0.0014891304 #> Value of gradient at current step: #>  -0.370222180 -2.053092128 -3.896791620  0.031408128 -0.313176215 -3.517494590  0.030299548 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.018479735 #> ---- #> Iteration number 10 log-likelihood: -17248.109 #> Parameter vector:  -4.884428351  0.661088309 -0.026745792  1.763676178  2.954159150 -0.086502035 -1.624635420 #> log-likelihood reduction:  0.00023214207 #> Value of gradient at current step: #>  -0.097085431 -0.548015909 -0.992635397  0.020829242 -0.081547757 -0.950416398  0.017156916 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.010444734 #> ---- #> Iteration number 11 log-likelihood: -17248.109 #> Parameter vector:  -4.887891666  0.661071862 -0.026427030  1.763844710  2.960014930 -0.087041938 -1.624741552 #> log-likelihood reduction:  0.000049464685 #> Value of gradient at current step: #>  -0.0244288622 -0.1369923344 -0.2330800911  0.0104457077 -0.0201048220 -0.2538208423  0.0078031412 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0058557802 #> ---- #> Iteration number 12 log-likelihood: -17248.109 #> Parameter vector:  -4.889896238  0.661068424 -0.026257410  1.764065384  2.963284363 -0.087326822 -1.624977559 #> log-likelihood reduction:  0.000012968816 #> Value of gradient at current step: #>  -0.0054936460 -0.0280725656 -0.0423691845  0.0047815789 -0.0042694449 -0.0657406646  0.0032046729 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0032694329 #> ---- #> Iteration number 13 log-likelihood: -17248.109 #> Parameter vector:  -4.891038102  0.661068747 -0.026165840  1.764231845  2.965105668 -0.087479934 -1.625169563 #> log-likelihood reduction:  0.0000037518475 #> Value of gradient at current step: #>  -0.00081415908 -0.00154913728  0.00058787900  0.00213216227 -0.00046741440 -0.01567805862  0.00123848981 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0018213048 #> ---- #> Iteration number 14 log-likelihood: -17248.109 #> Parameter vector:  -4.891682302  0.661069771 -0.026115905  1.764339392  2.966119024 -0.087563233 -1.625297130 #> log-likelihood reduction:  0.0000011296142 #> Value of gradient at current step: #>   0.00017691809  0.00333586625  0.00710904606  0.00095736585  0.00027149223 -0.00287279077  0.00045826765 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0010133567 #> ---- #> Iteration number 15 log-likelihood: -17248.109 #> Parameter vector:  -4.892043617  0.661070652 -0.026088489  1.764404315  2.966682481 -0.087608908 -1.625375180 #> log-likelihood reduction:  0.00000034540062 #> Value of gradient at current step: #>  0.000278260817 0.003134859767 0.005889524752 0.000441022418 0.000300811303 0.000060264918 0.000163250593 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.00056345669 #> ---- #> Iteration number 16 log-likelihood: -17248.109 #> Parameter vector:  -4.892245549  0.661071255 -0.026073372  1.764442164  2.966995675 -0.087634077 -1.625421014 #> log-likelihood reduction:  0.00000010624353 #> Value of gradient at current step: #>  0.000207048428 0.002141510484 0.003837663574 0.000210289436 0.000210071985 0.000510482489 0.000055765696 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.00031319386 #> ---- #> Iteration number 17 log-likelihood: -17248.109 #> Parameter vector:  -4.892358157  0.661071631 -0.026065012  1.764463806  2.967169732 -0.087647990 -1.625447333 #> log-likelihood reduction:  0.000000032756361 #> Value of gradient at current step: #>  0.000130631070 0.001317083252 0.002300435238 0.000103922279 0.000129207065 0.000423260509 0.000017954749 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.00017405749 #> ---- #> Iteration number 18 log-likelihood: -17248.109 #> Parameter vector:  -4.892420869  0.661071855 -0.026060381  1.764476043  2.967266457 -0.087655696 -1.625462251 #> log-likelihood reduction:  0.000000010109943 #> Value of gradient at current step: #>  0.0000773133399 0.0007730294781 0.0013292446209 0.0000530252617 0.0000754845466 0.0002767688139 0.0000051986125 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.000096724415 #> ---- #> Iteration number 19 log-likelihood: -17248.109 #> Parameter vector:  -4.892455765  0.661071984 -0.026057813  1.764482915  2.967320205 -0.087659969 -1.625470643 #> log-likelihood reduction:  0.0000000031177478 #> Value of gradient at current step: #>  0.0000444231564 0.0004430897789 0.0007543996591 0.0000277613000 0.0000430541392 0.0001664007641 0.0000011574014 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.000053747991 #> ---- #> Value of analytically computed hessian at fitted regression coefficients: #>            [,1]        [,2]        [,3]       [,4]        [,5]        [,6] #> [1,]  -4571.198  -25603.050  -48636.526  -3380.822  -2509.0416 -145504.062 #> [2,] -25603.050 -147121.881 -272342.860 -19693.776 -26719.7926   -8691.145 #> [3,] -48636.526 -272342.860 -519445.388 -35856.228  -1501.4753  -26719.793 #> [4,]  -3380.822  -19693.776  -35856.228  -3380.822 -13666.9346 -285668.725 #> [5,]  -2509.042   -1501.475 -285668.725  -8691.145  -1717.8473  -18309.479 #> [6,] -13666.935  -26719.793  -15908.319 -15908.319 -18309.4795 -195877.543 #> [7,] -26719.793 -145504.062   -1501.475  -1501.475   -860.5633   -9111.942 #>             [,7] #> [1,] -15908.3188 #> [2,]  -1501.4753 #> [3,] -15908.3188 #> [4,]  -1501.4753 #> [5,]   -860.5633 #> [6,]  -9111.9416 #> [7,]   -860.5633 #> The matrix above has the following eigen values: #>  -681851.1+0i -215719.7+0i -2322.41+58791.38i -2322.41-58791.38i 25652.63+0i 10560.49+0i -6972.759+0i   # extract results  # regression coefficient vector res$beta #> [1] -4.89245576  0.66107198 -0.02605781  1.76448292  2.96732020 -0.08765997 #> [7] -1.62547064  # check likelihood ll <- ztnegbin()$makeMinusLogLike(y = farmsubmission$TOTAL_SUB, X = X)  -ll(res$beta) #> [1] -17248.11  # number of iterations res$iter #> [1] 19  # working weights head(res$weights) #>          lambda     mixed     mixed      alpha #> [1,] 0.19146528 0.1652019 0.1652019 0.14282635 #> [2,] 0.57006118 0.2302398 0.2302398 0.13334917 #> [3,] 0.07855608 0.0689088 0.0689088 0.06047564 #> [4,] 0.12737147 0.1111206 0.1111206 0.09703553 #> [5,] 0.25529217 0.2162488 0.2162488 0.18398548 #> [6,] 0.28665140 0.2384570 0.2384570 0.19987487  # Compare with optim call  res2 <- estimatePopsize.fit(   y = farmsubmission$TOTAL_SUB, X = X,    method = \"optim\",    priorWeights = 1,    family = ztnegbin(),    start = start,    control = controlMethod() ) #> Warning: Convergence not obtained in 1000 iterations of optim fitting algorithm # extract results  # regression coefficient vector res2$beta #> [1] -4.89281922  0.66108205 -0.02615131  1.76579565  2.96675019 -0.08746264 #> [7] -1.62702288   # check likelihood -ll(res2$beta) #> [1] -17248.11  # number of iterations res2$iter #> function gradient  #>     1290     1290   # optim does not calculated working weights head(res2$weights) #> [1] 1"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":null,"dir":"Reference","previous_headings":"","what":"Single source capture-recapture models — estimatePopsize","title":"Single source capture-recapture models — estimatePopsize","text":"estimatePopsize first fits appropriate (v)glm model estimates full (observed unobserved) population size. types models assumed response vector (.e. dependent variable) corresponds number times given unit observed source. Population size usually estimated Horvitz-Thompson type estimator: \\[\\hat{N} = \\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)} = \\sum_{k=1}^{N_{obs}}\\frac{1}{1-\\mathbb{P}(Y_{k}=0)}\\] \\(I_{k}=I_{Y_{k} > 0}\\) indicator variables, value 1 kth unit observed least 0 otherwise.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single source capture-recapture models — estimatePopsize","text":"","code":"estimatePopsize(   formula,   data,   model = c(\"ztpoisson\", \"ztnegbin\", \"ztgeom\", \"zotpoisson\", \"ztoipoisson\",     \"oiztpoisson\", \"ztHurdlepoisson\", \"Hurdleztpoisson\", \"zotnegbin\", \"ztoinegbin\",     \"oiztnegbin\", \"ztHurdlenegbin\", \"Hurdleztnegbin\", \"zotgeom\", \"ztoigeom\", \"oiztgeom\",     \"ztHurdlegeom\", \"ztHurdlegeom\", \"zelterman\", \"chao\"),   weights = NULL,   subset = NULL,   naAction = NULL,   method = c(\"optim\", \"IRLS\", \"maxLik\"),   popVar = c(\"analytic\", \"bootstrap\", \"noEst\"),   controlMethod = NULL,   controlModel = NULL,   controlPopVar = NULL,   modelFrame = TRUE,   x = FALSE,   y = TRUE,   contrasts = NULL,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single source capture-recapture models — estimatePopsize","text":"formula Formula model fitted, applied \"main\" linear predictor. single response models available. data Data frame object coercible data.frame class containing data regression population size estimation. model Model regression population estimate full description singleRmodels(). weights Optional object priori weights used fitting model. subset logical vector indicating observations used regression population size estimation. evaluated data argument provided call. naAction yet implemented. method Method fitting values currently supported: iteratively reweighted least squares (IRLS) maximum likelihood (optim). popVar method constructing confidence interval either analytic bootstrap. Bootstrap confidence interval type may specified controlPopVar. also third possible value noEst skips population size estimate together. controlMethod list indicating parameters use fitting model may constructed singleRcapture::controlMethod function. information included controlMethod(). controlModel list indicating additional formulas regression (like formula inflation parameter/dispersion parameter) may constructed singleRcapture::controlModel function. information eventually included controlModel(). controlPopVar list indicating parameters use estimating variance population size estimation may constructed singleRcapture::controlPopVar function. information included controlPopVar(). modelFrame, x, y Logical value indicating whether return model matrix, dependent vector model matrix part output. contrasts yet implemented. ... Additional optional arguments passed following functions: stats::model.frame -- creating data frame information model specified \"main\" formula. stats::model.matrix -- creating model matrix (lm matrix). estimatePopsize.fit -- possibly picking starting points zero truncated poisson regression.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single source capture-recapture models — estimatePopsize","text":"Returns object class c(\"singleR\", \"glm\", \"lm\") containing: y -- Vector dependent variable specified function call. X -- Model matrix specified function call. formula -- list formula provided call additional formulas specified controlModel. call -- Call matching original input. coefficients -- vector fitted coefficients regression. control -- list control parameters controlMethod controlModel, controlPopVar included populationSize. model -- Model estimation population size regression built, object class family. deviance -- Deviance model. priorWeights -- Prior weight provided call. weights -- IRLS method estimation chosen weights returned IRLS, otherwise priorWeights. residuals -- Vector raw residuals. logL -- Logarithm likelihood obtained final iteration. iter -- Numbers iterations performed fitting stats::optim used number call loglikelihhod function. dfResiduals -- Residual degrees freedom. dfNull -- Null degrees freedom. fittValues -- Data frame fitted values mu (expected value) lambda (Poisson parameter). populationSize -- list containing information population size estimate. modelFrame -- Model frame specified call. linearPredictors -- Vector fitted linear predictors. trcount -- Number truncated observations. sizeObserved -- Number observations original model frame. terms -- terms attribute model frame used. contrasts -- contrasts specified function call. naAction -- naAction used. -- list indicating observations used regression/population size estimation. fittingLog -- log fitting information \"IRLS\" fitting specified controlMethod.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Single source capture-recapture models — estimatePopsize","text":"generalized linear model characterised equation \\[\\boldsymbol{\\eta}=\\boldsymbol{X}\\boldsymbol{\\beta}\\] \\(\\boldsymbol{X}\\) (lm) model matrix. vector generalized linear model similarly characterised equations \\[\\boldsymbol{\\eta}_{k}=\\boldsymbol{X}_{k}\\boldsymbol{\\beta}_{k}\\] \\(\\boldsymbol{X}_{k}\\) (lm) model matrix constructed appropriate formula (specified controlModel parameter). \\(\\boldsymbol{\\eta}\\) vector constructed : \\[\\boldsymbol{\\eta}=\\begin{pmatrix}\\boldsymbol{\\eta}_{1}^{T} & \\boldsymbol{\\eta}_{2}^{T} & \\dotso & \\boldsymbol{\\eta}_{p}^{T}\\end{pmatrix}^{T}\\] cases models package (vlm) model matrix constructed block matrix: \\[\\boldsymbol{X}_{vlm}= \\begin{pmatrix} \\boldsymbol{X}_{1} & \\boldsymbol{0} &\\dotso &\\boldsymbol{0}\\cr \\boldsymbol{0} & \\boldsymbol{X}_{2} &\\dotso &\\boldsymbol{0}\\cr \\vdots & \\vdots & \\ddots & \\vdots\\cr \\boldsymbol{0} & \\boldsymbol{0} &\\dotso &\\boldsymbol{X}_{p} \\end{pmatrix}\\] differs convention VGAM package (consider special cases vglm models) just convention affect model, convention taken makes fitting IRLS (explanation algorithm estimatePopsize.fit()) algorithm easier. (constraints matrixes vglm match ones implicitly use vglm model matrix differs respect order kronecker multiplication X constraints.) package use observed likelihood fit regression models. mentioned aboce usually population size estimation done via: \\[\\hat{N} = \\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)} = \\sum_{k=1}^{N_{obs}}\\frac{1}{1-\\mathbb{P}(Y_{k}=0)}\\] \\(I_{k}=I_{Y_{k} > 0}\\) indicator variables, value 1 k'th unit observed least 0 otherwise. \\(\\mathbb{P}(Y_{k}>0)\\) estimated maximum likelihood. following assumptions usually present using method estimation described : specified regression model correct. entails linear relationship independent variables dependent ones dependent variable generated appropriate distribution. unobserved heterogeneity. assumption broken possible (admittedly imperfect) workarounds see details singleRmodels(). population size constant relevant time frame. Depending confidence interval construction (asymptotic) normality \\(\\hat{N}\\) statistic assumed. two ways estimating variance estimate \\(\\hat{N}\\), first \"analytic\" usually done application law total variance \\(\\hat{N}\\): \\[\\text{var}(\\hat{N})=\\mathbb{E}\\left(\\text{var} \\left(\\hat{N}|I_{1},\\dots,I_{n}\\right)\\right)+ \\text{var}\\left(\\mathbb{E}(\\hat{N}|I_{1},\\dots,I_{n})\\right)\\] \\(\\delta\\) method \\(\\hat{N}|I_{1},\\dotso I_{N}\\): \\[\\mathbb{E}\\left(\\text{var} \\left(\\hat{N}|I_{1},\\dots,I_{n}\\right)\\right)= \\left.\\left(\\frac{\\partial(N|I_1,...,I_N)}{\\partial\\boldsymbol{\\beta}}\\right)^{T} \\text{cov}\\left(\\boldsymbol{\\beta}\\right) \\left(\\frac{\\partial(N|I_1,...,I_N)}{\\partial\\boldsymbol{\\beta}}\\right) \\right|_{\\boldsymbol{\\beta}=\\hat{\\boldsymbol{\\beta}}}\\] \\(\\text{var}\\left(\\mathbb{E}(\\hat{N}|I_{1},\\dots,I_{n})\\right)\\) term may derived analytically (assume independence observations) since \\(\\hat{N}|I_{1},\\dots,I_{n}\\) just constant. general gives us: \\[ \\begin{aligned} \\text{var}\\left(\\mathbb{E}(\\hat{N}|I_{1},\\dots,I_{n})\\right)&= \\text{var}\\left(\\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)}\\right)\\cr &=\\sum_{k=1}^{N}\\text{var}\\left(\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)}\\right)\\cr &=\\sum_{k=1}^{N}\\frac{1}{\\mathbb{P}(Y_{k}>0)^{2}}\\text{var}(I_{k})\\cr &=\\sum_{k=1}^{N}\\frac{1}{\\mathbb{P}(Y_{k}>0)^{2}}\\mathbb{P}(Y_{k}>0)(1-\\mathbb{P}(Y_{k}>0))\\cr &=\\sum_{k=1}^{N}\\frac{1}{\\mathbb{P}(Y_{k}>0)}(1-\\mathbb{P}(Y_{k}>0))\\cr &\\approx\\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)^{2}}(1-\\mathbb{P}(Y_{k}>0))\\cr &=\\sum_{k=1}^{N_{obs}}\\frac{1-\\mathbb{P}(Y_{k}>0)}{\\mathbb{P}(Y_{k}>0)^{2}} \\end{aligned} \\] approximation 6th line appears 5th line sum units, includes unobserved units, since \\(I_{k}\\) independent \\(I_{k}\\sim b(\\mathbb{P}(Y_{k}>0))\\) 6th line unbiased estimator 5th line. method estimating variance \"bootstrap\", since \\(N_{obs}=\\sum_{k=1}^{N}I_{k}\\) also random variable bootstrap simple just drawing \\(N_{obs}\\) units data replacement just computing \\(\\hat{N}\\). Method described refered literature \"nonparametric\" bootstrap (see controlPopVar()), due ignoring variability observed sample size likely underestimate variance. sophisticated bootstrap procedure may described follows: Compute probability distribution : \\[\\frac{\\hat{\\boldsymbol{f}}_{0}}{\\hat{N}}, \\frac{\\boldsymbol{f}_{1}}{\\hat{N}}, \\dotso, \\frac{\\boldsymbol{f}_{\\max{y}}}{\\hat{N}}\\] \\(\\boldsymbol{f}_{n}\\) denotes observed marginal frequency units observed exactly n times, round quantitites nearest integer necessary. Draw \\(\\hat{N}\\) units distribution (\\(\\hat{N}\\) integer draw \\(\\lfloor\\hat{N}\\rfloor + b(\\hat{N}-\\lfloor\\hat{N}\\rfloor)\\)). Truncated units \\(y=0\\). covariates draw original data replacement uniform distribution. example unit drawn new data \\(y=2\\) choose one covariate vectors original data associated unit observed 2 times. Regress \\(\\boldsymbol{y}_{new}\\) \\(\\boldsymbol{X}_{vlm new}\\) obtain \\(\\hat{\\boldsymbol{\\beta}}_{new}\\), starting point \\(\\hat{\\boldsymbol{\\beta}}\\) make slightly faster, use compute \\(\\hat{N}_{new}\\). Repeat 2-5 unit least B statistics obtained. Compute confidence intervals based alpha confType specified controlPopVar(). procedure known literature \"semiparametric\" bootstrap necessary assume correct estimate \\(\\hat{N}\\) order use type bootstrap. Lastly \"paramteric\" bootstrap assume probabilistic model used obtain \\(\\hat{N}\\) correct bootstrap procedure may described : Draw \\(\\hat{N}\\) covariate information vectors replacement data according probability distribution \\[\\frac{\\lfloor N_{k}\\rfloor + M_{k}}{\\lfloor\\hat{N}\\rfloor}\\] \\(M_{k}\\sim b(N_{k}-\\lfloor N_{k}\\rfloor)\\), \\(N_{k}\\) contribution kth unit .e. \\(\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)}\\) \\(\\lfloor \\cdot\\rfloor\\) floor function. Determine \\(\\boldsymbol{\\eta}\\) matrix using estimate \\(\\hat{\\boldsymbol{\\beta}}\\). Generate \\(\\boldsymbol{y}\\) (dependent variable) vector using \\(\\boldsymbol{\\eta}\\) probability mass function associated chosen model. Truncated units \\(y=0\\) construct \\(\\boldsymbol{y}_{new}\\) \\(\\boldsymbol{X}_{vlm new}\\). Regress \\(\\boldsymbol{y}_{new}\\) \\(\\boldsymbol{X}_{vlm new}\\) obtain \\(\\hat{\\boldsymbol{\\beta}}_{new}\\) use compute \\(\\hat{N}_{new}\\). Repeat 1-5 unit least B statistics obtained. Compute confidence intervals based alpha confType specified controlPopVar() also worth noting \"analytic\" method estimatePopsize uses \"standard\" covariance matrix estimation. possible improper covariance matrix estimate part estimation assumptions violated. cases post-hoc procedures implemented package address issue. Lastly confidence intervals \\(\\hat{N}\\) computed (analytic case) either assuming follows normal distribution variable \\(\\ln(N-\\hat{N})\\) follows normal distribution. estimates may found using either summary.singleR method popSizeEst.singleR function. labelled normal logNormal respectively.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Single source capture-recapture models — estimatePopsize","text":"General single source capture recapture literature: Zelterman, Daniel (1988). ‘Robust estimation truncated discrete distributions application capture-recapture experiments’. : Journal statistical planning inference 18.2, pp. 225–237. Heijden, Peter GM van der et al. (2003). ‘Point interval estimation population size using truncated Poisson regression model’. : Statistical Modelling 3.4, pp. 305–322. doi: 10.1191/1471082X03st057oa. Cruyff, Maarten J. L. F. Peter G. M. van der Heijden (2008). ‘Point Interval Estimation Population Size Using Zero-Truncated Negative Binomial Regression Model’. : Biometrical Journal 50.6, pp. 1035–1050. doi: 10.1002/bimj.200810455 Böhning, Dankmar Peter G. M. van der Heijden (2009). ‘covariate adjustment zero-truncated approaches estimating size hidden elusive populations’. : Annals Applied Statistics 3.2, pp. 595–610. doi: 10.1214/08-AOAS214. Böhning, Dankmar, Alberto Vidal-Diez et al. (2013). ‘Generalization Chao’s Estimator Covariate Information’. : Biometrics 69.4, pp. 1033– 1042. doi: 10.1111/biom.12082 Böhning, Dankmar Peter G. M. van der Heijden (2019). ‘identity zero-truncated, one-inflated likelihood zero-one-truncated likelihood general count densities application drink-driving Britain’. : Annals Applied Statistics 13.2, pp. 1198–1211. doi: 10.1214/18-AOAS1232. Navaratna WC, Del Rio Vilas VJ, Böhning D. Extending Zelterman's approach robust estimation population size zero-truncated clustered Data. Biom J. 2008 Aug;50(4):584-96. doi: 10.1002/bimj.200710441. Böhning D. equivalence one-inflated zero-truncated zero-truncated one-inflated count data likelihoods. Biom J. 2022 Aug 15. doi: 10.1002/bimj.202100343. Böhning, D., Friedl, H. Population size estimation based upon zero-truncated, one-inflated sparse count data. Stat Methods Appl 30, 1197–1217 (2021). doi: 10.1007/s10260-021-00556-8 Bootstrap: Zwane, PGM EN Van der Heijden, Implementing parametric bootstrap capture-recapture models continuous covariates 2003 Statistics & probability letters 65.2 pp 121-125 Norris, James L Pollock, Kenneth H Including model uncertainty estimating variances multiple capture studies 1996 Environmental Ecological Statistics 3.3 pp 235-244 Vector generalised linear models: Yee, T. W. (2015). Vector Generalized Linear Additive Models: Implementation R. New York, USA: Springer. ISBN 978-1-4939-2817-0.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Single source capture-recapture models — estimatePopsize","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Single source capture-recapture models — estimatePopsize","text":"","code":"# Model from 2003 publication  # Point and interval estimation of the # population size using the truncated Poisson regression mode # Heijden, Peter GM van der et al. (2003) model <- estimatePopsize(    formula = capture ~ gender + age + nation,     data = netherlandsimmigrant,     model = ztpoisson ) summary(model) #>  #> Call: #> estimatePopsize(formula = capture ~ gender + age + nation, data = netherlandsimmigrant,  #>     model = ztpoisson) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.486442 -0.486442 -0.298080  0.002093 -0.209444 13.910844  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.3411     0.2149  -6.241 4.35e-10 *** #> gendermale             0.3972     0.1630   2.436 0.014832 *   #> age>40yrs             -0.9746     0.4082  -2.387 0.016972 *   #> nationAsia            -1.0926     0.3016  -3.622 0.000292 *** #> nationNorth Africa     0.1900     0.1940   0.979 0.327398     #> nationRest of Africa  -0.9106     0.3008  -3.027 0.002468 **  #> nationSurinam         -2.3364     1.0136  -2.305 0.021159 *   #> nationTurkey          -1.6754     0.6028  -2.779 0.005445 **  #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 1712.901 #> BIC: 1757.213 #> Residual deviance: 1128.553 #>  #> Log-likelihood: -848.4504 on 1872 Degrees of freedom  #> Number of calls to log-likelihood function: 94 #> ----------------------- #> Population size estimation results:  #> Point estimate 12690.35 #> Observed proportion: 14.8% (N obs = 1880) #> Std. Error 2808.169 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      7186.444   18194.26 #> logNormal   8431.275   19718.32 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal     10.332928   26.16037 #> logNormal   9.534281   22.29793 # Graphical presentation of model fit plot(model, \"rootogram\")  # Statistical test # see documentation for summary.singleRmargin summary(marginalFreq(model), df = 1, \"group\") #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           50.06  1 1.5e-12 #> G-test                     34.31  1 4.7e-09 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been grouped  #> Names of cells used in calculating test(s) statistic: 1 2 3    modelSingleRcapture <- estimatePopsize(formula = TOTAL_SUB ~ .,                                         data = farmsubmission,                                         model = ztnegbin,                                         method = \"IRLS\") # comparison with VGAM package, VGAM uses slightly different parametrisation # so we use negloglink instead of loglink for size parameter # i.e 1 / dispersion parameter if (require(VGAM)) {   modelVGAM <- vglm(      formula = TOTAL_SUB ~ .,       family = posnegbinomial(lsize = negloglink()),       data = farmsubmission   )   summary(modelVGAM) } #> Loading required package: VGAM #> Loading required package: stats4 #> Loading required package: splines #>  #> Call: #> vglm(formula = TOTAL_SUB ~ ., family = posnegbinomial(lsize = negloglink()),  #>     data = farmsubmission) #>  #> Coefficients:  #>               Estimate Std. Error z value Pr(>|z|)     #> (Intercept):1 -3.17076    0.26586 -11.926  < 2e-16 *** #> (Intercept):2  0.58194    0.07331   7.938 2.05e-15 *** #> log_size       0.63942    0.01750  36.535  < 2e-16 *** #> log_distance  -0.07985    0.02271  -3.515 0.000439 *** #> C_TYPEDairy    0.65965    0.03339  19.756  < 2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> Names of linear predictors: loglink(munb), negloglink(size) #>  #> Log-likelihood: -17264.37 on 24067 degrees of freedom #>  #> Number of Fisher scoring iterations: 8  #>  #> No Hauck-Donner effect found in any of the estimates #>  # Results are comparable summary(modelSingleRcapture) #>  #> Call: #> estimatePopsize(formula = TOTAL_SUB ~ ., data = farmsubmission,  #>     model = ztnegbin, method = \"IRLS\") #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.713383 -0.336369 -0.142528  0.000002  0.147598  7.014713  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>              Estimate Std. Error z value  P(>|z|)     #> (Intercept)  -3.17075    0.25944 -12.221  < 2e-16 *** #> log_size      0.63942    0.01771  36.108  < 2e-16 *** #> log_distance -0.07985    0.02228  -3.583 0.000339 *** #> C_TYPEDairy   0.65965    0.03412  19.332  < 2e-16 *** #> ----------------------- #> For linear predictors associated with: alpha  #>             Estimate Std. Error z value  P(>|z|)     #> (Intercept)  0.58193    0.07297   7.975 1.52e-15 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 34538.73 #> BIC: 34575.71 #> Residual deviance: 16514.42 #>  #> Log-likelihood: -17264.37 on 24067 Degrees of freedom  #> Number of iterations: 10 #> ----------------------- #> Population size estimation results:  #> Point estimate 41020.34 #> Observed proportion: 29.3% (N obs = 12036) #> Std. Error 1887.714 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      37320.49   44720.19 #> logNormal   37550.34   44962.26 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      26.91402   32.25038 #> logNormal   26.76912   32.05297 summary(marginalFreq(modelSingleRcapture)) #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           30.91 26    0.23 #> G-test                     19.14 26    0.83 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been dropped  #> Names of cells used in calculating test(s) statistic: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19   # More advanced call that specifies additional formula and shows # in depth information about fitting procedure pseudoHurdleModel <- estimatePopsize(     formula = capture ~ nation + age,     data = netherlandsimmigrant,     model = Hurdleztgeom,     method = \"IRLS\",     controlMethod = controlMethod(verbose = 5),     controlModel = controlModel(piFormula = ~ gender) ) #> Iteration number 1 log-likelihood: -884.52524 #> Parameter vector:  -0.185410445 -0.263880409  0.056306931 -0.231199930 -0.339016183 -0.327635519 -0.196135239  0.670848267 -0.288900531 #> log-likelihood reduction:  129.2577 #> Value of gradient at current step: #>  -109.6131688  -27.3297089  -33.7540534  -21.6155174   -7.4027633  -10.1007372  -10.5519638   27.6542735   15.0062187 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.50748707 #> ---- #> Iteration number 2 log-likelihood: -838.29471 #> Parameter vector:  -0.78894466 -0.49414892  0.12654544 -0.41936921 -0.67177153 -0.62118201 -0.36628038  0.21382239 -0.49833888 #> log-likelihood reduction:  46.230532 #> Value of gradient at current step: #>   -9.2986457  -8.4448514  11.9660050  -5.4261467  -3.1887498  -3.5831268  -3.4007904 -15.7933504 -14.6132321 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.60353421 #> ---- #> Iteration number 3 log-likelihood: -827.3607 #> Parameter vector:  -1.21931395 -0.63137590  0.16239443 -0.50905713 -1.00036608 -0.83501186 -0.49385975 -0.50199082 -0.52839008 #> log-likelihood reduction:  10.934004 #> Value of gradient at current step: #>   4.530848334 -0.706818772  6.094992729  0.033497974 -0.920014881 -0.578730826 -0.448704228 -5.120996903 -4.375742516 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.71581321 #> ---- #> Iteration number 4 log-likelihood: -827.02171 #> Parameter vector:  -1.28115433 -0.65547993  0.16416111 -0.51727106 -1.18177463 -0.89567550 -0.52235421 -0.63935485 -0.52639483 #> log-likelihood reduction:  0.33899271 #> Value of gradient at current step: #>  -0.0798924040 -0.0146700645  0.1065046364  0.0063805055 -0.1495363455 -0.0225332569 -0.0157025920  0.0209555100  0.0109299318 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.18140855 #> ---- #> Iteration number 5 log-likelihood: -827.01869 #> Parameter vector:  -1.28171634 -0.65569704  0.16448478 -0.51702657 -1.21974330 -0.89780515 -0.52284164 -0.64023545 -0.52641227 #> log-likelihood reduction:  0.003018031 #> Value of gradient at current step: #>  -0.0079047559230 -0.0000943199988  0.0001645958923 -0.0000297997400 -0.0077602958183  0.0000021090011  0.0030065203454  0.0025910919142  0.0020212799526 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.037968669 #> ---- #> Iteration number 6 log-likelihood: -827.01868 #> Parameter vector:  -1.28177894 -0.65568567  0.16449545 -0.51701624 -1.22185057 -0.89779665 -0.52264205 -0.64032940 -0.52640247 #> log-likelihood reduction:  0.0000088199182 #> Value of gradient at current step: #>  -0.0000833660078 -0.0000339029369  0.0000351898233  0.0000184580442 -0.0001780533740  0.0000048832952  0.0002239816838  0.0000077136953  0.0000060320685 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.002107269 #> ---- #> Iteration number 7 log-likelihood: -827.01868 #> Parameter vector:  -1.28177963 -0.65568706  0.16449478 -0.51701663 -1.22190033 -0.89779718 -0.52262886 -0.64033169 -0.52640214 #> log-likelihood reduction:  0.0000000061005494 #> Value of gradient at current step: #>   0.0000004043896435 -0.0000019897800376  0.0000008423328897  0.0000011366602957 -0.0000045718813156  0.0000002750068767  0.0000076532956870  0.0000000051263633  0.0000000041137567 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.000049760582 #> ---- #> Value of analytically computed hessian at fitted regression coefficients: #>              [,1]       [,2]       [,3]       [,4]       [,5]       [,6] #>  [1,] -600.810969 -45.353941 -437.80190 -46.358405 -3.5886060 -9.9838241 #>  [2,]  -45.353941 -45.353941    0.00000   0.000000  0.0000000  0.0000000 #>  [3,] -437.801899   0.000000 -437.80190   0.000000  0.0000000  0.0000000 #>  [4,]  -46.358405   0.000000    0.00000 -46.358405  0.0000000  0.0000000 #>  [5,]   -3.588606   0.000000    0.00000   0.000000 -3.5886060  0.0000000 #>  [6,]   -9.983824   0.000000    0.00000   0.000000  0.0000000 -9.9838241 #>  [7,]  -17.738645  -1.130751  -11.34144  -1.395262 -0.2874866 -0.4969714 #>  [8,]  328.022452  23.801162  241.35686  24.376925  1.8706743  5.1505623 #>  [9,]  280.048800  20.260809  211.90055  19.741967  1.4621314  4.6637716 #>              [,7]        [,8]        [,9] #>  [1,] -17.7386453  328.022452  280.048800 #>  [2,]  -1.1307513   23.801162   20.260809 #>  [3,] -11.3414411  241.356857  211.900547 #>  [4,]  -1.3952616   24.376925   19.741967 #>  [5,]  -0.2874866    1.870674    1.462131 #>  [6,]  -0.4969714    5.150562    4.663772 #>  [7,] -17.7386453    9.477659    8.492251 #>  [8,]   9.4776585 -197.098079 -168.419176 #>  [9,]   8.4922514 -168.419176 -168.419176 #> The matrix above has the following eigen values: #>  -3.276146 -6.94172 -9.334715 -16.36556 -17.94965 -34.01221 -45.88974 -112.7184 -1280.665  summary(pseudoHurdleModel) #>  #> Call: #> estimatePopsize(formula = capture ~ nation + age, data = netherlandsimmigrant,  #>     model = Hurdleztgeom, method = \"IRLS\", controlMethod = controlMethod(verbose = 5),  #>     controlModel = controlModel(piFormula = ~gender)) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.428461 -0.428461 -0.288574  0.004918 -0.181672 13.696148  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.2818     0.1855  -6.909 4.86e-12 *** #> nationAsia            -0.6557     0.1993  -3.289  0.00100 **  #> nationNorth Africa     0.1645     0.1416   1.162  0.24542     #> nationRest of Africa  -0.5170     0.1978  -2.614  0.00894 **  #> nationSurinam         -1.2219     0.5442  -2.245  0.02475 *   #> nationTurkey          -0.8978     0.3436  -2.613  0.00897 **  #> age>40yrs             -0.5226     0.2415  -2.164  0.03045 *   #> ----------------------- #> For linear predictors associated with: pi  #>             Estimate Std. Error z value P(>|z|)    #> (Intercept)  -0.6403     0.2942  -2.177 0.02950 *  #> gendermale   -0.5264     0.2043  -2.577 0.00996 ** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 1672.037 #> BIC: 1721.889 #> Residual deviance: 1492.301 #>  #> Log-likelihood: -827.0187 on 3751 Degrees of freedom  #> Number of iterations: 7 #> ----------------------- #> Population size estimation results:  #> Point estimate 6446.833 #> Observed proportion: 29.2% (N obs = 1880) #> Std. Error 544.5787 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      5379.479   7514.188 #> logNormal   5498.016   7644.476 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      25.01934   34.94763 #> logNormal   24.59292   34.19415 # Assessing model fit plot(pseudoHurdleModel, \"rootogram\")  summary(marginalFreq(pseudoHurdleModel), \"group\", df = 1) #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test            1.89  1    0.17 #> G-test                      2.13  1    0.14 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been grouped  #> Names of cells used in calculating test(s) statistic: 1 2 3 4     # A advanced input with additional information for fitting procedure and # additional formula specification. Model <- estimatePopsize(    formula = TOTAL_SUB ~ ., data = farmsubmission,     model = oiztgeom,     method = \"IRLS\",     controlMethod = controlMethod(stepsize = .05,                                   momentumFactor = 1.1,                                   epsilon = 1e-12,                                   silent = TRUE),    controlModel = controlModel(omegaFormula = ~ .) ) summary(marginalFreq(Model), df = 18 - length(Model$coefficients) - 1) #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           55.23  9 1.1e-08 #> G-test                     23.68  9 4.8e-03 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been dropped  #> Names of cells used in calculating test(s) statistic: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  summary(Model) #>  #> Call: #> estimatePopsize(formula = TOTAL_SUB ~ ., data = farmsubmission,  #>     model = oiztgeom, method = \"IRLS\", controlMethod = controlMethod(stepsize = 0.05,  #>         momentumFactor = 1.1, epsilon = 1e-12, silent = TRUE),  #>     controlModel = controlModel(omegaFormula = ~.)) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.899741 -0.644342 -0.443351  0.005511  0.294785 20.721657  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>              Estimate Std. Error z value P(>|z|)     #> (Intercept)  -2.87524    0.26226 -10.963 < 2e-16 *** #> log_size      0.63041    0.01929  32.683 < 2e-16 *** #> log_distance -0.06276    0.02232  -2.812 0.00492 **  #> C_TYPEDairy   0.50371    0.04280  11.768 < 2e-16 *** #> ----------------------- #> For linear predictors associated with: omega  #>              Estimate Std. Error z value P(>|z|)    #> (Intercept)   -7.2829     2.9418  -2.476 0.01330 *  #> log_size       0.5018     0.1604   3.129 0.00176 ** #> log_distance   0.1824     0.2397   0.761 0.44674    #> C_TYPEDairy   -1.5773     0.6442  -2.448 0.01435 *  #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 34581.33 #> BIC: 34640.5 #> Residual deviance: 12326.66 #>  #> Log-likelihood: -17282.67 on 24064 Degrees of freedom  #> Number of iterations: 405 #> ----------------------- #> Population size estimation results:  #> Point estimate 27324.68 #> Observed proportion: 44% (N obs = 12036) #> Std. Error 976.6463 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      25410.49   29238.87 #> logNormal   25527.19   29361.66 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      41.16438   47.36627 #> logNormal   40.99224   47.14972"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/farmsubmission.html","id":null,"dir":"Reference","previous_headings":"","what":"British farm submissions data — farmsubmission","title":"British farm submissions data — farmsubmission","text":"Data British animal farms submissions AHVLA. British farms able submit samples AHVLA cause death animal determined private veterinary surgeon decides submit , unless notifiable disease suspected submission required. data set contains information farms. submissions farms included data frame carcasses also blood samples etc.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/farmsubmission.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"British farm submissions data — farmsubmission","text":"","code":"data(\"farmsubmission\")"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/farmsubmission.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"British farm submissions data — farmsubmission","text":"Data frame 12,036 rows 4 columns. TOTAL_SUB Number submissions animal material. log_size Numerical value equal logarithm size farm. log_distance Numerical value equal logarith distance nearest AHVLA center. C_TYPE Factor describing type activity farm animals used . Either Dairy Beef","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/farmsubmission.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"British farm submissions data — farmsubmission","text":"data set description provided publication: Böhning, D., Vidal Diez, ., Lerdsuwansri, R., Viwatwongkasem, C., Arnold, M. (2013). \"generalization Chao's estimator covariate information\". Biometrics, 69(4), 1033-1042. doi:10.1111/biom.12082","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/hatvalues.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Diagonal elements of the projection matrix — hatvalues.singleR","title":"Diagonal elements of the projection matrix — hatvalues.singleR","text":"method singleR class extracting diagonal elementrs projection matrix.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/hatvalues.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Diagonal elements of the projection matrix — hatvalues.singleR","text":"","code":"# S3 method for singleR hatvalues(model, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/hatvalues.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Diagonal elements of the projection matrix — hatvalues.singleR","text":"model Object singleR class. ... Currently nothing.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/hatvalues.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Diagonal elements of the projection matrix — hatvalues.singleR","text":"matrix n rows p columns n number observations data k number regression parameters.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/hatvalues.singleR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Diagonal elements of the projection matrix — hatvalues.singleR","text":"Since singleRcapture supports regular glm's also vglm's hatvalues returns matrix number columns corresponding number linear predictors model, kth column corresponds elements diagonal projection matrix associated kth linear predictor. glm's \\[\\boldsymbol{W}^{\\frac{1}{2}}\\boldsymbol{X}\\left(\\boldsymbol{X}^{T}\\boldsymbol{W}\\boldsymbol{X}\\right)^{-1}\\boldsymbol{X}^{T}\\boldsymbol{W}^{\\frac{1}{2}}\\] \\(\\boldsymbol{W}=\\mathbb{E}\\left(\\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\boldsymbol{\\eta}^{T}\\partial\\boldsymbol{\\eta}}\\right)\\right)\\) \\(\\boldsymbol{X}\\) model (lm) matrix. vglm's present package instead : \\[\\boldsymbol{X}_{vlm}\\left(\\boldsymbol{X}_{vlm}^{T}\\boldsymbol{W}\\boldsymbol{X}_{vlm}\\right)^{-1}\\boldsymbol{X}_{vlm}^{T}\\boldsymbol{W}\\] \\[ \\boldsymbol{W} = \\mathbb{E}\\left(\\begin{bmatrix} \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{1}^{T}\\partial\\eta_{1}}\\right) & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{1}^{T}\\partial\\eta_{2}}\\right) & \\dotso & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{1}^{T}\\partial\\eta_{p}}\\right)\\cr \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{2}^{T}\\partial\\eta_{1}}\\right) & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{2}^{T}\\partial\\eta_{2}}\\right) & \\dotso & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{2}^{T}\\partial\\eta_{p}}\\right)\\cr \\vdots & \\vdots & \\ddots & \\vdots\\cr \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{p}^{T}\\partial\\eta_{1}}\\right) & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{p}^{T}\\partial\\eta_{2}}\\right) & \\dotso & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{p}^{T}\\partial\\eta_{p}}\\right) \\end{bmatrix}\\right)\\] block matrix constructed taking expected  value diagonal matrixes corresponding second derivatives respect linear predictor (mixed derivatives) \\(\\boldsymbol{X}_{vlm}\\) model (vlm) matrix constructed using \"main\" formula additional formulas specified controlModel.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":null,"dir":"Reference","previous_headings":"","what":"Observed and fitted marginal Frequencies — marginalFreq","title":"Observed and fitted marginal Frequencies — marginalFreq","text":"function given fitted singleR class object computed marginal frequencies sum probability density functions unit data point .e. kth element marginal frequency table given \\(\\sum_{j=1}^{N_{obs}}\\mathbb{P}(Y_{j}=k| \\eta_{j})\\). k=0 (specified call) computed \\(\\hat{N}-N_{obs}\\) \\(\\boldsymbol{f}_{0}\\) assumed unobserved part studied population. frequencies useful diagnostics count data regression, assessment fit.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Observed and fitted marginal Frequencies — marginalFreq","text":"","code":"marginalFreq(   object,   includeones = TRUE,   includezeros = TRUE,   onecount = NULL,   range )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Observed and fitted marginal Frequencies — marginalFreq","text":"object Object singleR class. includeones Logical value indicating whether include estimated number zero counts. includezeros Logical value indicating whether include one counts zero-one truncated models. onecount numeric value indicating number one counts null trcount object assumed number one counts. range Optional argument specifying range selected Y values.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Observed and fitted marginal Frequencies — marginalFreq","text":"list observed name fitted model family degrees freedom observed fitted marginal frequencies.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Observed and fitted marginal Frequencies — marginalFreq","text":"Piotr Chlebicki","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/netherlandsimmigrant.html","id":null,"dir":"Reference","previous_headings":"","what":"Data on immigration in Netherlands — netherlandsimmigrant","title":"Data on immigration in Netherlands — netherlandsimmigrant","text":"data set contains information immigrants four cities (Amsterdam, Rotterdam, Hague Utrecht) Netherlands staying country illegally 1995 appeared police records year.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/netherlandsimmigrant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data on immigration in Netherlands — netherlandsimmigrant","text":"","code":"data(\"netherlandsimmigrant\")"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/netherlandsimmigrant.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data on immigration in Netherlands — netherlandsimmigrant","text":"Data frame 1,880 rows 5 columns. capture Number times person captured police. gender Factor describing gender apprehended person. age Factor describing age apprehended person. Either bellow 40 years old. reason Factor describing reason apprehended police either illegal stay Netherlands reasons. nation Factor nation origin captured person. 6 levels variable: \"American Australia\",   \"Asia\", \"North Africa\", \"Rest Africa\", \"Surinam\", \"Turkey\".","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/netherlandsimmigrant.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Data on immigration in Netherlands — netherlandsimmigrant","text":"data set description provided publication: van Der Heijden, P. G., Bustami, R., Cruyff, M. J., Engbersen, G., Van Houwelingen, H. C. (2003). Point interval estimation population size using truncated Poisson regression model. Statistical Modelling, 3(4), 305-322. doi:10.1191/1471082X03st057oa","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Diagnostic plots for regression and population size estimation. — plot.singleR","title":"Diagnostic plots for regression and population size estimation. — plot.singleR","text":"Simple diagnostic plots singleR class objects.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Diagnostic plots for regression and population size estimation. — plot.singleR","text":"","code":"# S3 method for singleR plot(   x,   plotType = c(\"qq\", \"marginal\", \"fitresid\", \"bootHist\", \"rootogram\", \"dfpopContr\",     \"dfpopBox\", \"scaleLoc\", \"cooks\", \"hatplot\", \"strata\"),   confIntStrata = c(\"normal\", \"logNormal\"),   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Diagnostic plots for regression and population size estimation. — plot.singleR","text":"x Object singleR class. plotType Character parameter specifying type plot made. following list presents briefly explains possible type plots: qq -- quantile-quantile plot pearson residuals (standardised pearson residuals available model) .e. empirical quantiles residuals plotted theoretical quantiles standard distribution. marginal -- plot made matplot fitted observed marginal frequencies labels. fitresid -- Plot fitted linear predictors (standardised) pearson residuals. bootHist -- Simple histogram statistics obtained bootstraping (one performed statistics saved). rootogram -- Rootogram, full explanation see: Kleiber Zeileis Visualizing Count Data Regressions Using Rootograms (2016), short barplot height square root observed marginal frequencies adjusted difference square root observed fitted marginal frequencies connected line representing fitted marginal frequencies. less difference 0 line beginning bar accurate fitt produced model. dfpopContr -- Plot dfpopsize unit contribution. plot y = x line .e. deletion effect removing unit model effect regression coefficients. away observation line influential . dfpopBox -- Boxplot dfpopsize getting general idea distribution \"influence\" unit population size estimate. scaleLoc -- scale - location plot .e. square root absolute values (standardised) pearson residuals linear predictors column linear predictors. cooks -- Plot cooks distance detecting influential observations. hatplot -- Plot hat values linear predictor detecting influential observations. strata -- Plot confidence invervals point estimates stratas provided ... argument confIntStrata Confidence interval type use strata plot. Currently supported values \"normal\" \"logNormal\". ... Additional optional arguments passed following functions: plotType = \"bootHist\" graphics::hist -- x, main, xlab, ylab parameters fixed. plotType = \"rootogram\" graphics::barplot -- height, offset, ylab, xlab, ylim parameters fixed. graphics::lines -- x, y, pch, type, lwd, col parameters fixed. plotType = \"dfpopContr\" dfpopsize -- model, observedPop parameters fixed. plot.default -- x, y, xlab, main parameters fixed. plotType = \"dfpopBox\" dfpopsize -- model, observedPop parameters fixed. graphics::boxplot -- x, ylab, main parameters fixed. plotType = \"scaleLoc\" plot.default -- x, y, xlab, ylab, main, sub parameters fixed. plotType = \"fitresid\" plot.default -- x, y, xlab, ylab, main, sub parameters fixed. plotType = \"cooks\" plot.default -- x, xlab, ylab, main parameters fixed. plotType = \"hatplot\" hatvalues.singleR plot.default -- x, xlab, ylab, main parameters fixed. plotType = \"strata\" stratifyPopsize.singleR","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Diagnostic plots for regression and population size estimation. — plot.singleR","text":"return value plot made.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Diagnostic plots for regression and population size estimation. — plot.singleR","text":"Piotr Chlebicki","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/popSizeEst.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract population size estimation results. — popSizeEst","title":"Extract population size estimation results. — popSizeEst","text":"extractor function singleR method extracting important information regarding pop size estimate.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/popSizeEst.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract population size estimation results. — popSizeEst","text":"","code":"popSizeEst(object, ...)  # S3 method for singleR popSizeEst(object, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/popSizeEst.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract population size estimation results. — popSizeEst","text":"object Object population size estimates. ... Additional optional arguments, currently used singleR class method.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/popSizeEst.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract population size estimation results. — popSizeEst","text":"object class popSizeEstResults containing population size estimation results.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":null,"dir":"Reference","previous_headings":"","what":"Updating population size estimation results. — redoPopEstimation","title":"Updating population size estimation results. — redoPopEstimation","text":"function applies post-hoc procedures taken (heteroscedastic consistent covariance matrix estimation bias reduction) population size estimation standard error estimation.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Updating population size estimation results. — redoPopEstimation","text":"","code":"redoPopEstimation(object, ...)  # S3 method for singleR redoPopEstimation(object, cov = NULL, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Updating population size estimation results. — redoPopEstimation","text":"object Object update population size estimation results done. ... Additional optional arguments, currently used singleR class method. cov updated covariance matrix estimate.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Updating population size estimation results. — redoPopEstimation","text":"object class popSizeEstResults containing updated population size estimation results.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Updating population size estimation results. — redoPopEstimation","text":"","code":"# Create simple model Model <- estimatePopsize(formula = capture ~ nation + gender,  data = netherlandsimmigrant,  model = ztpoisson,  method = \"IRLS\") # Apply heteroscedasticity consistent covariance matrix estimation require(sandwich) #> Loading required package: sandwich cov <- vcovHC(Model, type = \"HC3\") summary(Model, cov = cov, popSizeEst = redoPopEstimation(Model, cov = cov)) #>  #> Call: #> estimatePopsize(formula = capture ~ nation + gender, data = netherlandsimmigrant,  #>     model = ztpoisson, method = \"IRLS\") #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.479668 -0.479668 -0.351833  0.000449 -0.225717 14.058858  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.3977     0.2553  -5.475 4.37e-08 *** #> nationAsia            -1.0560     0.3940  -2.680  0.00736 **  #> nationNorth Africa     0.2327     0.2399   0.970  0.33200     #> nationRest of Africa  -0.8864     0.3514  -2.523  0.01164 *   #> nationSurinam         -2.3519     1.0273  -2.289  0.02205 *   #> nationTurkey          -1.6845     0.6110  -2.757  0.00583 **  #> gendermale             0.3833     0.2014   1.904  0.05695 .   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 1718.993 #> BIC: 1757.766 #> Residual deviance: 1136.645 #>  #> Log-likelihood: -852.4963 on 1873 Degrees of freedom  #> Number of iterations: 8 #> ----------------------- #> Population size estimation results:  #> Point estimate 11879.92 #> Observed proportion: 15.8% (N obs = 1880) #> Std. Error 2531.196 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      6918.872   16840.98 #> logNormal   8015.862   18177.38 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      11.16325   27.17206 #> logNormal   10.34252   23.45350 # Compare to results with usual covariance matrix estimation summary(Model) #>  #> Call: #> estimatePopsize(formula = capture ~ nation + gender, data = netherlandsimmigrant,  #>     model = ztpoisson, method = \"IRLS\") #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.479668 -0.479668 -0.351833  0.000449 -0.225717 14.058858  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.3977     0.2146  -6.514 7.33e-11 *** #> nationAsia            -1.0560     0.3016  -3.501 0.000464 *** #> nationNorth Africa     0.2327     0.1939   1.200 0.230002     #> nationRest of Africa  -0.8864     0.3009  -2.946 0.003224 **  #> nationSurinam         -2.3519     1.0137  -2.320 0.020337 *   #> nationTurkey          -1.6845     0.6029  -2.794 0.005203 **  #> gendermale             0.3833     0.1630   2.352 0.018686 *   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 1718.993 #> BIC: 1757.766 #> Residual deviance: 1136.645 #>  #> Log-likelihood: -852.4963 on 1873 Degrees of freedom  #> Number of iterations: 8 #> ----------------------- #> Population size estimation results:  #> Point estimate 11879.92 #> Observed proportion: 15.8% (N obs = 1880) #> Std. Error 2448.792 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      7080.380   16679.47 #> logNormal   8111.333   17927.69 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      11.27134   26.55225 #> logNormal   10.48657   23.17745"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":null,"dir":"Reference","previous_headings":"","what":"Family functions in singleRcapture package — chao","title":"Family functions in singleRcapture package — chao","text":"Package singleRcapture utilises various family type functions specify variable parts population size estimation, regression, diagnostics necessary information depends model. functions used model argument estimatePopsize function.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Family functions in singleRcapture package — chao","text":"","code":"chao(...)  Hurdleztgeom(...)  Hurdleztpoisson(...)  oiztgeom(...)  oiztpoisson(...)  zelterman(...)  zotgeom(...)  zotnegbin(nSim = 1000, epsSim = 1e-08, ...)  zotpoisson(...)  ztHurdlegeom(...)  ztHurdlepoisson(...)  ztgeom(...)  ztnegbin(nSim = 1000, epsSim = 1e-08, ...)  ztoigeom(...)  ztoipoisson(...)  ztpoisson(...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Family functions in singleRcapture package — chao","text":"... Additional arguments, used now. nSim working weights computed analytically argument specifies maximum number simulations allowed find numerically. epsSim f working weights computed analytically argument specifies precision level finding numerically.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Family functions in singleRcapture package — chao","text":"object class family containing objects: makeMinusLogLike -- factory function creating \\(\\ell(\\boldsymbol{\\beta}), \\frac{\\partial\\ell}{\\partial\\boldsymbol{\\beta}}, \\frac{\\partial^{2}\\ell}{\\partial\\boldsymbol{\\beta}^{T}\\partial\\boldsymbol{\\beta}} \\) functions \\(\\boldsymbol{y}\\) vector \\(\\boldsymbol{X}_{vlm}\\) (just \\(\\boldsymbol{X}\\) applied model single linear predictor) argument deriv possible values 0, 1, 2 provides derivative return 0 just minus log-likelihood. linkfun, linkinv -- link function inverse. mu.eta, variance -- Functions linear predictors return expected value variance. type argument 2 possible values \"trunc\" \"nontrunc\" specifies whether return \\(\\mathbb{E}(Y|Y>0), \\text{var}(Y|Y>0)\\) \\(\\mathbb{E}(Y), \\text{var}(Y)\\) respectively. link, family -- Character specifying link functions used model internally used name model. valideta, validmu -- now returns true. near future used check whether applied linear predictors valid (.e. transormed elements parameter space subjected inverse link function). funcZ, Wfun -- Functions create pseudo residuals working weights used IRLS algorithm. devResids -- Function given linear predictors prior weights vector response vector returns deviance residuals. family functions functions implemented yet. pointEst, popVar -- Functions given prior weights linear predictors later case also estimation \\(\\text{cov}(\\hat{\\boldsymbol{\\beta}})\\) \\(\\boldsymbol{X_{vlm}}\\) matrix return point estimate population size analytic estimation variance. additional boolean parameter contr former function set true returns contribution unit. etaNames, parNum -- Names number linear predictors. densityFunction -- function given linear predictors returns value PMF values x. Additional argument type spedifies whether return \\(\\mathbb{P}(Y|Y>0)\\) \\(\\mathbb{P}(Y)\\). simulate -- function generates values dependent vector given linear predictors.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Family functions in singleRcapture package — chao","text":"functions based \"base\" distribution support \\(\\mathbb{N}_{0}=\\mathbb{N}\\cup{0}\\) describe distribution \\(Y\\) truncation. Currently include: \\[\\mathbb{P}(Y=y|\\lambda,\\alpha)=\\left\\lbrace \\begin{array}{cc} \\frac{\\lambda^{y}e^{-\\lambda}}{y!}    & \\text{poisson distribution}  \\cr \\frac{\\Gamma(y+\\alpha^{-1})}{\\Gamma(\\alpha^{-1})y!}  \\left(\\frac{\\alpha^{-1}}{\\alpha^{-1}+\\lambda}\\right)^{\\alpha^{-1}} \\left(\\frac{\\lambda}{\\alpha^{-1}+\\lambda}\\right)^{y} &  \\text{negative binomial distribution} \\cr \\frac{\\lambda^{y}}{(1+\\lambda)^{y+1}} &  \\text{geometric distribution} \\end{array} \\right.\\] \\(\\lambda\\) poisson parameter \\(\\alpha\\) dispersion parameter. Geometric distribution special case negative binomial distribution \\(\\alpha=1\\) included negative binomial distribution quite troublesome numerical regression fitting. important know PMF negative binomial distribution approaches PMF poisson distribution \\(\\alpha\\rightarrow 0^{+}\\). Note literature single source capture recapture models dispersion parameter introduces greater variability negative binomial distribution compared poisson distribution generally interpreted explaining unobserved heterogeneity .e. presence important unobserved independent variables. methods estimating population size tied poisson processes hence use \\(\\lambda\\) parameter symbol instead \\(\\mu\\) emphasize connection. Also hard see estimators derived modifying \"base\" distribution unbiased assumptions made respective models violated. zero truncated models corresponding \"base\" distributions characterised relation: \\[\\mathbb{P}(Y=y|Y>0)=\\left\\lbrace \\begin{array}{cc} \\frac{\\mathbb{P}(Y=y)}{1-\\mathbb{P}(Y=0)} & \\text{}y\\neq 0 \\cr 0 & \\text{}y=0 \\end{array}\\right.\\] allows us estimate parameter values using observed part population. models lead following estimates: \\[ \\begin{aligned} \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1}{1-\\exp(-\\lambda_{k})} &\\text{ poisson distribution} \\cr \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1}{1-(1+\\alpha_{k}\\lambda_{k})^{-\\alpha_{k}^{-1}}} &\\text{ negative binomial distribution} \\cr \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1+\\lambda_{k}}{\\lambda_{k}} &\\text{ geometric distribution} \\end{aligned} \\] One common way assumptions zero truncated models violated presence one inflation presence somewhat similar single source capture-recapture models zero inflation usual count data analysis. two ways one inflation may understood, relate whether \\(\\mathbb{P}(Y=0)\\) modified inflation. first approach inflate (\\(\\omega\\) parameter) zero truncated distribution : \\[ \\mathbb{P}_{new}(Y=y|Y>0) = \\left\\lbrace\\begin{array}{cc} \\omega + (1 - \\omega)\\mathbb{P}_{old}(Y=1|Y>0)& \\text{: } y = 1 \\cr (1 - \\omega) \\mathbb{P}_{old}(Y=y|Y>0) & \\text{: } y \\neq 1 \\end{array}\\right. \\] corresponds : \\[ \\mathbb{P}_{new}(Y=y) = \\left\\lbrace\\begin{array}{cc} \\mathbb{P}_{old}(Y=0) & \\text{: } y = 0 \\cr \\omega(1 - \\mathbb{P}(Y=0)) + (1 - \\omega)\\mathbb{P}_{old}(Y=1) & \\text{: } y = 1 \\cr (1 - \\omega) \\mathbb{P}_{old}(Y=y) & \\text{: } y > 1 \\end{array}\\right. \\] zero truncation. Models utilise approach commonly referred zero truncated one inflated models. Another way accommodating one inflation SSCR putting inflation parameter base distribution : \\[ \\mathbb{P}_{new}(Y=y) = \\left\\lbrace\\begin{array}{cc} \\omega + (1 - \\omega)\\mathbb{P}_{old}(Y=1)& \\text{: } y = 1 \\cr (1 - \\omega) \\mathbb{P}_{old}(Y=y) & \\text{: } y \\neq 1 \\end{array}\\right. \\] wchich becomes: \\[ \\mathbb{P}_{new}(Y=y|Y>0) = \\left\\lbrace\\begin{array}{cc} \\frac{\\omega}{1 - (1-\\omega)\\mathbb{P}_{old}(Y=0)} + \\frac{(1 - \\omega)}{1 - (1-\\omega)\\mathbb{P}_{old}(Y=0)}\\mathbb{P}_{old}(Y=1)& \\text{: } y = 1 \\cr \\frac{(1 - \\omega)}{1 - (1-\\omega)\\mathbb{P}_{old}(Y=0)}\\mathbb{P}_{old}(Y=y) & \\text{: } y > 1 \\end{array}\\right. \\] truncation. shown Böhning 2022 paper approaches equivalent terms maximising likelihoods put formula \\(\\omega\\). can however lead different population size estimates. zero truncated one inflated models formula population size estimate \\(\\hat{N}\\) change since \\(\\mathbb{P}(y=0)\\) remains estimation parameters changes calculations. one inflated zero truncated models population size estimates expressed : \\[ \\begin{aligned} \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1}{1-(1-\\omega_{k})\\exp(-\\lambda_{k})} &\\text{ base poisson distribution} \\cr \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1}{1-(1-\\omega_{k})(1+\\alpha_{k}\\lambda_{k})^{-\\alpha_{k}^{-1}}} &\\text{ base negative binomial distribution} \\cr \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1+\\lambda_{k}}{\\lambda_{k} + \\omega_{k}} &\\text{ base geometric distribution} \\end{aligned} \\] Zero one truncated models ignore one counts instead accommodating one inflation utilising identity \\[ \\ell_{\\text{ztoi}}=\\boldsymbol{f}_{1}\\ln{\\frac{\\boldsymbol{f}_{1}}{N_{obs}}} +(N_{obs}-\\boldsymbol{f}_{1})\\ln{\\left(1-\\frac{\\boldsymbol{f}_{1}}{N_{obs}} \\right)} + \\ell_{\\text{zot}} \\] \\(\\ell_{\\text{zot}}\\) log likelihood zero one truncated distribution characterised probability mass function: \\[\\mathbb{P}(Y=y|Y>1)=\\left\\lbrace \\begin{array}{cc} \\frac{\\mathbb{P}(Y=y)}{1-\\mathbb{P}(Y=0)-\\mathbb{P}(Y=1)} & \\text{}y > 1 \\cr 0 & \\text{}y\\\\lbrace 0, 1\\rbrace \\end{array}\\right.\\] \\(\\mathbb{P}(Y)\\) probability mass function \"base\" distribution. identity justifies use zero one truncated, unfortunately proven intercept models, however numerical simulations seem indicate even theorem extended (non trivial) regression population size estimation still possible. zero one truncated models population size estimates expressed : \\[ \\begin{aligned} \\hat{N} &= \\boldsymbol{f}_{1} + \\sum_{k=1}^{N_{obs}}\\frac{1-\\lambda_{k}\\exp(-\\lambda_{k})}{1-\\exp(-\\lambda_{k})-\\lambda_{k}\\exp(-\\lambda_{k})} &\\text{ base poisson distribution} \\cr \\hat{N} &= \\boldsymbol{f}_{1} + \\sum_{k=1}^{N_{obs}}\\frac{1-\\lambda_{k}(1+\\alpha_{k}\\lambda_{k})^{-1-\\alpha_{k}^{-1}}}{1-(1+\\alpha_{k}\\lambda_{k})^{-\\alpha_{k}^{-1}}-\\lambda_{k}(1+\\alpha_{k}\\lambda_{k})^{-1-\\alpha_{k}^{-1}}} &\\text{ base negative binomial distribution} \\cr \\hat{N} &= \\boldsymbol{f}_{1} + \\sum_{k=1}^{N_{obs}}\\frac{\\lambda_{k}^{2}+\\lambda_{k}+1}{\\lambda_{k}^{2}} &\\text{ base geometric distribution} \\end{aligned} \\] Pseudo hurdle models experimental yet described literature. Lastly chao zelterman models based logistic regression dummy variable \\[ Z = \\left\\lbrace\\begin{array}{cc} 0     & \\text{}Y = 1  \\cr 1     & \\text{}Y = 2 \\end{array}\\right.\\] based equation: \\[ \\text{logit}(p_{k})= \\ln\\left(\\frac{\\lambda_{k}}{2}\\right)= \\boldsymbol{\\beta}\\mathbf{x}_{k}=\\eta_{k}\\] \\(\\lambda_{k}\\) poisson parameter. zelterman estimator population size expressed : \\[ \\hat{N}=\\sum_{k=1}^{N_{obs}}{1-\\exp\\left(-\\lambda_{k}\\right)} \\] chao estimator form: \\[ \\hat{N}=N_{obs}+\\sum_{k=1}^{\\boldsymbol{f}_{1}+\\boldsymbol{f}_{2}} \\frac{1}{\\lambda_{k}+ \\frac{\\lambda_{k}^{2}}{2}} \\]","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Family functions in singleRcapture package — chao","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate size of sub populations. — stratifyPopsize","title":"Estimate size of sub populations. — stratifyPopsize","text":"function estimates sizes specific sub populations based capture-recapture model whole population.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate size of sub populations. — stratifyPopsize","text":"","code":"stratifyPopsize(object, stratas, alpha, ...)  # S3 method for singleR stratifyPopsize(object, stratas, alpha, cov = NULL, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate size of sub populations. — stratifyPopsize","text":"object object population size estimates based singleRcapture package fitter singleR class object. stratas specification sub populations either : formula -- formula applied model.frame extracted object . Logical vector number entries equal number rows dataset. (named) list element logical vector, names list used specify names variable returned object. Vector names explanatory variables. singleR method function specification stratas parameter result every level explanatory variable sub population variable specified. value provided singleR method function create sub populations based levels factor variables model.frame. alpha Significance level confidence intervals -- Either single numeric value vector length equal number sub populations specified stratas. missing set .05 singleR method. ... vector arguments passed functions. singleR method functions arguments ... passed either cov argument provided function vcov cov argument missing call.  cov singleR method estimate variance-covariance matrix estimate regression parameters. possible pass function example sandwich::vcovHC called : foo(object, ...) user may specify additional arguments function ... argument. provided estimate covariance matrix set calling appropriate vcov method.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate size of sub populations. — stratifyPopsize","text":"data.frame object row names names specified sub populations either provided inferred.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate size of sub populations. — stratifyPopsize","text":"single source capture-recapture models frequently used estimate population size Horwitz-Thompson type estimate: \\[\\hat{N} = \\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)} = \\sum_{k=1}^{N_{obs}}\\frac{1}{1-\\mathbb{P}(Y_{k}=0)}\\] \\(I_{k}=I_{Y_{k} > 0}\\) indicator variables, value 1 kth unit observed least 0 otherwise inverse probabilistic weights weights units observed data \\(\\tfrac{1}{\\mathbb{P}(Y_{k}>0)}\\) estimated using fitted linear predictors. estimates different sub populations made changing \\(I_{k}=I_{Y_{k} > 0}\\) indicator variables refer population whole sub populations considered .e. changing values 1 0 kth unit member sub population considered moment. estimation variance estimates estimation variance estimate population size whole population follow relation one described .","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary statistics for model of singleR class. — summary.singleR","title":"Summary statistics for model of singleR class. — summary.singleR","text":"summary method singleR class, works analogically summary.glm includes population size estimation results. additional statistics, confidence intervals coefficients coefficient correlation, specified printed.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary statistics for model of singleR class. — summary.singleR","text":"","code":"# S3 method for singleR summary(   object,   test = c(\"t\", \"z\"),   resType = \"pearson\",   correlation = FALSE,   confint = FALSE,   cov,   popSizeEst,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary statistics for model of singleR class. — summary.singleR","text":"object Object singleR class. test Type test significance parameters \"t\" t-test \"z\" normal approximation students t distribution, default \"z\" used 30 degrees freedom \"t\" used cases. resType Type residuals summarise value allowed residuals.signleR except \"\" allowed. default pearson residuals used. correlation Logical value indicating whether correlation matrix computed covariance matrix default FALSE. confint Logical value indicating whether confidence intervals regression parameters constructed. default FALSE. cov Covariance matrix corresponding regression parameters. possible give cov argument function object. specified constructed using vcov.singleR method. (.e using Cramer-Rao lower bound) popSizeEst popSizeEstResults class object. specified population size estimation results drawn object. post-hoc procedures, sandwich covariance matrix estimation bias reduction, taken possible include population size estimation results calling redoPopEstimation. ... Additional optional arguments passed following functions: vcov.singleR -- cov argument provided. cov -- cov parameter specified call function. confint.singleR -- confint parameter set TRUE function call. particular possible set confidence level ....","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary statistics for model of singleR class. — summary.singleR","text":"object summarysingleR class containing: call -- call created object. coefficients -- dataframe estimated regression coefficients summary statistics standard error wald test statistic p value wald test. residuals -- vector residuals type specified call. aic -- Akaike's informsation criterion. bic -- Bayesian (Schwarz's) information criterion. iter -- Number iterations taken fitting regression. logL -- Logarithm likelihood function evaluated coefficients. deviance -- Residual deviance. populationSize -- Object population size estimation results. dfResidual -- Residual degrees freedom. sizeObserved -- Size observed population. correlation -- Correlation matrix correlation parameter set TRUE test -- Type statistical test performed. model -- Family class object specified call object. skew -- bootstrap sample saved contains estimate skewness.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":null,"dir":"Reference","previous_headings":"","what":"Statistical tests of goodness of fit. — summary.singleRmargin","title":"Statistical tests of goodness of fit. — summary.singleRmargin","text":"Performs two statistical test observed fitted marginal frequencies. G test test statistic computed :   \\[G = 2\\sum_{k}O_{k}\\ln{\\left(\\frac{O_{k}}{E_{k}}\\right)}\\] \\(\\chi^{2}\\) test statistic computed : \\[\\chi^{2} = \\sum_{k}\\frac{\\left(O_{k}-E_{k}\\right)^{2}}{E_{k}}\\] \\(O_{k},E_{k}\\) denoted observed fitted frequencies respectively. statistics converge \\(\\chi^2\\) distribution asymptotically degrees freedom. convergence \\(G, \\chi^2\\) statistics \\(\\chi^2\\) distribution may violated expected counts cells low, say < 5, customary either censor omit cells.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Statistical tests of goodness of fit. — summary.singleRmargin","text":"","code":"# S3 method for singleRmargin summary(object, df, dropl5 = c(\"drop\", \"group\", \"no\"), ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Statistical tests of goodness of fit. — summary.singleRmargin","text":"object Object singleRmargin class. df Degrees freedom provided function try manually always possible. dropl5 character indicating treatment cells frequencies < 5 either grouping , droping leaving . Defaults drop. ... Currently nothing.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Statistical tests of goodness of fit. — summary.singleRmargin","text":"chi squared test G test comparison fitted observed marginal frequencies.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Statistical tests of goodness of fit. — summary.singleRmargin","text":"","code":"# Create a simple model Model <- estimatePopsize(formula = capture ~ .,  data = netherlandsimmigrant,  model = ztpoisson,  method = \"IRLS\") plot(Model, \"rootogram\")  # We see a considerable lack of fit summary(marginalFreq(Model), df = 1, dropl5 = \"group\") #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           50.06  1 1.5e-12 #> G-test                     34.31  1 4.7e-09 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been grouped  #> Names of cells used in calculating test(s) statistic: 1 2 3"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain Covariance Matrix estimation. — vcov.singleR","title":"Obtain Covariance Matrix estimation. — vcov.singleR","text":"vcov method singleR class.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain Covariance Matrix estimation. — vcov.singleR","text":"","code":"# S3 method for singleR vcov(object, type = c(\"Fisher\", \"observedInform\"), ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain Covariance Matrix estimation. — vcov.singleR","text":"object Object singleR class. type Type estimate covariance matrix now either expected (Fisher) information matrix observed information matrix. ... Additional optional arguments passed following functions: solve -- inverting information matrixes. model.frame.singleR -- creation Xvlm matrix.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain Covariance Matrix estimation. — vcov.singleR","text":"covariance matrix fitted coefficients, rows columns correspond parameters returned coef method.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Obtain Covariance Matrix estimation. — vcov.singleR","text":"Returns estimated covariance matrix model coefficients calculated analytic hessian Fisher information matrix. Covariance type taken control parameter provided call created object argumetns type specified.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — vcovHC.singleR","title":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — vcovHC.singleR","text":"S3 method vcovHC handle singleR class objects. Works exactly like vcov.default difference method handles vector generalised linear models. Updating covariance matrix variance/standard error estimation population size estimator can done via redoPopEstimation()","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — vcovHC.singleR","text":"","code":"# S3 method for singleR vcovHC(   x,   type = c(\"HC3\", \"const\", \"HC\", \"HC0\", \"HC1\", \"HC2\", \"HC4\", \"HC4m\", \"HC5\"),   omega = NULL,   sandwich = TRUE,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — vcovHC.singleR","text":"x fitted singleR class object. type character string specifying estimation type, sandwich::vcovHC.default. HC3 default value. omega vector function depending arguments residuals (.e. derivative log-likelihood respect linear predictor), diaghat (diagonal corresponding hat matrix) df (residual degrees freedom), sandwich::vcovHC.default. sandwich logical. sandwich estimator computed? set FALSE meat matrix returned. sandwich::vcovHC() ... additional optional arguments passed following functions: estfun -- empirical estimating functions. hatvalues -- diagonal elements projection matrix. sandwich -- sandwich argument function call set TRUE.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — vcovHC.singleR","text":"Variance-covariance matrix estimation corrected heteroscedasticity regression errors.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — vcovHC.singleR","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — vcovHC.singleR","text":"","code":"set.seed(1) N <- 10000 gender <- rbinom(N, 1, 0.2) eta <- -1 + 0.5*gender counts <- rpois(N, lambda = exp(eta)) df <- data.frame(gender, eta, counts) df2 <- subset(df, counts > 0) mod1 <-  estimatePopsize(   formula = counts ~ 1 + gender,    data = df2,    model = \"ztpoisson\",    method = \"optim\",    popVar = \"analytic\" ) require(sandwich) HC <- sandwich::vcovHC(mod1, type = \"HC4\") Fisher <- vcov(mod1, \"Fisher\") # variance covariance matrix obtained from  #Fisher (expected) information matrix HC #>             (Intercept)       gender #> (Intercept)  0.00201216 -0.002012160 #> gender      -0.00201216  0.004790297 Fisher #>              (Intercept)       gender #> (Intercept)  0.002022145 -0.002022145 #> gender      -0.002022145  0.004881858 # usual results summary(mod1) #>  #> Call: #> estimatePopsize(formula = counts ~ 1 + gender, data = df2, model = \"ztpoisson\",  #>     method = \"optim\", popVar = \"analytic\") #>  #> Pearson Residuals: #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #> -0.5503 -0.4267 -0.4267  0.0000 -0.4267  6.2261  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>             Estimate Std. Error z value  P(>|z|)     #> (Intercept) -1.01346    0.04497 -22.537  < 2e-16 *** #> gender       0.50288    0.06987   7.197 6.14e-13 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 3990.538 #> BIC: 4002.804 #> Residual deviance: 2386.29 #>  #> Log-likelihood: -1993.269 on 3403 Degrees of freedom  #> Number of calls to log-likelihood function: 24 #> ----------------------- #> Population size estimation results:  #> Point estimate 10146.02 #> Observed proportion: 33.6% (N obs = 3405) #> Std. Error 341.7288 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      9476.239   10815.79 #> logNormal   9508.827   10849.72 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      31.48175   35.93198 #> logNormal   31.38330   35.80883 # updated results summary(mod1, cov = HC, popSizeEst = redoPopEstimation(mod1, cov = HC)) #>  #> Call: #> estimatePopsize(formula = counts ~ 1 + gender, data = df2, model = \"ztpoisson\",  #>     method = \"optim\", popVar = \"analytic\") #>  #> Pearson Residuals: #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #> -0.5503 -0.4267 -0.4267  0.0000 -0.4267  6.2261  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>             Estimate Std. Error z value  P(>|z|)     #> (Intercept) -1.01346    0.04486 -22.593  < 2e-16 *** #> gender       0.50288    0.06921   7.266 3.71e-13 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 3990.538 #> BIC: 4002.804 #> Residual deviance: 2386.29 #>  #> Log-likelihood: -1993.269 on 3403 Degrees of freedom  #> Number of calls to log-likelihood function: 24 #> ----------------------- #> Population size estimation results:  #> Point estimate 10146.02 #> Observed proportion: 33.6% (N obs = 3405) #> Std. Error 340.7903 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      9478.079   10813.95 #> logNormal   9510.490   10847.69 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      31.48710   35.92500 #> logNormal   31.38916   35.80257"},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-0132--ntts","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.3.2 – NTTS","title":"singleRcapture 0.1.3.2 – NTTS","text":"Added function implements population size estimates stratas warnings fitting options control functions Corrected/implemented deviance residuals models Now whole package uses cammelCase Performance upgrades Corrected miss calculated moments Change exported data factors actually factors just characters Removed unused dependency Added automated R-cmd check","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-0131","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.3.1","title":"singleRcapture 0.1.3.1","text":"Basically documentation redone now features important theory SSCR methods information (v)glms Added checks positivity working weights matrixes stabilise \"IRLS\" algorithm S3 method vcovHC implemented vcovCL work singleR class objects work \"HC0\" \"HC1\" type argument values Basic version function redoPopEstimation updating population size estimation post-hoc procedures implemented popSizeEst function extracting population size estimation results implemented Minor improvements memory usage made computation speed little Changed names mle robust fitting methods optim IRLS respectively bugfixes warnings messages estimate_popsize.fit","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-013","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.3","title":"singleRcapture 0.1.3","text":"Multiple new models IRLS generalised distributions multiple parameters bugfixes QOL improvements extended bootstrap methods new models","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-012","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.2","title":"singleRcapture 0.1.2","text":"control parameters model control parameters regression bootstrap sampling leave one diagnostics popsize regression parameters (dfbetas corrected) fixes Goodness fit tests zero one truncated models computational improvements IRLS small bugfixes","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-011","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.1","title":"singleRcapture 0.1.1","text":"tiny tests fixes marginal frequencies Deviance implemented dfbetas levarage matrix Parametric bootstraps work correctly part just polishing left ","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-010","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.0","title":"singleRcapture 0.1.0","text":"first version package released","code":""}]
