[{"path":"https://ncn-foreigners.github.io/singleRcapture/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 singleRcapture authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Piotr Chlebicki. Author, maintainer. Maciej Beręsewicz. Author, contributor.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Chlebicki P, Beręsewicz M (2023). singleRcapture: Single-Source Capture-Recapture Models. R package version 0.2.0, https://github.com/ncn-foreigners/singleRcapture.","code":"@Manual{,   title = {singleRcapture: Single-Source Capture-Recapture Models},   author = {Piotr Chlebicki and Maciej Beręsewicz},   year = {2023},   note = {R package version 0.2.0},   url = {https://github.com/ncn-foreigners/singleRcapture}, }"},{"path":"https://ncn-foreigners.github.io/singleRcapture/index.html","id":"overview","dir":"","previous_headings":"","what":"Single-Source Capture-Recapture Models","title":"Single-Source Capture-Recapture Models","text":"Capture-recapture type experiments used estimate total population size situations observing part population feasible. recent years types experiments seen interest. Single source models distinct capture-recapture models estimate population size based many units observed two three sources standard approach. Instead single source models utilise count data regression models positive distributions (.e. counts greater 0) dependent variable number times particular unit observed source data. package aims implement already existing introduce new methods estimating population size single source simplify research process. Currently ’ve implemented frequentist approaches used literature : Zero truncated Poisson, geometric negative binomial regression. Zero truncated one inflated one inflated zero truncated Poisson geometric models. (Negative binomial currently development.) Zero one truncated Poisson geometric negative binomial models. Generalised Chao Zelterman’s models based logistic regression. Three types bootstrap parametric, semi-parametric non parametric. wide range additional functionalities associated (vector) generalised linear models relevant topic.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Single-Source Capture-Recapture Models","text":"can install development version singleRcapture GitHub : install current stable version CRAN :","code":"# install.packages(\"devtools\") remotes::install_github(\"ncn-foreigners/singleRcapture\") install.packages(singleRcapture)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/index.html","id":"examples","dir":"","previous_headings":"Installation","what":"Examples","title":"Single-Source Capture-Recapture Models","text":"main function package estimatePopsize fitts regression specified distribution uses fitted regression estimate population size. Lets look model 2003 publication : Point interval estimation population size using truncated Poisson regression model Heijden, Peter GM van der et al. call estimatePopsize look similar anyone used stats::glm function: implemented method plot function visualise model fit usefull diagnostic information. One rootogram, type plot compares fitted observed marginal frequencies:  possible values plotType argument : qq - normal quantile-quantile plot pearson residuals. marginal - matplot comparing fitted observed marginal frequencies. fitresid - plot linear predictor values contrasted pearson residuals. bootHist - histogram bootstrap sample. rootogram - rootogram, example presented . dfpopContr - contrasting two deletion effects identify presence influential observations. dfpopBox - boxplot results dfpopsize function see documentation. scaleLoc - scale-location plot. cooks - plot cooks.values distributions defined. hatplot - plot hatvalues. strata - plot confidence intervals selected su populations. user can also pass arguments specify additional information plot title, subtitle etc. similar calling plot data. info check plot.singleR method documentation. seen significant differences fitted observed marginal frequencies. check intuition let’s perform goodness fit test fitted observed marginal frequencies. call summary function marginalFreq function computes marginal frequencies fitted singleR class object: Finally let us check influential observations. comparing deletion effect every observation population size estimate removing entirely model (population size estimate regression) omitting pop size estimation (called contribution observation). observation influential two actions approximately effect:  easy deduce plot influential observations dataset (one particular). Lastly singleRcapture offers posthoc procedures example function stratifyPopsize estimates sizes user specified sub populations returns data.frame: stratas argument may specified various ways example: singleRcapture package also includes option use common non standard argument significance levels different usual 5%: option estimate standard error population size estimate bootstrap, models one distribution parameter dependent covariates non standard link functions example: results significantly different (warning issued concerns second derivative test existence local minimum, inconclusive manually checked fitting process found optimal regression coefficients ’s provide information user):  information criteria support favour model:","code":"library(singleRcapture) model <- estimatePopsize(   formula = capture ~ gender + age + nation, # specify formula   data = netherlandsimmigrant,   popVar = \"analytic\", # specify    model = \"ztpoisson\", # distribution used   method = \"IRLS\", # fitting method one of three currently supported   controlMethod = controlMethod(silent = TRUE) # ignore convergence at half step warning ) summary(model) # a summary method for singleR class with standard glm-like output and population size estimation resutls #>  #> Call: #> estimatePopsize(formula = capture ~ gender + age + nation, data = netherlandsimmigrant,  #>     model = \"ztpoisson\", method = \"IRLS\", popVar = \"analytic\",  #>     controlMethod = controlMethod(silent = TRUE)) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.486442 -0.486442 -0.298080  0.002093 -0.209444 13.910844  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.3411     0.2149  -6.241 4.35e-10 *** #> gendermale             0.3972     0.1630   2.436 0.014832 *   #> age>40yrs             -0.9746     0.4082  -2.387 0.016972 *   #> nationAsia            -1.0926     0.3016  -3.622 0.000292 *** #> nationNorth Africa     0.1900     0.1940   0.979 0.327398     #> nationRest of Africa  -0.9106     0.3008  -3.027 0.002468 **  #> nationSurinam         -2.3364     1.0136  -2.305 0.021159 *   #> nationTurkey          -1.6754     0.6028  -2.779 0.005445 **  #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> AIC: 1712.901 #> BIC: 1757.213 #> Residual deviance: 1128.553 #>  #> Log-likelihood: -848.4504 on 1872 Degrees of freedom  #> Number of iterations: 8 #> ----------------------- #> Population size estimation results:  #> Point estimate 12690.35 #> Observed proportion: 14.8% (N obs = 1880) #> Std. Error 2808.169 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      7186.444   18194.26 #> logNormal   8431.275   19718.32 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal     10.332927   26.16037 #> logNormal   9.534281   22.29793 plot(model, plotType = \"rootogram\") summary(marginalFreq(model), df = 2, dropl5 = \"group\") #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           50.06  2 1.3e-11 #> G-test                     34.31  2 3.6e-08 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been grouped  #> Names of cells used in calculating test(s) statistic: 1 2 3 plot(model, plotType = \"dfpopContr\") stratifyPopsize(model, alpha = c(.01, .02, .03, .05), # different significance level for each sub population     stratas = list(     \"Females from Surinam\" = netherlandsimmigrant$gender == \"female\" & netherlandsimmigrant$nation == \"Surinam\",     \"Males from Turkey\" = netherlandsimmigrant$gender == \"male\" & netherlandsimmigrant$nation == \"Turkey\",     \"Younger males\" = netherlandsimmigrant$gender == \"male\" & netherlandsimmigrant$age == \"<40yrs\",     \"Older males\" = netherlandsimmigrant$gender == \"male\" & netherlandsimmigrant$age == \">40yrs\" )) #>   Observed Estimated ObservedPercentage  StdError normalLowerBound #> 1       20   931.469           2.147146  955.0676      -1528.62209 #> 2       78  1291.251           6.040652  741.0066       -432.58790 #> 3     1391  7337.072          18.958516 1282.1419       4554.70841 #> 4       91  1542.189           5.900703  781.4754         10.52561 #>   normalUpperBound logNormalLowerBound logNormalUpperBound                 name #> 1         3391.560            119.2661            8389.178 Females from Surinam #> 2         3015.090            405.4127            4573.791    Males from Turkey #> 3        10119.436           5134.8113           10834.792        Younger males #> 4         3073.853            630.7551            3992.677          Older males #>   confLevel #> 1      0.01 #> 2      0.02 #> 3      0.03 #> 4      0.05 stratifyPopsize(model, stratas = ~ gender / age) #>   Observed Estimated ObservedPercentage  StdError normalLowerBound #> 1      398 3811.0924          10.443200 1153.9749       1549.34322 #> 2     1482 8879.2613          16.690578 1812.0813       5327.64720 #> 3      378 3169.8272          11.924940  880.9491       1443.19883 #> 4     1391 7337.0721          18.958516 1282.1419       4824.12025 #> 5       20  641.2651           3.118835  407.5268       -157.47265 #> 6       91 1542.1892           5.900703  781.4754         10.52561 #>   normalUpperBound logNormalLowerBound logNormalUpperBound #> 1         6072.842           2189.0439            6902.140 #> 2        12430.875           6090.7752           13354.889 #> 3         4896.456           1904.3121            5484.622 #> 4         9850.024           5306.3298           10421.088 #> 5         1440.003            212.3382            2026.728 #> 6         3073.853            630.7551            3992.677 #>                     name confLevel #> 1         gender==female      0.05 #> 2           gender==male      0.05 #> 3 genderfemale:age<40yrs      0.05 #> 4   gendermale:age<40yrs      0.05 #> 5 genderfemale:age>40yrs      0.05 #> 6   gendermale:age>40yrs      0.05 set.seed(123) modelInflated <- estimatePopsize(     formula = capture ~ gender + age,     data = netherlandsimmigrant,     model = \"oiztgeom\",     method = \"IRLS\",     # control parameters for population size estimation check documentation of controlPopVar     controlPopVar = controlPopVar(         alpha = .01, # significance level      ) ) summary(modelInflated) #>  #> Call: #> estimatePopsize(formula = capture ~ gender + age, data = netherlandsimmigrant,  #>     model = \"oiztgeom\", method = \"IRLS\", controlPopVar = controlPopVar(alpha = 0.01,  #>         )) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.357193 -0.357193 -0.357193  0.000343 -0.287637 10.233608  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>             Estimate Std. Error z value P(>|z|)     #> (Intercept)  -1.5346     0.1846  -8.312 < 2e-16 *** #> gendermale    0.3863     0.1380   2.800 0.00512 **  #> age>40yrs    -0.7788     0.2942  -2.648 0.00810 **  #> ----------------------- #> For linear predictors associated with: omega  #>             Estimate Std. Error z value  P(>|z|)     #> (Intercept)  -1.7591     0.3765  -4.673 2.97e-06 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> AIC: 1736.854 #> BIC: 1759.01 #> Residual deviance: 1011.271 #>  #> Log-likelihood: -864.4272 on 3756 Degrees of freedom  #> Number of iterations: 6 #> ----------------------- #> Population size estimation results:  #> Point estimate 5661.522 #> Observed proportion: 33.2% (N obs = 1880) #> Std. Error 963.9024 #> 99% CI for the population size: #>           lowerBound upperBound #> normal      3178.674   8144.370 #> logNormal   3861.508   9096.681 #> 99% CI for the share of observed population: #>           lowerBound upperBound #> normal      23.08343   59.14416 #> logNormal   20.66688   48.68564 modelInflated2 <- estimatePopsize(     formula = capture ~ age,     data = netherlandsimmigrant,     popVar = \"bootstrap\",     model = oiztgeom(omegaLink = \"cloglog\"),     method = \"IRLS\",     controlPopVar = controlPopVar(         B = 500,# number of boostrap samples         alpha = .01, # significance level          # type of bootstrap see documentation for estimatePopsize         bootType = \"semiparametric\",         # control regression fitting on bootstrap samples         bootstrapFitcontrol = controlMethod(           epsilon = .Machine$double.eps,            silent = TRUE,            stepsize = 2         )     ),     controlModel = controlModel(omegaFormula = ~ gender) # put covariates on omega i.e. the inflation parameter ) #> Warning in estimatePopsize(formula = capture ~ age, data = netherlandsimmigrant, : The (analytically computed) hessian of the score function is not negative define. #> NOTE: Second derivative test failing does not  #>       necessarily mean that the maximum of score function that was found  #>       numericaly is invalid since R^k is not a bounded space. #> Additionally in one inflated and hurdle models second derivative test often fails even on valid arguments. #> Warning in estimatePopsize(formula = capture ~ age, data = #> netherlandsimmigrant, : Switching from observed information matrix to Fisher #> information matrix because hessian of log-likelihood is not negative define. popSizeEst(modelInflated2) #> Point estimate: 5496.376 #> Variance: 1552532 #> 99% confidence intervals: #> lowerBound upperBound  #>   4320.925  11078.865 plot(modelInflated2, plotType = \"bootHist\", labels = TRUE, ylim = c(0, 200)) #>  First model: AIC = 1736.854 BIC = 1759.01 #> Second model: AIC = 1734.803 BIC = 1756.959"},{"path":"https://ncn-foreigners.github.io/singleRcapture/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"Single-Source Capture-Recapture Models","text":"Work package supported National Science Center, OPUS 22 grant . 2020/39/B/HS4/00941.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/carcassubmission.html","id":null,"dir":"Reference","previous_headings":"","what":"British farm carcass submissions data — carcassubmission","title":"British farm carcass submissions data — carcassubmission","text":"Data British animal farms submissions AHVLA. British farms able submit samples AHVLA cause death animal determined private veterinary surgeon decides submit , unless notifiable disease suspected submission required. data set contains information farms. submissions included data frame submissions carcasses .e. submissions blood samples etc. excluded.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/carcassubmission.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"British farm carcass submissions data — carcassubmission","text":"","code":"data(\"carcassubmission\")"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/carcassubmission.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"British farm carcass submissions data — carcassubmission","text":"Data frame 1,858 rows 4 columns. TOTAL_SUB Number submissions animal carcasses. log_size Numerical value equal logarithm size farm. log_distance Numerical value equal logarithm distance nearest AHVLA center. C_TYPE Factor describing type activity farm animals used . Either Dairy Beef","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/carcassubmission.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"British farm carcass submissions data — carcassubmission","text":"data set description provided publication: Böhning, D., Vidal Diez, ., Lerdsuwansri, R., Viwatwongkasem, C., Arnold, M. (2013). \"generalization Chao's estimator covariate information\". Biometrics, 69(4), 1033-1042. doi:10.1111/biom.12082","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/confint.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence Intervals for Model Parameters — confint.singleR","title":"Confidence Intervals for Model Parameters — confint.singleR","text":"function computes studentized confidence intervals model coefficients.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/confint.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence Intervals for Model Parameters — confint.singleR","text":"","code":"# S3 method for singleR confint(object, parm, level = 0.95, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/confint.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence Intervals for Model Parameters — confint.singleR","text":"object object singleR class. parm names parameters confidence intervals computed, missing parameters considered. level confidence level intervals. ... currently nothing.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/confint.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence Intervals for Model Parameters — confint.singleR","text":"object named columns include upper lower limit confidence intervals.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":null,"dir":"Reference","previous_headings":"","what":"Control parameters for regression — controlMethod","title":"Control parameters for regression — controlMethod","text":"controlMethod constructs list necessary control parameters regression fitting estimatePopsize.fit estimatePopsize.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control parameters for regression — controlMethod","text":"","code":"controlMethod(   epsilon = 1e-08,   maxiter = 1000,   verbose = 0,   printEveryN = 1L,   start = NULL,   optimMethod = \"L-BFGS-B\",   silent = FALSE,   optimPass = FALSE,   stepsize = 1,   checkDiagWeights = TRUE,   weightsEpsilon = 1e-08,   momentumFactor = 0,   saveIRLSlogs = FALSE,   momentumActivation = 5,   criterion = c(\"coef\", \"abstol\", \"reltol\") )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control parameters for regression — controlMethod","text":"epsilon tolerance fitting algorithms default 1e-8. maxiter maximum number iterations. verbose value indicating whether trace steps fitting algorithm IRLS fitting method different values verbose give following information: 1 -- Returns information number current iteration current log-likelihood. 2 -- Returns information vector regression parameters current iteration (). 3 -- Returns information reduction log-likelihood current iteration (). 4 -- Returns information value log-likelihood function gradient current iteration (). 5 -- Returns information convergence criterion values taken account considering convergence (). optim method chosen verbose passed stats::optim() trace. printEveryN integer value indicating often print information specified verbose, default set 1. start initial parameters regression coefficients NULL derived internally. optimMethod method stats::optim() used L-BFGS-B default except negative binomial one inflated models \"Nelder-Mead\" used. silent logical, indicating whether warnings IRLS method suppressed. optimPass optional list parameters passed stats::optim(..., control = optimPass) FALSE list control parameters inferred parameters. stepsize IRLS, scaling updates beta vector lower value means slower convergence accuracy default 1. general fitting algorithm fails lowering value tends effective correcting . checkDiagWeights logical value indicating whether check diagonal elements working weights matrixes IRLS sufficiently positive matrixes positive defined. default TRUE. weightsEpsilon small number ensure positivity weights matrixes. matters checkDiagWeights set TRUE. default 1e-8. momentumFactor experimental parameter IRLS allowing taking previous step account current step, .e instead updating regression parameters : \\[\\boldsymbol{\\beta}_{()} =  \\boldsymbol{\\beta}_{(-1)} + \\text{stepsize} \\cdot \\text{step}_{()}\\] update made : \\[ \\boldsymbol{\\beta}_{()} = \\boldsymbol{\\beta}_{(-1)} + \\text{stepsize}  \\cdot (\\text{step}_{()} + \\text{momentum}\\cdot\\text{step}_{(-1)})\\] saveIRLSlogs logical value indicating information specified verbose saved output object, default FALSE. momentumActivation value log-likelihood reduction bellow momentum apply. criterion criterion used determine convergence IRLS, multiple values may provided. default c(\"coef\", \"abstol\").","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Control parameters for regression — controlMethod","text":"List selected parameters, also possible call list directly.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlMethod.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Control parameters for regression — controlMethod","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Control parameters specific to some models — controlModel","title":"Control parameters specific to some models — controlModel","text":"controlModel constructs list necessary control parameters estimatePopsize either specific selected model fit anywhere else. Specifying additional formulas done using right hand side formula also now variables additional formulas also included \"main\" formula.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control parameters specific to some models — controlModel","text":"","code":"controlModel(   weightsAsCounts = FALSE,   omegaFormula = ~1,   alphaFormula = ~1,   piFormula = ~1 )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control parameters specific to some models — controlModel","text":"weightsAsCounts now nothing. plan indicate whether prior.weights treated counts sub populations adjust necessary methods functionalities, like adjustments bootstrap decreasing weights dfbeta instead deleting rows data, accommodate form data. omegaFormula formula inflation parameter one inflated zero truncated zero truncated one inflated models. alphaFormula formula dispersion parameter negative binomial based models. piFormula formula probability parameter pseudo hurdle zero truncated zero truncated pseudo hurdle models.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Control parameters specific to some models — controlModel","text":"list selected parameters, also possible call list directly.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlModel.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Control parameters specific to some models — controlModel","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":null,"dir":"Reference","previous_headings":"","what":"Control parameters for population size estimation — controlPopVar","title":"Control parameters for population size estimation — controlPopVar","text":"Creating control parameters population size estimation respective standard error variance estimation.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Control parameters for population size estimation — controlPopVar","text":"","code":"controlPopVar(   alpha = 0.05,   trcount = 0,   bootType = c(\"parametric\", \"semiparametric\", \"nonparametric\"),   B = 500,   confType = c(\"percentilic\", \"normal\", \"basic\"),   keepbootStat = TRUE,   traceBootstrapSize = FALSE,   bootstrapVisualTrace = FALSE,   fittingMethod = c(\"optim\", \"IRLS\"),   bootstrapFitcontrol = NULL,   sd = c(\"sqrtVar\", \"normalMVUE\"),   covType = c(\"observedInform\", \"Fisher\") )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Control parameters for population size estimation — controlPopVar","text":"alpha significance level, 0.05 used default. trcount truncated count - number added point estimator sides confidence intervals. bootType bootstrap type. Default \"parametric\", possible values : \"semiparametric\" \"nonparametric\". B number bootstrap samples performed (default 500). confType type confidence interval bootstrap confidence interval, \"percentile\" default. possibilities: \"studentized\" \"basic\". keepbootStat boolean value indicating whether keep vector statistics produced bootstrap. traceBootstrapSize boolean value indicating whether print size bootstrapped sample truncation semi- fully parametric bootstraps. bootstrapVisualTrace boolean value indicating whether plot bootstrap statistics real time. fittingMethod method used fitting models bootstrap samples. bootstrapFitcontrol control parameters regression works exactly like controlMethod fitting models bootstrap samples. sd indicates compute standard deviation population size estimator either : \\[\\hat{\\sigma}=\\sqrt{\\hat{\\text{var}}(\\hat{N})}\\] sqrt (slightly biased \\(\\hat{N}\\) normal distribution) normalMVUE unbiased minimal variance estimator normal distribution: \\[\\hat{\\sigma}=\\sqrt{\\hat{\\text{var}}(\\hat{N})} \\frac{\\Gamma\\left(\\frac{N_{obs}-1}{2}\\right)}{\\Gamma\\left(\\frac{N_{obs}}{2}\\right)} \\sqrt{\\frac{N_{obs}}{2}}\\] ration involving gamma functions computed log gamma function. covType type covariance matrix regression parameters default observed information matrix, options future.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Control parameters for population size estimation — controlPopVar","text":"list selected parameters, also possible call list directly.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/controlPopVar.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Control parameters for population size estimation — controlPopVar","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"estimatePopsize.fit estimatePopsize glm.fit glm. internally called estimatePopsize. Since estimatePopsize much just regression fitting estimatePopsize.fit much faster.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"","code":"estimatePopsize.fit(y, X, family, control, method, priorWeights, start, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"y vector dependent variables. X model matrix, vglm one. family model estimatePopsize. control control parameters created controlModel. method method estimation estimatePopsize. priorWeights vector prior weights argument weights estimatePopsize. start initial value regression parameters. ... arguments pass methods.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"List regression parameters, working weights (IRLS fitting method) chosen number iterations taken.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"method argument set \"optim\" stats::optim function used fit regression analytically computed gradient (minus) log likelihood functions gr fn arguments. Unfortunately optim allow hessian specified. information modify optim fitting included controlMethod(). method argument set \"IRLS\" iteratively reweighted least squares. algorithm well know generalised linear models. Thomas W. Yee later extended algorithm vector generalised linear models general terms can roughly described (Yee's description changing conventions): Initialise : converged <- FALSE iter <- 1 \\(\\boldsymbol{\\beta}\\) <- start \\(\\boldsymbol{W}\\) <- prior \\(\\ell\\) <- \\(\\ell(\\boldsymbol{\\beta})\\) converged iter > Maxiter move step 7. Store values previous algorithm step: \\(\\boldsymbol{W}_{-}\\) <-  \\(\\boldsymbol{W}\\) \\(\\ell_{-}\\) <-  \\(\\ell\\) \\(\\boldsymbol{\\beta}_{-}\\) <-  \\(\\boldsymbol{\\beta}\\) assign values current step: \\(\\boldsymbol{\\eta}\\) <-  \\(\\boldsymbol{X}_{vlm}\\boldsymbol{\\beta}\\) \\(Z_{}\\) <-  \\( \\eta_{}+\\frac{\\partial\\ell_{}}{\\partial\\eta_{}} \\mathbb{E}\\left(\\frac{\\partial^{2}\\ell_{}}{ \\partial\\eta_{}^{T}\\partial\\eta_{}}\\right)^{-1}\\) \\(\\boldsymbol{W}_{ij}\\) <-  \\(\\mathbb{E}\\left(\\frac{\\partial^{2}\\ell}{ \\partial\\boldsymbol{\\eta}_{j}^{T}\\partial\\boldsymbol{\\eta}_{}}\\right)\\) \\(\\ell_{}\\) ith component log likelihood function, \\(\\eta_{}\\) vector linear predictors associated ith row \\(\\mathbb{E}\\left(\\frac{\\partial^{2}\\ell_{}}{ \\partial\\eta_{}^{T}\\partial\\eta_{}}\\right)\\) corresponds weights associated ith row \\(\\boldsymbol{W}\\) block matrix, made diagonal matrixes \\(\\mathbb{E}\\left(\\frac{\\partial^{2}\\ell}{ \\partial\\boldsymbol{\\eta}_{j}^{T}\\partial\\boldsymbol{\\eta}_{}}\\right)\\) Regress \\(\\boldsymbol{Z}\\) \\(\\boldsymbol{X}_{vlm}\\) obtain \\(\\boldsymbol{\\beta}\\) : \\[\\boldsymbol{\\beta}= \\left(\\boldsymbol{X}_{vlm}^{T}\\boldsymbol{W}\\boldsymbol{X}_{vlm}\\right)^{-1} \\boldsymbol{X}_{vlm}^{T}\\boldsymbol{W}\\boldsymbol{Z}\\] Assign: converged <- \\( \\ell(\\boldsymbol{\\beta})-\\ell_{-} \\( ||\\boldsymbol{\\beta}-\\boldsymbol{\\beta}_{-}||_{\\infty} iter <- iter + 1 \\(\\varepsilon\\) relative tolerance level, default 1e-8. Return step 2. Return \\(\\boldsymbol{\\beta}, \\boldsymbol{W}\\), iter. package use different conventions \\(\\boldsymbol{X}_{vlm}\\) matrix hence slight differences present algorithm description results identical.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"Yee, T. W. (2015). Vector Generalized Linear Additive Models: Implementation R. New York, USA: Springer. ISBN 978-1-4939-2817-0.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"Piotr Chlebicki, Maciej Beresewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.fit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Regression fitting in single source capture-recapture models — estimatePopsize.fit","text":"","code":"# \\donttest{ # Get data summary(farmsubmission) #>    TOTAL_SUB        log_size       log_distance      C_TYPE     #>  Min.   : 1.00   Min.   : 0.000   Min.   : 4.102   Beef :5336   #>  1st Qu.: 1.00   1st Qu.: 4.673   1st Qu.:10.351   Dairy:6700   #>  Median : 1.00   Median : 5.347   Median :10.778                #>  Mean   : 2.34   Mean   : 5.259   Mean   :10.662                #>  3rd Qu.: 3.00   3rd Qu.: 5.940   3rd Qu.:11.099                #>  Max.   :47.00   Max.   :10.480   Max.   :12.097                 # construct vglm model matrix X <- matrix(data = 0, nrow = 2 * NROW(farmsubmission), ncol = 7) X[1:NROW(farmsubmission), 1:4] <- model.matrix(   ~ 1 + log_size + log_distance + C_TYPE,    farmsubmission )  X[-(1:NROW(farmsubmission)), 5:7] <- X[1:NROW(farmsubmission), c(1, 3, 4)]  # this atrrtibute tells the function which elements of the design matrix  # correspond to which linear predictor  attr(X, \"hwm\") <- c(4, 3)  # get starting points start <- glm.fit(   y = farmsubmission$TOTAL_SUB,    x = X[1:NROW(farmsubmission), 1:4],    family = poisson() )$coefficients  start <- c(start, 0, 0, 0)  # call function res <- estimatePopsize.fit(   y = farmsubmission$TOTAL_SUB,    X = X,    method = \"IRLS\",    priorWeights = 1,    family = ztoigeom(),    control = controlMethod(verbose = 5),    start = start ) #> Iteration number 1 log-likelihood: -17455.372 #> Parameter vector:  -2.255494347  0.521900283 -0.048255922  0.321168020 -1.297382847  0.049409082 -0.726587214 #> log-likelihood reduction:  1178.8778 #> Value of gradient at current step: #>    639.53919  4035.62183  6732.72078   672.31223  -316.39394 -3358.16739  -229.50394 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 1.4296549 #> ---- #> Iteration number 2 log-likelihood: -17289.531 #> Parameter vector:  -2.859491920  0.627917105 -0.063516471  0.573159952 -2.327571214  0.074464787 -0.734988992 #> log-likelihood reduction:  165.84115 #> Value of gradient at current step: #>    77.37365182  329.72667483  823.92206208    0.28711463  -53.27713944 -568.21808076  -29.69092406 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 1.0301884 #> ---- #> Iteration number 3 log-likelihood: -17279.272 #> Parameter vector:  -2.710874025  0.613067896 -0.069548715  0.537208696 -2.550651004  0.071488122 -0.939145580 #> log-likelihood reduction:  10.258788 #> Value of gradient at current step: #>   35.9649654 218.1210745 385.4441808  32.8759028  -6.8429684 -71.8589804  -5.7178443 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.22307979 #> ---- #> Iteration number 4 log-likelihood: -17278.776 #> Parameter vector:  -2.78426085  0.61628333 -0.06440012  0.53843272 -3.10491635  0.12060422 -1.04138882 #> log-likelihood reduction:  0.49548535 #> Value of gradient at current step: #>   1.67966432 11.13935043 16.42827781  1.15147049 -0.53787945 -5.57182317 -0.74695785 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.55426534 #> ---- #> Iteration number 5 log-likelihood: -17278.762 #> Parameter vector:  -2.77818073  0.61674992 -0.06504016  0.53517478 -3.10447410  0.12145802 -1.08163762 #> log-likelihood reduction:  0.014133264 #> Value of gradient at current step: #>   0.232501334  2.204257359  2.694809270  0.131590616 -0.071608376 -0.605938875 -0.064356213 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.040248796 #> ---- #> Iteration number 6 log-likelihood: -17278.761 #> Parameter vector:  -2.78602286  0.61698772 -0.06441877  0.53495927 -3.19325142  0.12969021 -1.08314735 #> log-likelihood reduction:  0.00072206104 #> Value of gradient at current step: #>  -0.0149254818 -0.0442854058 -0.2585639445 -0.0671445437 -0.0089103073 -0.1428452785 -0.0408361061 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.088777321 #> ---- #> Iteration number 7 log-likelihood: -17278.761 #> Parameter vector:  -2.783307402  0.617006834 -0.064659772  0.534565433 -3.160032510  0.126742033 -1.087078105 #> log-likelihood reduction:  0.000086867327 #> Value of gradient at current step: #>   0.0219006963  0.2137543745  0.2878052106  0.0210725208 -0.0038258075 -0.0055588958  0.0088000042 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.033218913 #> ---- #> Iteration number 8 log-likelihood: -17278.761 #> Parameter vector:  -2.785132183  0.617029483 -0.064506904  0.534668321 -3.181900933  0.128724679 -1.085840518 #> log-likelihood reduction:  0.00002149725 #> Value of gradient at current step: #>  -0.00917986044 -0.07823752443 -0.12764140872 -0.01528913764  0.00031447068 -0.01459257985 -0.00776040765 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.021868422 #> ---- #> Iteration number 9 log-likelihood: -17278.761 #> Parameter vector:  -2.784182050  0.617023943 -0.064588093  0.534586386 -3.170374939  0.127687086 -1.086727858 #> log-likelihood reduction:  0.0000064244196 #> Value of gradient at current step: #>   0.00580810483  0.05244014315  0.07853720971  0.00778331026 -0.00057098473  0.00429221923  0.00373823937 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.011525994 #> ---- #> Iteration number 10 log-likelihood: -17278.761 #> Parameter vector:  -2.784725925  0.617028507 -0.064541975  0.534626993 -3.176948180  0.128280435 -1.086273279 #> log-likelihood reduction:  0.0000019945583 #> Value of gradient at current step: #>  -0.00307033641 -0.02728421574 -0.04201045327 -0.00448214637  0.00022935424 -0.00326931977 -0.00221219809 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.006573241 #> ---- #> Iteration number 11 log-likelihood: -17278.761 #> Parameter vector:  -2.78442528  0.61702627 -0.06456754  0.53460327 -3.17330966  0.12795232 -1.08653540 #> log-likelihood reduction:  0.00000061988248 #> Value of gradient at current step: #>   0.00175710834  0.01568170311  0.02390375484  0.00247668339 -0.00014882078  0.00161926857  0.00120723719 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.003638518 #> ---- #> Iteration number 12 log-likelihood: -17278.761 #> Parameter vector:  -2.784593634  0.617027580 -0.064553239  0.534616288 -3.175346365  0.128136053 -1.086390890 #> log-likelihood reduction:  0.00000019314757 #> Value of gradient at current step: #>  -0.000968762329 -0.008641334460 -0.013216142982 -0.001385713883  0.000077984444 -0.000953809236 -0.000679710379 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0020367031 #> ---- #> Iteration number 13 log-likelihood: -17278.761 #> Parameter vector:  -2.784499807  0.617026860 -0.064561213  0.534608978 -3.174211159  0.128033659 -1.086471902 #> log-likelihood reduction:  0.000000060121238 #> Value of gradient at current step: #>   0.000543879335  0.004849594700  0.007409081643  0.000772957749 -0.000044801249  0.000519451062  0.000377932801 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.0011352062 #> ---- #> Iteration number 14 log-likelihood: -17278.761 #> Parameter vector:  -2.784552191  0.617027265 -0.064556762  0.534613048 -3.174844941  0.128090828 -1.086426773 #> log-likelihood reduction:  0.000000018728315 #> Value of gradient at current step: #>  -0.00030256412 -0.00269909106 -0.00412482646 -0.00043127032  0.00002466148 -0.00029328220 -0.00021122304 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.00063378216 #> ---- #> Iteration number 15 log-likelihood: -17278.761 #> Parameter vector:  -2.784522964  0.617027040 -0.064559245  0.534610775 -3.174491334  0.128058932 -1.086451974 #> log-likelihood reduction:  0.00000000583168 #> Value of gradient at current step: #>   0.000169118292  0.001508137338  0.002304647304  0.000240720382 -0.000013855243  0.000162719794  0.000117791119 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.00035360722 #> ---- #> Value of analytically computed hessian at fitted regression coefficients: #>             [,1]         [,2]         [,3]        [,4]       [,5]        [,6] #> [1,]  -5533.0360  -31139.1628  -58786.3824  -3921.3952  407.46348  23473.8262 #> [2,] -31139.1628 -179723.7217 -330742.8394 -22956.5461 4362.01544   1060.0139 #> [3,] -58786.3824 -330742.8394 -627035.9660 -41504.3671  185.81715   4362.0154 #> [4,]  -3921.3952  -22956.5461  -41504.3671  -3921.3952 2193.72685  46845.5137 #> [5,]    407.4635     185.8172   46845.5137   1060.0139  -88.14760   -948.1115 #> [6,]   2193.7268    4362.0154    1971.9380   1971.9380 -948.11154 -10234.8910 #> [7,]   4362.0154   23473.8262     185.8172    185.8172  -28.97964   -312.6869 #>            [,7] #> [1,] 1971.93804 #> [2,]  185.81715 #> [3,] 1971.93804 #> [4,]  185.81715 #> [5,]  -28.97964 #> [6,] -312.68692 #> [7,]  -28.97964 #> The matrix above has the following eigen values: #>  -811159.7+0i -17207.51+0i -2161.919+9274.748i -2161.919-9274.748i 6057.218+0i 1581.239+0i -1513.504+0i   # extract results  # regression coefficient vector res$beta #> [1] -2.78452296  0.61702704 -0.06455925  0.53461077 -3.17449133  0.12805893 #> [7] -1.08645197  # check likelihood ll <- ztnegbin()$makeMinusLogLike(y = farmsubmission$TOTAL_SUB, X = X)  -ll(res$beta) #> [1] -19536.01  # number of iterations res$iter #> [1] 15  # working weights head(res$weights) #>          lambda       mixed       mixed       omega #> [1,] 0.22688312 -0.03207963 -0.03207963 0.006351956 #> [2,] 0.66642253 -0.03199578 -0.03199578 0.006238854 #> [3,] 0.08469406 -0.01202233 -0.01202233 0.001899477 #> [4,] 0.14084340 -0.01990317 -0.01990317 0.003397031 #> [5,] 0.34099080 -0.04762290 -0.04762290 0.012045206 #> [6,] 0.42290801 -0.05782236 -0.05782236 0.018478738  # Compare with optim call  res2 <- estimatePopsize.fit(   y = farmsubmission$TOTAL_SUB,    X = X,    method = \"optim\",    priorWeights = 1,    family = ztoigeom(),    start = start,    control = controlMethod(verbose = 1) ) #> iter   10 value 17321.626463 #> iter   20 value 17301.696934 #> iter   30 value 17281.887033 #> iter   40 value 17281.801823 #> iter   50 value 17281.438921 #> iter   60 value 17280.194225 #> iter   70 value 17280.189477 #> iter   80 value 17280.165879 #> iter   90 value 17280.101570 #> iter  100 value 17279.317722 #> iter  110 value 17279.279067 #> iter  120 value 17279.259879 #> iter  130 value 17279.226906 #> iter  140 value 17279.052366 #> iter  150 value 17279.005464 #> iter  160 value 17278.951191 #> iter  170 value 17278.932703 #> iter  180 value 17278.912052 #> iter  190 value 17278.806103 #> iter  200 value 17278.762829 #> iter  210 value 17278.762367 #> iter  220 value 17278.762064 #> iter  230 value 17278.761986 #> iter  240 value 17278.761801 #> iter  250 value 17278.761737 #> iter  260 value 17278.761686 #> iter  270 value 17278.761593 #> iter  280 value 17278.761579 #> iter  290 value 17278.761450 #> iter  300 value 17278.761338 #> iter  310 value 17278.761323 #> iter  320 value 17278.761321 #> iter  330 value 17278.761317 #> iter  340 value 17278.761309 #> iter  350 value 17278.761304 #> iter  360 value 17278.761293 #> iter  370 value 17278.761291 #> iter  380 value 17278.761288 #> iter  390 value 17278.761287 #> iter  400 value 17278.761287 #> iter  410 value 17278.761287 #> iter  420 value 17278.761287 #> iter  430 value 17278.761287 #> iter  440 value 17278.761287 #> iter  450 value 17278.761287 #> iter  460 value 17278.761287 #> iter  470 value 17278.761287 #> iter  480 value 17278.761287 #> iter  490 value 17278.761287 #> iter  500 value 17278.761287 #> iter  510 value 17278.761287 #> iter  520 value 17278.761287 #> iter  530 value 17278.761287 #> final  value 17278.761287  #> converged # extract results  # regression coefficient vector res2$beta #> [1] -2.78454129  0.61702723 -0.06455763  0.53461080 -3.17474390  0.12808225 #> [7] -1.08644778   # check likelihood -ll(res2$beta) #> [1] -19536.01  # number of calls to log lik function # since optim does not return the number of # iterations res2$iter #> function gradient  #>      643      643   # optim does not calculated working weights head(res2$weights) #> [1] 1 # }"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":null,"dir":"Reference","previous_headings":"","what":"Single source capture-recapture models — estimatePopsize","title":"Single source capture-recapture models — estimatePopsize","text":"estimatePopsize first fits appropriate (v)glm model estimates full (observed unobserved) population size. types models assumed response vector (.e. dependent variable) corresponds number times given unit observed source. Population size usually estimated Horvitz-Thompson type estimator: \\[\\hat{N} = \\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)} =  \\sum_{k=1}^{N_{obs}}\\frac{1}{1-\\mathbb{P}(Y_{k}=0)}\\] \\(I_{k}=I_{Y_{k} > 0}\\) indicator variables, value 1 kth unit observed least 0 otherwise.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single source capture-recapture models — estimatePopsize","text":"","code":"estimatePopsize(   formula,   data,   model = c(\"ztpoisson\", \"ztnegbin\", \"ztgeom\", \"zotpoisson\", \"ztoipoisson\",     \"oiztpoisson\", \"ztHurdlepoisson\", \"Hurdleztpoisson\", \"zotnegbin\", \"ztoinegbin\",     \"oiztnegbin\", \"ztHurdlenegbin\", \"Hurdleztnegbin\", \"zotgeom\", \"ztoigeom\", \"oiztgeom\",     \"ztHurdlegeom\", \"ztHurdlegeom\", \"zelterman\", \"chao\"),   weights = NULL,   subset = NULL,   naAction = NULL,   method = c(\"optim\", \"IRLS\"),   popVar = c(\"analytic\", \"bootstrap\"),   controlMethod = NULL,   controlModel = NULL,   controlPopVar = NULL,   modelFrame = TRUE,   x = FALSE,   y = TRUE,   contrasts = NULL,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single source capture-recapture models — estimatePopsize","text":"formula formula model fitted, applied \"main\" linear predictor. single response models available. data data frame object coercible data.frame class containing data regression population size estimation. model model regression population estimate full description singleRmodels(). weights optional object priori weights used fitting model. subset logical vector indicating observations used regression population size estimation. evaluated data argument provided call. naAction yet implemented. method method fitting values currently supported: iteratively reweighted least squares (IRLS) maximum likelihood (optim). popVar method constructing confidence interval either analytic bootstrap. Bootstrap confidence interval type may specified controlPopVar. also third possible value noEst skips population size estimate together. controlMethod list indicating parameters use fitting model may constructed singleRcapture::controlMethod function. information included controlMethod(). controlModel list indicating additional formulas regression (like formula inflation parameter/dispersion parameter) may constructed singleRcapture::controlModel function. information eventually included controlModel(). controlPopVar list indicating parameters use estimating variance population size estimation may constructed singleRcapture::controlPopVar function. information included controlPopVar(). modelFrame, x, y logical value indicating whether return model matrix, dependent vector model matrix part output. contrasts yet implemented. ... additional optional arguments passed methods eg. estimatePopsize.fit.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single source capture-recapture models — estimatePopsize","text":"Returns object class c(\"singleR\", \"glm\", \"lm\") type list containing: y -- Vector dependent variable specified function call. X -- Model matrix specified function call. formula -- list formula provided call additional formulas specified controlModel. call -- Call matching original input. coefficients -- vector fitted coefficients regression. control -- list control parameters controlMethod controlModel, controlPopVar included populationSize. model -- Model estimation population size regression built, object class family. deviance -- Deviance model. priorWeights -- Prior weight provided call. weights -- IRLS method estimation chosen weights returned IRLS, otherwise priorWeights. residuals -- Vector raw residuals. logL -- Logarithm likelihood obtained final iteration. iter -- Numbers iterations performed fitting stats::optim used number call loglikelihood function. dfResiduals -- Residual degrees freedom. dfNull -- Null degrees freedom. fittValues -- Data frame fitted values mu (expected value) lambda (Poisson parameter). populationSize -- list containing information population size estimate. modelFrame -- Model frame specified call. linearPredictors -- Vector fitted linear predictors. trcount -- Number truncated observations. sizeObserved -- Number observations original model frame. terms -- terms attribute model frame used. contrasts -- contrasts specified function call. naAction -- naAction used. -- list indicating observations used regression/population size estimation. fittingLog -- log fitting information \"IRLS\" fitting specified controlMethod.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Single source capture-recapture models — estimatePopsize","text":"generalized linear model characterised equation \\[\\boldsymbol{\\eta}=\\boldsymbol{X}\\boldsymbol{\\beta}\\] \\(\\boldsymbol{X}\\) (lm) model matrix. vector generalized linear model similarly characterised equations \\[\\boldsymbol{\\eta}_{k}=\\boldsymbol{X}_{k}\\boldsymbol{\\beta}_{k}\\] \\(\\boldsymbol{X}_{k}\\) (lm) model matrix constructed appropriate formula (specified controlModel parameter). \\(\\boldsymbol{\\eta}\\) vector constructed : \\[\\boldsymbol{\\eta}=\\begin{pmatrix} \\boldsymbol{\\eta}_{1} \\cr  \\boldsymbol{\\eta}_{2} \\cr \\dotso \\cr \\boldsymbol{\\eta}_{p} \\end{pmatrix}^{T}\\] cases models package (vlm) model matrix constructed block matrix: \\[\\boldsymbol{X}_{vlm}= \\begin{pmatrix} \\boldsymbol{X}_{1} & \\boldsymbol{0} &\\dotso &\\boldsymbol{0}\\cr \\boldsymbol{0} & \\boldsymbol{X}_{2} &\\dotso &\\boldsymbol{0}\\cr \\vdots & \\vdots & \\ddots & \\vdots\\cr \\boldsymbol{0} & \\boldsymbol{0} &\\dotso &\\boldsymbol{X}_{p} \\end{pmatrix}\\] differs convention VGAM package (consider special cases vglm models) just convention affect model, convention taken makes fitting IRLS (explanation algorithm estimatePopsize.fit()) algorithm easier. (constraints matrixes vglm match ones implicitly use vglm model matrix differs respect order kronecker multiplication X constraints.) package use observed likelihood fit regression models. mentioned usually population size estimation done via: \\[\\hat{N} = \\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)} =  \\sum_{k=1}^{N_{obs}}\\frac{1}{1-\\mathbb{P}(Y_{k}=0)}\\] \\(I_{k}=I_{Y_{k} > 0}\\) indicator variables, value 1 k'th unit observed least 0 otherwise. \\(\\mathbb{P}(Y_{k}>0)\\) estimated maximum likelihood. following assumptions usually present using method estimation described : specified regression model correct. entails linear relationship independent variables dependent ones dependent variable generated appropriate distribution. unobserved heterogeneity. assumption broken possible (admittedly imperfect) workarounds see details singleRmodels(). population size constant relevant time frame. Depending confidence interval construction (asymptotic) normality \\(\\hat{N}\\) statistic assumed. two ways estimating variance estimate \\(\\hat{N}\\), first \"analytic\" usually done application law total variance \\(\\hat{N}\\): \\[\\text{var}(\\hat{N})=\\mathbb{E}\\left(\\text{var} \\left(\\hat{N}|I_{1},\\dots,I_{n}\\right)\\right)+ \\text{var}\\left(\\mathbb{E}(\\hat{N}|I_{1},\\dots,I_{n})\\right)\\] \\(\\delta\\) method \\(\\hat{N}|I_{1},\\dots I_{N}\\): \\[\\mathbb{E}\\left(\\text{var} \\left(\\hat{N}|I_{1},\\dots,I_{n}\\right)\\right)= \\left.\\left(\\frac{\\partial(N|I_1,\\dots,I_N)}{\\partial\\boldsymbol{\\beta}}\\right)^{T} \\text{cov}\\left(\\boldsymbol{\\beta}\\right) \\left(\\frac{\\partial(N|I_1,\\dots,I_N)}{\\partial\\boldsymbol{\\beta}}\\right) \\right|_{\\boldsymbol{\\beta}=\\hat{\\boldsymbol{\\beta}}}\\] \\(\\text{var}\\left(\\mathbb{E}(\\hat{N}|I_{1},\\dots,I_{n})\\right)\\) term may derived analytically (assume independence observations) since \\(\\hat{N}|I_{1},\\dots,I_{n}\\) just constant. general gives us: \\[ \\begin{aligned} \\text{var}\\left(\\mathbb{E}(\\hat{N}|I_{1},\\dots,I_{n})\\right)&= \\text{var}\\left(\\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)}\\right)\\cr &=\\sum_{k=1}^{N}\\text{var}\\left(\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)}\\right)\\cr &=\\sum_{k=1}^{N}\\frac{1}{\\mathbb{P}(Y_{k}>0)^{2}}\\text{var}(I_{k})\\cr &=\\sum_{k=1}^{N}\\frac{1}{\\mathbb{P}(Y_{k}>0)^{2}}\\mathbb{P}(Y_{k}>0)(1-\\mathbb{P}(Y_{k}>0))\\cr &=\\sum_{k=1}^{N}\\frac{1}{\\mathbb{P}(Y_{k}>0)}(1-\\mathbb{P}(Y_{k}>0))\\cr &\\approx\\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)^{2}}(1-\\mathbb{P}(Y_{k}>0))\\cr &=\\sum_{k=1}^{N_{obs}}\\frac{1-\\mathbb{P}(Y_{k}>0)}{\\mathbb{P}(Y_{k}>0)^{2}} \\end{aligned} \\] approximation 6th line appears 5th line sum units, includes unobserved units, since \\(I_{k}\\) independent \\(I_{k}\\sim b(\\mathbb{P}(Y_{k}>0))\\) 6th line unbiased estimator 5th line. method estimating variance \"bootstrap\", since \\(N_{obs}=\\sum_{k=1}^{N}I_{k}\\) also random variable bootstrap simple just drawing \\(N_{obs}\\) units data replacement just computing \\(\\hat{N}\\). Method described referred literature \"nonparametric\" bootstrap (see controlPopVar()), due ignoring variability observed sample size likely underestimate variance. sophisticated bootstrap procedure may described follows: Compute probability distribution : \\[ \\frac{\\hat{\\boldsymbol{f}}_{0}}{\\hat{N}},  \\frac{\\boldsymbol{f}_{1}}{\\hat{N}},  \\dots, \\frac{\\boldsymbol{f}_{\\max{y}}}{\\hat{N}}\\] \\(\\boldsymbol{f}_{n}\\) denotes observed marginal frequency units observed exactly n times, round quantities nearest integer necessary. Draw \\(\\hat{N}\\) units distribution (\\(\\hat{N}\\) integer draw \\(\\lfloor\\hat{N}\\rfloor + b(\\hat{N}-\\lfloor\\hat{N}\\rfloor)\\)). Truncated units \\(y=0\\). covariates draw original data replacement uniform distribution. example unit drawn new data \\(y=2\\) choose one covariate vectors original data associated unit observed 2 times. Regress \\(\\boldsymbol{y}_{new}\\) \\(\\boldsymbol{X}_{vlm new}\\) obtain \\(\\hat{\\boldsymbol{\\beta}}_{new}\\), starting point \\(\\hat{\\boldsymbol{\\beta}}\\) make slightly faster, use compute \\(\\hat{N}_{new}\\). Repeat 2-5 unit least B statistics obtained. Compute confidence intervals based alpha confType specified controlPopVar(). procedure known literature \"semiparametric\" bootstrap necessary assume correct estimate \\(\\hat{N}\\) order use type bootstrap. Lastly \"paramteric\" bootstrap assume probabilistic model used obtain \\(\\hat{N}\\) correct bootstrap procedure may described : Draw \\(\\hat{N}\\) covariate information vectors replacement data according probability distribution \\[\\frac{\\lfloor N_{k}\\rfloor + M_{k}}{\\lfloor\\hat{N}\\rfloor}\\] \\(M_{k}\\sim b(N_{k}-\\lfloor N_{k}\\rfloor)\\), \\(N_{k}\\) contribution kth unit .e. \\(\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)}\\) \\(\\lfloor\\cdot\\rfloor\\) floor function. Determine \\(\\boldsymbol{\\eta}\\) matrix using estimate \\(\\hat{\\boldsymbol{\\beta}}\\). Generate \\(\\boldsymbol{y}\\) (dependent variable) vector using \\(\\boldsymbol{\\eta}\\) probability mass function associated chosen model. Truncated units \\(y=0\\) construct \\(\\boldsymbol{y}_{new}\\) \\(\\boldsymbol{X}_{vlm new}\\). Regress \\(\\boldsymbol{y}_{new}\\) \\(\\boldsymbol{X}_{vlm new}\\) obtain \\(\\hat{\\boldsymbol{\\beta}}_{new}\\) use compute \\(\\hat{N}_{new}\\). Repeat 1-5 unit least B statistics obtained. Compute confidence intervals based alpha confType specified controlPopVar() also worth noting \"analytic\" method estimatePopsize uses \"standard\" covariance matrix estimation. possible improper covariance matrix estimate part estimation assumptions violated. cases post-hoc procedures implemented package address issue. Lastly confidence intervals \\(\\hat{N}\\) computed (analytic case) either assuming follows normal distribution variable \\(\\ln(N-\\hat{N})\\) follows normal distribution. estimates may found using either summary.singleR method popSizeEst.singleR function. labelled normal logNormal respectively.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Single source capture-recapture models — estimatePopsize","text":"General single source capture recapture literature: Zelterman, Daniel (1988). ‘Robust estimation truncated discrete distributions application capture-recapture experiments’. : Journal statistical planning inference 18.2, pp. 225–237. Heijden, Peter GM van der et al. (2003). ‘Point interval estimation population size using truncated Poisson regression model’. : Statistical Modelling 3.4, pp. 305–322. doi: 10.1191/1471082X03st057oa. Cruyff, Maarten J. L. F. Peter G. M. van der Heijden (2008). ‘Point Interval Estimation Population Size Using Zero-Truncated Negative Binomial Regression Model’. : Biometrical Journal 50.6, pp. 1035–1050. doi: 10.1002/bimj.200810455 Böhning, Dankmar Peter G. M. van der Heijden (2009). ‘covariate adjustment zero-truncated approaches estimating size hidden elusive populations’. : Annals Applied Statistics 3.2, pp. 595–610. doi: 10.1214/08-AOAS214. Böhning, Dankmar, Alberto Vidal-Diez et al. (2013). ‘Generalization Chao’s Estimator Covariate Information’. : Biometrics 69.4, pp. 1033– 1042. doi: 10.1111/biom.12082 Böhning, Dankmar Peter G. M. van der Heijden (2019). ‘identity zero-truncated, one-inflated likelihood zero-one-truncated likelihood general count densities application drink-driving Britain’. : Annals Applied Statistics 13.2, pp. 1198–1211. doi: 10.1214/18-AOAS1232. Navaratna WC, Del Rio Vilas VJ, Böhning D. Extending Zelterman's approach robust estimation population size zero-truncated clustered Data. Biom J. 2008 Aug;50(4):584-96. doi: 10.1002/bimj.200710441. Böhning D. equivalence one-inflated zero-truncated zero-truncated one-inflated count data likelihoods. Biom J. 2022 Aug 15. doi: 10.1002/bimj.202100343. Böhning, D., Friedl, H. Population size estimation based upon zero-truncated, one-inflated sparse count data. Stat Methods Appl 30, 1197–1217 (2021). doi: 10.1007/s10260-021-00556-8 Bootstrap: Zwane, PGM EN Van der Heijden, Implementing parametric bootstrap capture-recapture models continuous covariates 2003 Statistics & probability letters 65.2 pp 121-125 Norris, James L Pollock, Kenneth H Including model uncertainty estimating variances multiple capture studies 1996 Environmental Ecological Statistics 3.3 pp 235-244 Vector generalised linear models: Yee, T. W. (2015). Vector Generalized Linear Additive Models: Implementation R. New York, USA: Springer. ISBN 978-1-4939-2817-0.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Single source capture-recapture models — estimatePopsize","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/estimatePopsize.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Single source capture-recapture models — estimatePopsize","text":"","code":"# \\donttest{ # Model from 2003 publication  # Point and interval estimation of the # population size using the truncated Poisson regression mode # Heijden, Peter GM van der et al. (2003) model <- estimatePopsize(    formula = capture ~ gender + age + nation,     data = netherlandsimmigrant,     model = ztpoisson ) summary(model) #>  #> Call: #> estimatePopsize(formula = capture ~ gender + age + nation, data = netherlandsimmigrant,  #>     model = ztpoisson) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.486442 -0.486442 -0.298080  0.002093 -0.209444 13.910844  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.3411     0.2149  -6.241 4.35e-10 *** #> gendermale             0.3972     0.1630   2.436 0.014832 *   #> age>40yrs             -0.9746     0.4082  -2.387 0.016972 *   #> nationAsia            -1.0926     0.3016  -3.622 0.000292 *** #> nationNorth Africa     0.1900     0.1940   0.979 0.327398     #> nationRest of Africa  -0.9106     0.3008  -3.027 0.002468 **  #> nationSurinam         -2.3364     1.0136  -2.305 0.021159 *   #> nationTurkey          -1.6754     0.6028  -2.779 0.005445 **  #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 1712.901 #> BIC: 1757.213 #> Residual deviance: 1128.553 #>  #> Log-likelihood: -848.4504 on 1872 Degrees of freedom  #> Number of calls to log-likelihood function: 8 #> ----------------------- #> Population size estimation results:  #> Point estimate 12690.35 #> Observed proportion: 14.8% (N obs = 1880) #> Std. Error 2808.169 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      7186.444   18194.26 #> logNormal   8431.275   19718.32 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal     10.332927   26.16037 #> logNormal   9.534281   22.29793 # Graphical presentation of model fit plot(model, \"rootogram\")  # Statistical test # see documentation for summary.singleRmargin summary(marginalFreq(model), df = 1, \"group\") #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           50.06  1 1.5e-12 #> G-test                     34.31  1 4.7e-09 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been grouped  #> Names of cells used in calculating test(s) statistic: 1 2 3    modelSingleRcapture <- estimatePopsize(     formula = TOTAL_SUB ~ .,      data = farmsubmission,      model = ztnegbin,      method = \"IRLS\" ) # comparison with VGAM package, VGAM uses slightly different parametrisation # so we use negloglink instead of loglink for size parameter # i.e 1 / dispersion parameter if (require(VGAM)) {   modelVGAM <- vglm(      formula = TOTAL_SUB ~ .,       family = posnegbinomial(lsize = negloglink()),       data = farmsubmission   )   summary(modelVGAM) } #> Loading required package: VGAM #> Loading required package: stats4 #> Loading required package: splines #>  #> Call: #> vglm(formula = TOTAL_SUB ~ ., family = posnegbinomial(lsize = negloglink()),  #>     data = farmsubmission) #>  #> Coefficients:  #>               Estimate Std. Error z value Pr(>|z|)     #> (Intercept):1 -3.17076    0.26586 -11.926  < 2e-16 *** #> (Intercept):2  0.58194    0.07331   7.938 2.05e-15 *** #> log_size       0.63942    0.01750  36.535  < 2e-16 *** #> log_distance  -0.07985    0.02271  -3.515 0.000439 *** #> C_TYPEDairy    0.65965    0.03339  19.756  < 2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> Names of linear predictors: loglink(munb), negloglink(size) #>  #> Log-likelihood: -17264.37 on 24067 degrees of freedom #>  #> Number of Fisher scoring iterations: 8  #>  #> No Hauck-Donner effect found in any of the estimates #>  # Results are comparable summary(modelSingleRcapture) #>  #> Call: #> estimatePopsize(formula = TOTAL_SUB ~ ., data = farmsubmission,  #>     model = ztnegbin, method = \"IRLS\") #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.713383 -0.336369 -0.142528  0.000002  0.147598  7.014713  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>              Estimate Std. Error z value  P(>|z|)     #> (Intercept)  -3.17075    0.25944 -12.221  < 2e-16 *** #> log_size      0.63942    0.01771  36.108  < 2e-16 *** #> log_distance -0.07985    0.02228  -3.583 0.000339 *** #> C_TYPEDairy   0.65965    0.03412  19.332  < 2e-16 *** #> ----------------------- #> For linear predictors associated with: alpha  #>             Estimate Std. Error z value  P(>|z|)     #> (Intercept)  0.58193    0.07297   7.975 1.52e-15 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 34538.73 #> BIC: 34575.71 #> Residual deviance: 0 #>  #> Log-likelihood: -17264.37 on 24067 Degrees of freedom  #> Number of iterations: 9 #> ----------------------- #> Population size estimation results:  #> Point estimate 41020.34 #> Observed proportion: 29.3% (N obs = 12036) #> Std. Error 1887.714 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      37320.49   44720.19 #> logNormal   37550.34   44962.26 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      26.91402   32.25038 #> logNormal   26.76912   32.05297 summary(marginalFreq(modelSingleRcapture)) #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           30.91 26    0.23 #> G-test                     19.14 26    0.83 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been dropped  #> Names of cells used in calculating test(s) statistic: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19   # More advanced call that specifies additional formula and shows # in depth information about fitting procedure pseudoHurdleModel <- estimatePopsize(     formula = capture ~ nation + age,     data = netherlandsimmigrant,     model = Hurdleztgeom,     method = \"IRLS\",     controlMethod = controlMethod(verbose = 5),     controlModel = controlModel(piFormula = ~ gender) ) #> Iteration number 1 log-likelihood: -884.52524 #> Parameter vector:  -0.185410445 -0.263880409  0.056306931 -0.231199930 -0.339016183 -0.327635519 -0.196135239  0.670848267 -0.288900531 #> log-likelihood reduction:  129.2577 #> Value of gradient at current step: #>  -109.6131688  -27.3297089  -33.7540534  -21.6155174   -7.4027633  -10.1007372  -10.5519638   27.6542735   15.0062187 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.50748707 #> ---- #> Iteration number 2 log-likelihood: -838.29471 #> Parameter vector:  -0.78894466 -0.49414892  0.12654544 -0.41936921 -0.67177153 -0.62118201 -0.36628038  0.21382239 -0.49833888 #> log-likelihood reduction:  46.230532 #> Value of gradient at current step: #>   -9.2986457  -8.4448514  11.9660050  -5.4261467  -3.1887498  -3.5831268  -3.4007904 -15.7933504 -14.6132321 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.60353421 #> ---- #> Iteration number 3 log-likelihood: -827.3607 #> Parameter vector:  -1.21931395 -0.63137590  0.16239443 -0.50905713 -1.00036608 -0.83501186 -0.49385975 -0.50199082 -0.52839008 #> log-likelihood reduction:  10.934004 #> Value of gradient at current step: #>   4.530848334 -0.706818772  6.094992729  0.033497974 -0.920014881 -0.578730826 -0.448704228 -5.120996903 -4.375742516 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.71581321 #> ---- #> Iteration number 4 log-likelihood: -827.02171 #> Parameter vector:  -1.28115433 -0.65547993  0.16416111 -0.51727106 -1.18177463 -0.89567550 -0.52235421 -0.63935485 -0.52639483 #> log-likelihood reduction:  0.33899271 #> Value of gradient at current step: #>  -0.0798924040 -0.0146700645  0.1065046364  0.0063805055 -0.1495363455 -0.0225332569 -0.0157025920  0.0209555100  0.0109299318 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.18140855 #> ---- #> Iteration number 5 log-likelihood: -827.01869 #> Parameter vector:  -1.28171634 -0.65569704  0.16448478 -0.51702657 -1.21974330 -0.89780515 -0.52284164 -0.64023545 -0.52641227 #> log-likelihood reduction:  0.003018031 #> Value of gradient at current step: #>  -0.007904755912 -0.000094319999  0.000164595894 -0.000029799741 -0.007760295818  0.000002109001  0.003006520345  0.002591091918  0.002021279952 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.037968669 #> ---- #> Iteration number 6 log-likelihood: -827.01868 #> Parameter vector:  -1.28177894 -0.65568567  0.16449545 -0.51701624 -1.22185057 -0.89779665 -0.52264205 -0.64032940 -0.52640247 #> log-likelihood reduction:  0.0000088199181 #> Value of gradient at current step: #>  -0.0000833659942 -0.0000339029369  0.0000351898282  0.0000184580446 -0.0001780533739  0.0000048832950  0.0002239816838  0.0000077137072  0.0000060320678 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.002107269 #> ---- #> Iteration number 7 log-likelihood: -827.01868 #> Parameter vector:  -1.28177963 -0.65568706  0.16449478 -0.51701663 -1.22190033 -0.89779718 -0.52262886 -0.64033169 -0.52640214 #> log-likelihood reduction:  0.0000000061006631 #> Value of gradient at current step: #>   0.0000004044173547 -0.0000019897798298  0.0000008423618603  0.0000011366601189 -0.0000045718812499  0.0000002750070187  0.0000076532957665  0.0000000051235394  0.0000000041143737 #> Algorithm will terminate if one of following conditions will be met: #> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08  #> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon. #> At current step the highest change was: 0.000049760582 #> ---- #> Value of analytically computed hessian at fitted regression coefficients: #>              [,1]       [,2]       [,3]        [,4]      [,5]       [,6] #>  [1,] -600.647574 -45.430239 -437.78549 -46.3057502 -3.648628 -9.9715728 #>  [2,]  -45.430239 -45.430239    0.00000   0.0000000  0.000000  0.0000000 #>  [3,] -437.785489   0.000000 -437.78549   0.0000000  0.000000  0.0000000 #>  [4,]  -46.305750   0.000000    0.00000 -46.3057502  0.000000  0.0000000 #>  [5,]   -3.648628   0.000000    0.00000   0.0000000 -3.648628  0.0000000 #>  [6,]   -9.971573   0.000000    0.00000   0.0000000  0.000000 -9.9715728 #>  [7,]  -17.976679  -2.320731  -11.24211  -0.6903135 -2.003224 -0.2486646 #>  [8,]  328.022452  23.801162  241.35686  24.3769255  1.870674  5.1505623 #>  [9,]  280.048800  20.260809  211.90055  19.7419673  1.462131  4.6637716 #>              [,7]        [,8]        [,9] #>  [1,] -17.9766790  328.022452  280.048800 #>  [2,]  -2.3207313   23.801162   20.260809 #>  [3,] -11.2421149  241.356857  211.900547 #>  [4,]  -0.6903135   24.376925   19.741967 #>  [5,]  -2.0032237    1.870674    1.462131 #>  [6,]  -0.2486646    5.150562    4.663772 #>  [7,] -17.9766790    9.477659    8.492251 #>  [8,]   9.4776585 -197.098079 -168.419176 #>  [9,]   8.4922514 -168.419176 -168.419176 #> The matrix above has the following eigen values: #>  -3.121077 -6.868861 -9.331036 -16.61098 -18.10422 -33.99724 -45.94396 -112.7247 -1280.581  summary(pseudoHurdleModel) #>  #> Call: #> estimatePopsize(formula = capture ~ nation + age, data = netherlandsimmigrant,  #>     model = Hurdleztgeom, method = \"IRLS\", controlMethod = controlMethod(verbose = 5),  #>     controlModel = controlModel(piFormula = ~gender)) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.428461 -0.428461 -0.288574  0.004918 -0.181672 13.696148  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.2818     0.1858  -6.899 5.22e-12 *** #> nationAsia            -0.6557     0.1994  -3.289  0.00101 **  #> nationNorth Africa     0.1645     0.1417   1.161  0.24561     #> nationRest of Africa  -0.5170     0.1979  -2.612  0.00900 **  #> nationSurinam         -1.2219     0.5552  -2.201  0.02775 *   #> nationTurkey          -0.8978     0.3439  -2.611  0.00903 **  #> age>40yrs             -0.5226     0.2469  -2.117  0.03429 *   #> ----------------------- #> For linear predictors associated with: pi  #>             Estimate Std. Error z value P(>|z|)    #> (Intercept)  -0.6403     0.2945  -2.174 0.02969 *  #> gendermale   -0.5264     0.2043  -2.577 0.00996 ** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 1672.037 #> BIC: 1721.889 #> Residual deviance: 1492.301 #>  #> Log-likelihood: -827.0187 on 3751 Degrees of freedom  #> Number of iterations: 7 #> ----------------------- #> Population size estimation results:  #> Point estimate 6446.833 #> Observed proportion: 29.2% (N obs = 1880) #> Std. Error 1126.716 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      4238.511   8655.156 #> logNormal   4715.983   9234.051 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      21.72116   44.35520 #> logNormal   20.35943   39.86443 # Assessing model fit plot(pseudoHurdleModel, \"rootogram\")  summary(marginalFreq(pseudoHurdleModel), \"group\", df = 1) #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test            1.89  1    0.17 #> G-test                      2.13  1    0.14 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been grouped  #> Names of cells used in calculating test(s) statistic: 1 2 3 4     # A advanced input with additional information for fitting procedure and # additional formula specification and different link for inflation parameter. Model <- estimatePopsize(    formula = TOTAL_SUB ~ .,     data = farmsubmission,     model = oiztgeom(omegaLink = \"cloglog\"),     method = \"IRLS\",     controlMethod = controlMethod(       stepsize = .15,        momentumFactor = 1.8,       epsilon = 1e-12,        silent = TRUE    ),    controlModel = controlModel(omegaFormula = ~ .) ) summary(marginalFreq(Model), df = 18 - length(Model$coefficients)) #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           55.12 10 3.0e-08 #> G-test                     23.43 10 9.3e-03 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been dropped  #> Names of cells used in calculating test(s) statistic: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  summary(Model) #>  #> Call: #> estimatePopsize(formula = TOTAL_SUB ~ ., data = farmsubmission,  #>     model = oiztgeom(omegaLink = \"cloglog\"), method = \"IRLS\",  #>     controlMethod = controlMethod(stepsize = 0.15, momentumFactor = 1.8,  #>         epsilon = 1e-12, silent = TRUE), controlModel = controlModel(omegaFormula = ~.)) #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.898657 -0.644688 -0.442511  0.005553  0.294325 20.748941  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>              Estimate Std. Error z value P(>|z|)     #> (Intercept)  -2.86133    0.26004 -11.004 < 2e-16 *** #> log_size      0.62841    0.01864  33.721 < 2e-16 *** #> log_distance -0.06302    0.02237  -2.817 0.00485 **  #> C_TYPEDairy   0.50634    0.04225  11.985 < 2e-16 *** #> ----------------------- #> For linear predictors associated with: omega  #>              Estimate Std. Error z value  P(>|z|)     #> (Intercept)   -6.9281     2.6519  -2.612 0.008989 **  #> log_size       0.4609     0.1320   3.491 0.000481 *** #> log_distance   0.1665     0.2240   0.743 0.457281     #> C_TYPEDairy   -1.4531     0.5393  -2.694 0.007053 **  #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 34581.24 #> BIC: 34640.4 #> Residual deviance: 12326.56 #>  #> Log-likelihood: -17282.62 on 24064 Degrees of freedom  #> Number of iterations: 95 #> ----------------------- #> Population size estimation results:  #> Point estimate 27192.57 #> Observed proportion: 44.3% (N obs = 12036) #> Std. Error 906.9658 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      25414.95   28970.19 #> logNormal   25516.65   29076.84 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      41.54616   47.35796 #> logNormal   41.39376   47.16921 # }"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/farmsubmission.html","id":null,"dir":"Reference","previous_headings":"","what":"British farm submissions data — farmsubmission","title":"British farm submissions data — farmsubmission","text":"Data British animal farms submissions AHVLA. British farms able submit samples AHVLA cause death animal determined private veterinary surgeon decides submit , unless notifiable disease suspected submission required. data set contains information farms. submissions farms included data frame carcasses also blood samples etc.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/farmsubmission.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"British farm submissions data — farmsubmission","text":"","code":"data(\"farmsubmission\")"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/farmsubmission.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"British farm submissions data — farmsubmission","text":"Data frame 12,036 rows 4 columns. TOTAL_SUB Number submissions animal material. log_size Numerical value equal logarithm size farm. log_distance Numerical value equal logarithm distance nearest AHVLA center. C_TYPE Factor describing type activity farm animals used . Either Dairy Beef","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/farmsubmission.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"British farm submissions data — farmsubmission","text":"data set description provided publication: Böhning, D., Vidal Diez, ., Lerdsuwansri, R., Viwatwongkasem, C., Arnold, M. (2013). \"generalization Chao's estimator covariate information\". Biometrics, 69(4), 1033-1042. doi:10.1111/biom.12082","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":null,"dir":"Reference","previous_headings":"","what":"Observed and fitted marginal Frequencies — marginalFreq","title":"Observed and fitted marginal Frequencies — marginalFreq","text":"function given fitted singleR class object computed marginal frequencies sum probability density functions unit data point .e. kth element marginal frequency table given \\(\\sum_{j=1}^{N_{obs}}\\mathbb{P}(Y_{j}=k|\\eta_{j})\\). k=0 (specified call) computed \\(\\hat{N}-N_{obs}\\) \\(\\boldsymbol{f}_{0}\\) assumed unobserved part studied population. frequencies useful diagnostics count data regression, assessment fit.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Observed and fitted marginal Frequencies — marginalFreq","text":"","code":"marginalFreq(   object,   includeones = TRUE,   includezeros = TRUE,   onecount = NULL,   range,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Observed and fitted marginal Frequencies — marginalFreq","text":"object object singleR class. includeones logical value indicating whether include estimated number zero counts. includezeros logical value indicating whether include one counts zero-one truncated models. onecount numeric value indicating number one counts null trcount object assumed number one counts. range optional argument specifying range selected Y values. ... currently nothing.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Observed and fitted marginal Frequencies — marginalFreq","text":"list observed name fitted model family degrees freedom observed fitted marginal frequencies.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/marginalFreq.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Observed and fitted marginal Frequencies — marginalFreq","text":"Piotr Chlebicki","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/netherlandsimmigrant.html","id":null,"dir":"Reference","previous_headings":"","what":"Data on immigration in Netherlands — netherlandsimmigrant","title":"Data on immigration in Netherlands — netherlandsimmigrant","text":"data set contains information immigrants four cities (Amsterdam, Rotterdam, Hague Utrecht) Netherlands staying country illegally 1995 appeared police records year.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/netherlandsimmigrant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data on immigration in Netherlands — netherlandsimmigrant","text":"","code":"data(\"netherlandsimmigrant\")"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/netherlandsimmigrant.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data on immigration in Netherlands — netherlandsimmigrant","text":"Data frame 1,880 rows 5 columns. capture Number times person captured police. gender Factor describing gender apprehended person. age Factor describing age apprehended person. Either bellow 40 years old. reason Factor describing reason apprehended police either illegal stay Netherlands reasons. nation Factor nation origin captured person. 6 levels variable: \"American Australia\",   \"Asia\", \"North Africa\", \"Rest Africa\", \"Surinam\", \"Turkey\".","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/netherlandsimmigrant.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Data on immigration in Netherlands — netherlandsimmigrant","text":"data set description provided publication: van Der Heijden, P. G., Bustami, R., Cruyff, M. J., Engbersen, G., Van Houwelingen, H. C. (2003). Point interval estimation population size using truncated Poisson regression model. Statistical Modelling, 3(4), 305-322. doi:10.1191/1471082X03st057oa","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Diagnostic plots for regression and population size estimation. — plot.singleR","title":"Diagnostic plots for regression and population size estimation. — plot.singleR","text":"Simple diagnostic plots singleR class objects.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Diagnostic plots for regression and population size estimation. — plot.singleR","text":"","code":"# S3 method for singleR plot(   x,   plotType = c(\"qq\", \"marginal\", \"fitresid\", \"bootHist\", \"rootogram\", \"dfpopContr\",     \"dfpopBox\", \"scaleLoc\", \"cooks\", \"hatplot\", \"strata\"),   confIntStrata = c(\"normal\", \"logNormal\"),   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Diagnostic plots for regression and population size estimation. — plot.singleR","text":"x object singleR class. plotType character parameter specifying type plot made. following list presents briefly explains possible type plots: qq -- quantile-quantile plot pearson residuals (standardised pearson residuals available model) .e. empirical quantiles residuals plotted theoretical quantiles standard distribution. marginal -- plot made matplot fitted observed marginal frequencies labels. fitresid -- Plot fitted linear predictors (standardised) pearson residuals. bootHist -- Simple histogram statistics obtained bootstrapping (one performed statistics saved). rootogram -- Rootogram, full explanation see: Kleiber Zeileis Visualizing Count Data Regressions Using Rootograms (2016), short barplot height square root observed marginal frequencies adjusted difference square root observed fitted marginal frequencies connected line representing fitted marginal frequencies. less difference 0 line beginning bar accurate fitt produced model. dfpopContr -- Plot dfpopsize unit contribution. plot y = x line .e. deletion effect removing unit model effect regression coefficients. away observation line influential . dfpopBox -- Boxplot dfpopsize getting general idea distribution \"influence\" unit population size estimate. scaleLoc -- scale - location plot .e. square root absolute values (standardised) pearson residuals linear predictors column linear predictors. cooks -- Plot cooks distance detecting influential observations. hatplot -- Plot hat values linear predictor detecting influential observations. strata -- Plot confidence invervals point estimates stratas provided ... argument confIntStrata confidence interval type use strata plot. Currently supported values \"normal\" \"logNormal\". ... additional optional arguments passed following functions: plotType = \"bootHist\" graphics::hist -- x, main, xlab, ylab parameters fixed. plotType = \"rootogram\" graphics::barplot -- height, offset, ylab, xlab, ylim parameters fixed. graphics::lines -- x, y, pch, type, lwd, col parameters fixed. plotType = \"dfpopContr\" dfpopsize -- model, observedPop parameters fixed. plot.default -- x, y, xlab, main parameters fixed. plotType = \"dfpopBox\" dfpopsize -- model, observedPop parameters fixed. graphics::boxplot -- x, ylab, main parameters fixed. plotType = \"scaleLoc\" plot.default -- x, y, xlab, ylab, main, sub parameters fixed. plotType = \"fitresid\" plot.default -- x, y, xlab, ylab, main, sub parameters fixed. plotType = \"cooks\" plot.default -- x, xlab, ylab, main parameters fixed. plotType = \"hatplot\" hatvalues.singleR plot.default -- x, xlab, ylab, main parameters fixed. plotType = \"strata\" stratifyPopsize.singleR","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Diagnostic plots for regression and population size estimation. — plot.singleR","text":"return value plot made.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/plot.singleR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Diagnostic plots for regression and population size estimation. — plot.singleR","text":"Piotr Chlebicki","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/popSizeEst.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract population size estimation results. — popSizeEst","title":"Extract population size estimation results. — popSizeEst","text":"extractor function singleR method extracting important information regarding pop size estimate.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/popSizeEst.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract population size estimation results. — popSizeEst","text":"","code":"popSizeEst(object, ...)  # S3 method for singleR popSizeEst(object, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/popSizeEst.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract population size estimation results. — popSizeEst","text":"object object population size estimates. ... additional optional arguments, currently used singleR class method.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/popSizeEst.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract population size estimation results. — popSizeEst","text":"object class popSizeEstResults containing population size estimation results.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/predict.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict method for singleR class — predict.singleR","title":"Predict method for singleR class — predict.singleR","text":"method predict function, works analogous predict.glm gives possibility get standard errors mean/distribution parameters directly get pop size estimates new data.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/predict.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict method for singleR class — predict.singleR","text":"","code":"# S3 method for singleR predict(   object,   newdata,   type = c(\"response\", \"link\", \"mean\", \"popSize\", \"contr\"),   se.fit = FALSE,   na.action = NULL,   weights,   cov,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/predict.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict method for singleR class — predict.singleR","text":"object object singleR class. newdata optional data.frame containing new data. type type prediction required, possible values : \"response\"-- matrix containing estimated distributions parameters. \"link\"    -- matrix linear predictors. \"mean\"    -- fitted values \\(Y\\) \\(Y|Y>0\\). \"contr\"   -- inverse probability weights (named observation contribution population size estimate). \"popSize\" -- population size estimation. Note results call redoPopEstimation usually better call function directly. default set \"response\". se.fit logical value indicating whether standard errors computed. matters type \"response\", \"mean\", \"link\". na.action nothing yet. weights optional vector weights type \"contr\", \"popSize\". cov optional matrix function character specifying either covariance matrix function compute covariance matrix. default vcov.singleR can set e.g. vcovHC. ... arguments passed functions, now affects vcov.singleR method cov function.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/predict.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict method for singleR class — predict.singleR","text":"Depending type argument one \"response\", \"link\", \"mean\" matrix fitted values possibly standard errors se.fit argument set TRUE, type set \"contr\" vector inverses probabilities, finally \"popSize\" object class popSizeEstResults methods containing population size estimation results.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/predict.singleR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict method for singleR class — predict.singleR","text":"Standard errors computed assumption regression coefficients asymptotically normally distributed, assumption holds linear predictors .e. row \\(\\boldsymbol{\\eta}=\\boldsymbol{X}_{vlm}\\boldsymbol{\\beta}\\) asymptotically normally distributed variances expressed well known formula. mean \\(\\mu\\) distribution parameters differentiable functions asymptotically normally distributed variables therefore variances can computed using (multivariate) delta method.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":null,"dir":"Reference","previous_headings":"","what":"Updating population size estimation results. — redoPopEstimation","title":"Updating population size estimation results. — redoPopEstimation","text":"function applies post-hoc procedures taken (heteroscedastic consistent covariance matrix estimation bias reduction) population size estimation standard error estimation.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Updating population size estimation results. — redoPopEstimation","text":"","code":"redoPopEstimation(object, newdata, ...)  # S3 method for singleR redoPopEstimation(object, newdata, cov, weights, coef, control, popVar, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Updating population size estimation results. — redoPopEstimation","text":"object object update population size estimation results done. newdata optional data.frame new data pop size estimation. ... additional optional arguments, currently used singleR class method. cov updated covariance matrix estimate. weights optional vector weights use population size estimation. coef optional vector coefficients regression base population size estimation. missing set coef(object). control similar controlPopVar estimatePopsize(). missing set controls provided call object. popVar similar popVar estimatePopsize(). missing set \"analytic\".","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Updating population size estimation results. — redoPopEstimation","text":"object class popSizeEstResults containing updated population size estimation results.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/redoPopEstimation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Updating population size estimation results. — redoPopEstimation","text":"","code":"# Create simple model Model <- estimatePopsize(   formula = capture ~ nation + gender,    data = netherlandsimmigrant,    model = ztpoisson,    method = \"IRLS\" ) # Apply heteroscedasticity consistent covariance matrix estimation require(sandwich) #> Loading required package: sandwich cov <- vcovHC(Model, type = \"HC3\") summary(Model, cov = cov, popSizeEst = redoPopEstimation(Model, cov = cov)) #>  #> Call: #> estimatePopsize(formula = capture ~ nation + gender, data = netherlandsimmigrant,  #>     model = ztpoisson, method = \"IRLS\") #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.479668 -0.479668 -0.351833  0.000449 -0.225717 14.058858  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.3977     0.2553  -5.475 4.37e-08 *** #> nationAsia            -1.0560     0.3940  -2.680  0.00736 **  #> nationNorth Africa     0.2327     0.2399   0.970  0.33200     #> nationRest of Africa  -0.8864     0.3514  -2.523  0.01164 *   #> nationSurinam         -2.3519     1.0273  -2.289  0.02205 *   #> nationTurkey          -1.6845     0.6110  -2.757  0.00583 **  #> gendermale             0.3833     0.2014   1.904  0.05695 .   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 1718.993 #> BIC: 1757.766 #> Residual deviance: 1136.645 #>  #> Log-likelihood: -852.4963 on 1873 Degrees of freedom  #> Number of iterations: 8 #> ----------------------- #> Population size estimation results:  #> Point estimate 11879.92 #> Observed proportion: 15.8% (N obs = 1880) #> Std. Error 2531.196 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      6918.872   16840.98 #> logNormal   8015.862   18177.38 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      11.16325   27.17206 #> logNormal   10.34252   23.45350 # Compare to results with usual covariance matrix estimation summary(Model) #>  #> Call: #> estimatePopsize(formula = capture ~ nation + gender, data = netherlandsimmigrant,  #>     model = ztpoisson, method = \"IRLS\") #>  #> Pearson Residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -0.479668 -0.479668 -0.351833  0.000449 -0.225717 14.058858  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>                      Estimate Std. Error z value  P(>|z|)     #> (Intercept)           -1.3977     0.2146  -6.514 7.33e-11 *** #> nationAsia            -1.0560     0.3016  -3.501 0.000464 *** #> nationNorth Africa     0.2327     0.1939   1.200 0.230002     #> nationRest of Africa  -0.8864     0.3009  -2.946 0.003224 **  #> nationSurinam         -2.3519     1.0137  -2.320 0.020337 *   #> nationTurkey          -1.6845     0.6029  -2.794 0.005203 **  #> gendermale             0.3833     0.1630   2.352 0.018686 *   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 1718.993 #> BIC: 1757.766 #> Residual deviance: 1136.645 #>  #> Log-likelihood: -852.4963 on 1873 Degrees of freedom  #> Number of iterations: 8 #> ----------------------- #> Population size estimation results:  #> Point estimate 11879.92 #> Observed proportion: 15.8% (N obs = 1880) #> Std. Error 2448.792 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      7080.380   16679.47 #> logNormal   8111.333   17927.69 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      11.27134   26.55225 #> logNormal   10.48657   23.17745  ## get confidence interval with larger significance level redoPopEstimation(Model, control = controlPopVar(alpha = .000001)) #> Point estimate: 11879.92 #> Variance: 5996583 #> 99.9999% confidence intervals: #>           lowerBound upperBound #> normal      1880.000   23858.53 #> logNormal   4951.313   34438.87"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Regression diagnostics in singleRcapture — dfpopsize","title":"Regression diagnostics in singleRcapture — dfpopsize","text":"List regression diagnostics implemented singleR class. Functions either require changes glm class relevant context singleRcapture omitted.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regression diagnostics in singleRcapture — dfpopsize","text":"","code":"dfpopsize(model, ...)  # S3 method for singleR hatvalues(model, ...)  # S3 method for singleR dfbeta(model, maxitNew = 1, ...)  # S3 method for singleR residuals(   object,   type = c(\"pearson\", \"pearsonSTD\", \"response\", \"working\", \"deviance\", \"all\"),   ... )  # S3 method for singleR cooks.distance(model, ...)  # S3 method for singleR dfpopsize(model, dfbeta = NULL, observedPop = FALSE, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regression diagnostics in singleRcapture — dfpopsize","text":"model, object object singleR class. ... arguments passed methods. Notably dfpopsize.singleR calls dfbeta.singleR dfbeta argument provided controlMethod called dfbeta method. maxitNew maximal number iterations regressions starting points \\(\\hat{\\boldsymbol{\\beta}}\\) data specified call model removal k'th row. default 1. type type residual return. dfbeta dfbeta already obtained possible pass function need computed second time. observedPop logical. singleR class object set TRUE indicates 1 returned units take part population size estimation (e.g. 1's zero one truncated models units count => 3 zelterman basic chao model) set FALSE (default) units included results.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regression diagnostics in singleRcapture — dfpopsize","text":"hatvalues -- matrix n rows p columns n number observations data p number regression parameters. dfpopsize -- vector k'th element corresponds difference point estimate population size estimation full data set point estimate population size estimation removal k'th unit data set. dfbeta -- matrix n rows p observations p number units data p number regression parameters. K'th row matrix corresponds \\(\\hat{\\boldsymbol{\\beta}}-\\hat{\\boldsymbol{\\beta}}_{-k}\\) \\(\\hat{\\boldsymbol{\\beta}}_{-k}\\) vector estimates regression parameters removal k'th row data. cooks.distance -- matrix single columns values cooks distance every unit model.matrix residuals.singleR -- data.frame chosen residuals.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Regression diagnostics in singleRcapture — dfpopsize","text":"dfpopsize dfbeta closely related. dfbeta fits regression removing specific row data returns difference regression coefficients estimated full data set data set obtained deletion row, repeats procedure every unit present data.dfpopsize population size estimation utilising coefficients computed dfbeta. cooks.distance implemented (now) models single linear predictor works exactly like method glm class. residuals.singleR (can abbreviated resid) works like residuals.glm exception : \"pearson\" -- returns non standardised residuals. \"pearsonSTD\" -- currently defined single predictors models extended models near future, families one distribution parameter multivariate residual. \"response\" -- returns residuals computed truncated non truncated fitted value. \"working\" -- possibly multivariate one linear predictor present. \"deviance\" -- yet defined families singleRmodels() e.g. negative binomial based methods. \"\" -- returns available residual types. hatvalues.singleR method singleR class extracting diagonal elements projection matrix. Since singleRcapture supports regular glm's also vglm's hatvalues returns matrix number columns corresponding number linear predictors model, kth column corresponds elements diagonal projection matrix associated kth linear predictor. glm's \\[\\boldsymbol{W}^{\\frac{1}{2}}\\boldsymbol{X} \\left(\\boldsymbol{X}^{T}\\boldsymbol{W}\\boldsymbol{X}\\right)^{-1} \\boldsymbol{X}^{T}\\boldsymbol{W}^{\\frac{1}{2}}\\] : \\(\\boldsymbol{W}=\\mathbb{E}\\left(\\text{Diag} \\left(\\frac{\\partial^{2}\\ell}{\\partial\\boldsymbol{\\eta}^{T} \\partial\\boldsymbol{\\eta}}\\right)\\right)\\) \\(\\boldsymbol{X}\\) model (lm) matrix. vglm's present package instead : \\[\\boldsymbol{X}_{vlm} \\left(\\boldsymbol{X}_{vlm}^{T}\\boldsymbol{W}\\boldsymbol{X}_{vlm}\\right)^{-1} \\boldsymbol{X}_{vlm}^{T}\\boldsymbol{W}\\] : \\[ \\boldsymbol{W} = \\mathbb{E}\\left(\\begin{bmatrix} \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{1}^{T}\\partial\\eta_{1}}\\right) & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{1}^{T}\\partial\\eta_{2}}\\right) & \\dotso & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{1}^{T}\\partial\\eta_{p}}\\right)\\cr \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{2}^{T}\\partial\\eta_{1}}\\right) & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{2}^{T}\\partial\\eta_{2}}\\right) & \\dotso & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{2}^{T}\\partial\\eta_{p}}\\right)\\cr \\vdots & \\vdots & \\ddots & \\vdots\\cr \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{p}^{T}\\partial\\eta_{1}}\\right) & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{p}^{T}\\partial\\eta_{2}}\\right) & \\dotso & \\text{Diag}\\left(\\frac{\\partial^{2}\\ell}{\\partial\\eta_{p}^{T}\\partial\\eta_{p}}\\right) \\end{bmatrix}\\right)\\] block matrix constructed taking expected  value diagonal matrixes corresponding second derivatives respect linear predictor (mixed derivatives) \\(\\boldsymbol{X}_{vlm}\\) model (vlm) matrix constructed using specifications controlModel call estimatePopsize.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Regression diagnostics in singleRcapture — dfpopsize","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/regDiagSingleR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Regression diagnostics in singleRcapture — dfpopsize","text":"","code":"# \\donttest{ # For singleR class # Get simple model Model <- estimatePopsize(   formula = capture ~ nation + age + gender,    data = netherlandsimmigrant,    model = ztpoisson,    method = \"IRLS\" ) # Get df beta dfb <- dfbeta(Model) # The results res <- dfpopsize(Model, dfbeta = dfb) summary(res) #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -4236.412     2.664     2.664     5.448    17.284   117.448  plot(res)  # It is also possible to not provide dfbeta then they will be # computed manually summary(dfpopsize(Model)) #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -4236.412     2.664     2.664     5.448    17.284   117.448  # }"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":null,"dir":"Reference","previous_headings":"","what":"Family functions in singleRcapture package — chao","title":"Family functions in singleRcapture package — chao","text":"Package singleRcapture utilises various family type functions specify variable parts population size estimation, regression, diagnostics necessary information depends model. functions used model argument estimatePopsize function.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Family functions in singleRcapture package — chao","text":"","code":"chao(lambdaLink = \"loghalf\", ...)  Hurdleztgeom(   lambdaLink = c(\"log\", \"neglog\"),   piLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  Hurdleztnegbin(   nSim = 1000,   epsSim = 1e-08,   eimStep = 6,   lambdaLink = c(\"log\", \"neglog\"),   alphaLink = c(\"log\", \"neglog\"),   piLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  Hurdleztpoisson(   lambdaLink = c(\"log\", \"neglog\"),   piLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  oiztgeom(   lambdaLink = c(\"log\", \"neglog\"),   omegaLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  oiztnegbin(   nSim = 1000,   epsSim = 1e-08,   eimStep = 6,   lambdaLink = c(\"log\", \"neglog\"),   alphaLink = c(\"log\", \"neglog\"),   omegaLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  oiztpoisson(   lambdaLink = c(\"log\", \"neglog\"),   omegaLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  zelterman(lambdaLink = \"loghalf\", ...)  zotgeom(lambdaLink = c(\"log\", \"neglog\"), ...)  zotnegbin(   nSim = 1000,   epsSim = 1e-08,   lambdaLink = c(\"log\", \"neglog\"),   alphaLink = c(\"log\", \"neglog\"),   ... )  zotpoisson(lambdaLink = c(\"log\", \"neglog\"), ...)  ztHurdlegeom(   lambdaLink = c(\"log\", \"neglog\"),   piLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  ztHurdlenegbin(   nSim = 1000,   epsSim = 1e-08,   eimStep = 6,   lambdaLink = c(\"log\", \"neglog\"),   alphaLink = c(\"log\", \"neglog\"),   piLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  ztHurdlepoisson(   lambdaLink = c(\"log\", \"neglog\"),   piLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  ztgeom(lambdaLink = c(\"log\", \"neglog\"), ...)  ztnegbin(   nSim = 1000,   epsSim = 1e-08,   eimStep = 6,   lambdaLink = c(\"log\", \"neglog\"),   alphaLink = c(\"log\", \"neglog\"),   ... )  ztoigeom(   lambdaLink = c(\"log\", \"neglog\"),   omegaLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  ztoinegbin(   nSim = 1000,   epsSim = 1e-08,   eimStep = 6,   lambdaLink = c(\"log\", \"neglog\"),   alphaLink = c(\"log\", \"neglog\"),   omegaLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  ztoipoisson(   lambdaLink = c(\"log\", \"neglog\"),   omegaLink = c(\"logit\", \"cloglog\", \"probit\"),   ... )  ztpoisson(lambdaLink = c(\"log\", \"neglog\"), ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Family functions in singleRcapture package — chao","text":"lambdaLink link Poisson parameter, \"log\" default except zelterman's chao's models \\(\\ln\\left(\\frac{x}{2}\\right)\\) possible. ... Additional arguments, used now. piLink link probability parameter,  \"logit\" default nSim, epsSim working weights computed analytically arguments specify maximum number simulations allowed precision level finding numerically respectively. eimStep non negative integer describing many values used step approximation information matrixes analytic solution available (e.g. \"ztnegbin\"), default varies depending function. Higher value usually means faster convergence may potentially cause issues convergence. alphaLink link dispersion parameter, \"log\" default omegaLink link inflation parameter, \"logit\" default","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Family functions in singleRcapture package — chao","text":"object class family containing objects: makeMinusLogLike -- factory function creating \\(\\ell(\\boldsymbol{\\beta}), \\frac{\\partial\\ell}{\\partial\\boldsymbol{\\beta}}, \\frac{\\partial^{2}\\ell}{\\partial\\boldsymbol{\\beta}^{T}\\partial\\boldsymbol{\\beta}} \\) functions \\(\\boldsymbol{y}\\) vector \\(\\boldsymbol{X}_{vlm}\\) (just \\(\\boldsymbol{X}\\) applied model single linear predictor) argument deriv possible values 0, 1, 2 provides derivative return 0 just minus log-likelihood. links -- List link functions. mu.eta, variance -- Functions linear predictors return expected value variance. type argument 2 possible values \"trunc\" \"nontrunc\" specifies whether return \\(\\mathbb{E}(Y|Y>0), \\text{var}(Y|Y>0)\\) \\(\\mathbb{E}(Y), \\text{var}(Y)\\) respectively. family -- Character specifies name model. valideta, validmu -- now returns true. near future used check whether applied linear predictors valid (.e. transformed elements parameter space subjected inverse link function). funcZ, Wfun -- Functions create pseudo residuals working weights used IRLS algorithm. devResids -- Function given linear predictors prior weights vector response vector returns deviance residuals. family functions functions implemented yet. pointEst, popVar -- Functions given prior weights linear predictors later case also estimation \\(\\text{cov}(\\hat{\\boldsymbol{\\beta}})\\) \\(\\boldsymbol{X_{vlm}}\\) matrix return point estimate population size analytic estimation variance.additional boolean parameter contr former function set true returns contribution unit. etaNames -- Names linear predictors. densityFunction -- function given linear predictors returns value PMF values x. Additional argument type specifies whether return \\(\\mathbb{P}(Y|Y>0)\\) \\(\\mathbb{P}(Y)\\). simulate -- function generates values dependent vector given linear predictors. getStart -- Expression generating starting points.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Family functions in singleRcapture package — chao","text":"functions based \"base\" distribution support \\(\\mathbb{N}_{0}=\\mathbb{N}\\cup\\lbrace 0\\rbrace\\) describe distribution \\(Y\\)Y truncation. Currently include: \\[\\mathbb{P}(Y=y|\\lambda,\\alpha)=\\left\\lbrace \\begin{array}{cc} \\frac{\\lambda^{y}e^{-\\lambda}}{y!}    & \\text{Poisson distribution}  \\cr \\frac{\\Gamma(y+\\alpha^{-1})}{\\Gamma(\\alpha^{-1})y!}  \\left(\\frac{\\alpha^{-1}}{\\alpha^{-1}+\\lambda}\\right)^{\\alpha^{-1}} \\left(\\frac{\\lambda}{\\alpha^{-1}+\\lambda}\\right)^{y} &  \\text{negative binomial distribution} \\cr \\frac{\\lambda^{y}}{(1+\\lambda)^{y+1}} &  \\text{geometric distribution} \\end{array} \\right.\\] \\(\\lambda\\) Poisson parameter \\(\\alpha\\) dispersion parameter. Geometric distribution special case negative binomial distribution \\(\\alpha=1\\) included negative binomial distribution quite troublesome numerical regression fitting. important know PMF negative binomial distribution approaches PMF Poisson distribution \\(\\alpha\\rightarrow 0^{+}\\). Note literature single source capture recapture models dispersion parameter introduces greater variability negative binomial distribution compared Poisson distribution generally interpreted explaining unobserved heterogeneity .e. presence important unobserved independent variables. methods estimating population size tied Poisson processes hence use \\(\\lambda\\) parameter symbol instead \\(\\mu\\) emphasize connection. Also hard see estimators derived modifying \"base\" distribution unbiased assumptions made respective models violated. zero truncated models corresponding \"base\" distributions characterised relation: \\[\\mathbb{P}(Y=y|Y>0)=\\left\\lbrace \\begin{array}{cc} \\frac{\\mathbb{P}(Y=y)}{1-\\mathbb{P}(Y=0)} & \\text{}y\\neq 0 \\cr 0 & \\text{}y=0 \\end{array}\\right.\\] allows us estimate parameter values using observed part population. models lead following estimates, respectively: \\[ \\begin{aligned} \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1}{1-\\exp(-\\lambda_{k})} & \\text{ Poisson distribution} \\cr \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1}{1-(1+\\alpha_{k}\\lambda_{k})^{-\\alpha_{k}^{-1}}} & \\text{ negative binomial distribution} \\cr \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1+\\lambda_{k}}{\\lambda_{k}} & \\text{ geometric distribution} \\end{aligned} \\] One common way assumptions zero truncated models violated presence one inflation presence somewhat similar single source capture-recapture models zero inflation usual count data analysis. two ways one inflation may understood, relate whether \\(\\mathbb{P}(Y=0)\\) modified inflation. first approach inflate (\\(\\omega\\) parameter) zero truncated distribution : \\[ \\mathbb{P}_{new}(Y=y|Y>0) = \\left\\lbrace\\begin{array}{cc} \\omega + (1 - \\omega)\\mathbb{P}_{old}(Y=1|Y>0)& \\text{: } y = 1 \\cr (1 - \\omega) \\mathbb{P}_{old}(Y=y|Y>0) & \\text{: } y \\neq 1 \\end{array}\\right.\\] corresponds : \\[ \\mathbb{P}_{new}(Y=y) = \\left\\lbrace\\begin{array}{cc} \\mathbb{P}_{old}(Y=0) & \\text{: } y = 0 \\cr \\omega(1 - \\mathbb{P}(Y=0)) + (1 - \\omega)\\mathbb{P}_{old}(Y=1) & \\text{: } y = 1 \\cr (1 - \\omega) \\mathbb{P}_{old}(Y=y) & \\text{: } y > 1 \\end{array}\\right. \\] zero truncation. Models utilise approach commonly referred zero truncated one inflated models. Another way accommodating one inflation SSCR putting inflation parameter base distribution : \\[ \\mathbb{P}_{new}(Y=y) = \\left\\lbrace\\begin{array}{cc} \\omega + (1 - \\omega)\\mathbb{P}_{old}(Y=1)& \\text{: } y = 1 \\cr (1 - \\omega) \\mathbb{P}_{old}(Y=y) & \\text{: } y \\neq 1 \\end{array}\\right. \\] becomes: \\[ \\mathbb{P}_{new}(Y=y|Y>0) = \\left\\lbrace\\begin{array}{cc} \\frac{\\omega}{1 - (1-\\omega)\\mathbb{P}_{old}(Y=0)} + \\frac{(1 - \\omega)}{1 - (1-\\omega)\\mathbb{P}_{old}(Y=0)}\\mathbb{P}_{old}(Y=1)& \\text{: } y = 1 \\cr \\frac{(1 - \\omega)}{1 - (1-\\omega)\\mathbb{P}_{old}(Y=0)}\\mathbb{P}_{old}(Y=y) & \\text{: } y > 1 \\end{array}\\right. \\] truncation. shown Böhning 2022 paper approaches equivalent terms maximising likelihoods put formula \\(\\omega\\). can however lead different population size estimates. zero truncated one inflated models formula population size estimate \\(\\hat{N}\\) change since \\(\\mathbb{P}(y=0)\\) remains estimation parameters changes calculations. one inflated zero truncated models population size estimates expressed, respectively : \\[ \\begin{aligned} \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1}{1-(1-\\omega_{k})\\exp(-\\lambda_{k})} &\\text{ base Poisson distribution} \\cr \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1}{1-(1-\\omega_{k})(1+\\alpha_{k}\\lambda_{k})^{-\\alpha_{k}^{-1}}} &\\text{ base negative binomial distribution} \\cr \\hat{N} &= \\sum_{k=1}^{N_{obs}}\\frac{1+\\lambda_{k}}{\\lambda_{k} + \\omega_{k}} &\\text{ base geometric distribution} \\end{aligned} \\] Zero one truncated models ignore one counts instead accommodating one inflation utilising identity \\[ \\ell_{\\text{ztoi}}=\\boldsymbol{f}_{1}\\ln{\\frac{\\boldsymbol{f}_{1}}{N_{obs}}} +(N_{obs}-\\boldsymbol{f}_{1})\\ln{\\left(1-\\frac{\\boldsymbol{f}_{1}}{N_{obs}} \\right)} + \\ell_{\\text{zot}} \\] \\(\\ell_{\\text{zot}}\\) log likelihood zero one truncated distribution characterised probability mass function: \\[\\mathbb{P}(Y=y|Y>1)=\\left\\lbrace \\begin{array}{cc} \\frac{\\mathbb{P}(Y=y)}{1-\\mathbb{P}(Y=0)-\\mathbb{P}(Y=1)} & \\text{}y > 1 \\cr 0 & \\text{}y\\\\lbrace 0, 1\\rbrace \\end{array}\\right.\\] \\(\\mathbb{P}(Y)\\) probability mass function \"base\" distribution. identity justifies use zero one truncated, unfortunately proven intercept models, however numerical simulations seem indicate even theorem extended (non trivial) regression population size estimation still possible. zero one truncated models population size estimates expressed : \\[ \\begin{aligned} \\hat{N} &= \\boldsymbol{f}_{1} + \\sum_{k=1}^{N_{obs}} \\frac{1-\\lambda_{k}\\exp(-\\lambda_{k})}{1-\\exp(-\\lambda_{k})-\\lambda_{k}\\exp(-\\lambda_{k})}  &\\text{ base Poisson distribution} \\cr \\hat{N} &= \\boldsymbol{f}_{1} + \\sum_{k=1}^{N_{obs}} \\frac{1-\\lambda_{k}(1+\\alpha_{k}\\lambda_{k})^{-1-\\alpha_{k}^{-1}}}{ 1-(1+\\alpha_{k}\\lambda_{k})^{-\\alpha_{k}^{-1}}-\\lambda_{k}(1+\\alpha_{k}\\lambda_{k})^{-1-\\alpha_{k}^{-1}}}  &\\text{ base negative binomial distribution} \\cr \\hat{N} &= \\boldsymbol{f}_{1} + \\sum_{k=1}^{N_{obs}} \\frac{\\lambda_{k}^{2}+\\lambda_{k}+1}{\\lambda_{k}^{2}}  &\\text{ base geometric distribution} \\end{aligned} \\] Pseudo hurdle models experimental yet described literature. Lastly chao zelterman models based logistic regression dummy variable \\[ Z = \\left\\lbrace\\begin{array}{cc} 0     & \\text{}Y = 1  \\cr 1     & \\text{}Y = 2 \\end{array}\\right.\\] based equation: \\[ \\text{logit}(p_{k})= \\ln\\left(\\frac{\\lambda_{k}}{2}\\right)= \\boldsymbol{\\beta}\\mathbf{x}_{k}=\\eta_{k}\\] \\(\\lambda_{k}\\) Poisson parameter. zelterman estimator population size expressed : \\[\\hat{N}=\\sum_{k=1}^{N_{obs}}{1-\\exp\\left(-\\lambda_{k}\\right)}\\] chao estimator form: \\[ \\hat{N}=N_{obs}+\\sum_{k=1}^{\\boldsymbol{f}_{1}+\\boldsymbol{f}_{2}} \\frac{1}{\\lambda_{k}+ \\frac{\\lambda_{k}^{2}}{2}} \\]","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/singleRmodels.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Family functions in singleRcapture package — chao","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate size of sub populations. — stratifyPopsize","title":"Estimate size of sub populations. — stratifyPopsize","text":"function estimates sizes specific sub populations based capture-recapture model whole population.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate size of sub populations. — stratifyPopsize","text":"","code":"stratifyPopsize(object, stratas, alpha, newdata, ...)  # S3 method for singleR stratifyPopsize(object, stratas, alpha, newdata, cov = NULL, ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate size of sub populations. — stratifyPopsize","text":"object object population size estimates based singleRcapture package fitter singleR class object. stratas specification sub populations either : formula -- formula applied model.frame extracted object . Logical vector number entries equal number rows dataset. (named) list element logical vector, names list used specify names variable returned object. Vector names explanatory variables. singleR method function specification stratas parameter result every level explanatory variable sub population variable specified. value provided singleR method function create sub populations based levels factor variables model.frame. alpha significance level confidence intervals -- Either single numeric value vector length equal number sub populations specified stratas. missing set .05 singleR method. newdata new data frame sizes sub populations estimated. none provided stratifyPopsize acts model.frame object. ... vector arguments passed functions. singleR method functions arguments ... passed either cov argument provided function vcov cov argument missing call.  cov singleR method estimate variance-covariance matrix estimate regression parameters. possible pass function example sandwich::vcovHC called : foo(object, ...) user may specify additional arguments function ... argument. provided estimate covariance matrix set calling appropriate vcov method.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate size of sub populations. — stratifyPopsize","text":"data.frame object row names names specified sub populations either provided inferred.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/stratifyPopsize.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate size of sub populations. — stratifyPopsize","text":"single source capture-recapture models frequently used estimate population size Horwitz-Thompson type estimate: \\[\\hat{N} = \\sum_{k=1}^{N}\\frac{I_{k}}{\\mathbb{P}(Y_{k}>0)} =  \\sum_{k=1}^{N_{obs}}\\frac{1}{1-\\mathbb{P}(Y_{k}=0)}\\] \\(I_{k}=I_{Y_{k} > 0}\\) indicator variables, value 1 kth unit observed least 0 otherwise inverse probabilistic weights weights units observed data \\(\\tfrac{1}{\\mathbb{P}(Y_{k}>0)}\\) estimated using fitted linear predictors. estimates different sub populations made changing \\(I_{k}=I_{Y_{k} > 0}\\) indicator variables refer population whole sub populations considered .e. changing values 1 0 kth unit member sub population considered moment. estimation variance estimates estimation variance estimate population size whole population follow relation one described .","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary statistics for model of singleR class. — summary.singleR","title":"Summary statistics for model of singleR class. — summary.singleR","text":"summary method singleR class, works analogically summary.glm includes population size estimation results. additional statistics, confidence intervals coefficients coefficient correlation, specified printed.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary statistics for model of singleR class. — summary.singleR","text":"","code":"# S3 method for singleR summary(   object,   test = c(\"t\", \"z\"),   resType = \"pearson\",   correlation = FALSE,   confint = FALSE,   cov,   popSizeEst,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary statistics for model of singleR class. — summary.singleR","text":"object object singleR class. test type test significance parameters \"t\" t-test \"z\" normal approximation students t distribution, default \"z\" used 30 degrees freedom \"t\" used cases. resType type residuals summarise value allowed residuals.signleR except \"\" allowed. default pearson residuals used. correlation logical value indicating whether correlation matrix computed covariance matrix default FALSE. confint logical value indicating whether confidence intervals regression parameters constructed. default FALSE. cov covariance matrix corresponding regression parameters. possible give cov argument function object. specified constructed using vcov.singleR method. (.e using Cramer-Rao lower bound) popSizeEst popSizeEstResults class object. specified population size estimation results drawn object. post-hoc procedures, sandwich covariance matrix estimation bias reduction, taken possible include population size estimation results calling redoPopEstimation. ... additional optional arguments passed following functions: vcov.singleR -- cov argument provided. cov -- cov parameter specified call function. confint.singleR -- confint parameter set TRUE function call. particular possible set confidence level ....","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary statistics for model of singleR class. — summary.singleR","text":"object summarysingleR class containing: call -- call created object. coefficients -- dataframe estimated regression coefficients summary statistics standard error wald test statistic p value wald test. residuals -- vector residuals type specified call. aic -- Akaike's informsation criterion. bic -- Bayesian (Schwarz's) information criterion. iter -- Number iterations taken fitting regression. logL -- Logarithm likelihood function evaluated coefficients. deviance -- Residual deviance. populationSize -- Object population size estimation results. dfResidual -- Residual degrees freedom. sizeObserved -- Size observed population. correlation -- Correlation matrix correlation parameter set TRUE test -- Type statistical test performed. model -- Family class object specified call object. skew -- bootstrap sample saved contains estimate skewness.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":null,"dir":"Reference","previous_headings":"","what":"Statistical tests of goodness of fit. — summary.singleRmargin","title":"Statistical tests of goodness of fit. — summary.singleRmargin","text":"Performs two statistical test observed fitted marginal frequencies. G test test statistic computed :   \\[G = 2\\sum_{k}O_{k}\\ln{\\left(\\frac{O_{k}}{E_{k}}\\right)}\\] \\(\\chi^{2}\\) test statistic computed : \\[\\chi^{2} = \\sum_{k}\\frac{\\left(O_{k}-E_{k}\\right)^{2}}{E_{k}}\\] \\(O_{k},E_{k}\\) denoted observed fitted frequencies respectively. statistics converge \\(\\chi^2\\) distribution asymptotically degrees freedom. convergence \\(G, \\chi^2\\) statistics \\(\\chi^2\\) distribution may violated expected counts cells low, say < 5, customary either censor omit cells.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Statistical tests of goodness of fit. — summary.singleRmargin","text":"","code":"# S3 method for singleRmargin summary(object, df, dropl5 = c(\"drop\", \"group\", \"no\"), ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Statistical tests of goodness of fit. — summary.singleRmargin","text":"object object singleRmargin class. df degrees freedom provided function try manually always possible. dropl5 character indicating treatment cells frequencies < 5 either grouping , dropping leaving . Defaults drop. ... currently nothing.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Statistical tests of goodness of fit. — summary.singleRmargin","text":"chi squared test G test comparison fitted observed marginal frequencies.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/summary.singleRmargin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Statistical tests of goodness of fit. — summary.singleRmargin","text":"","code":"# Create a simple model Model <- estimatePopsize(   formula = capture ~ .,    data = netherlandsimmigrant,    model = ztpoisson,    method = \"IRLS\" ) plot(Model, \"rootogram\")  # We see a considerable lack of fit summary(marginalFreq(Model), df = 1, dropl5 = \"group\") #> Test for Goodness of fit of a regression model: #>  #>                  Test statistics df P(>X^2) #> Chi-squared test           50.06  1 1.5e-12 #> G-test                     34.31  1 4.7e-09 #>  #> --------------------------------------------------------------  #> Cells with fitted frequencies of < 5 have been grouped  #> Names of cells used in calculating test(s) statistic: 1 2 3"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain Covariance Matrix estimation. — vcov.singleR","title":"Obtain Covariance Matrix estimation. — vcov.singleR","text":"vcov method singleR class.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain Covariance Matrix estimation. — vcov.singleR","text":"","code":"# S3 method for singleR vcov(object, type = c(\"Fisher\", \"observedInform\"), ...)"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain Covariance Matrix estimation. — vcov.singleR","text":"object object singleR class. type type estimate covariance matrix now either expected (Fisher) information matrix observed information matrix. ... additional arguments method functions","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain Covariance Matrix estimation. — vcov.singleR","text":"covariance matrix fitted coefficients, rows columns correspond parameters returned coef method.","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcov.singleR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Obtain Covariance Matrix estimation. — vcov.singleR","text":"Returns estimated covariance matrix model coefficients calculated analytic hessian Fisher information matrix usually utilising asymptotic effectiveness maximum likelihood estimates. Covariance type taken control parameter provided call created object arguments type specified.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — estfun.singleR","title":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — estfun.singleR","text":"S3 method vcovHC handle singleR class objects. Works exactly like vcov.default difference method handles vector generalised linear models. Updating covariance matrix variance/standard error estimation population size estimator can done via redoPopEstimation()","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — estfun.singleR","text":"","code":"# S3 method for singleR estfun(x, ...)  # S3 method for singleR bread(x, ...)  # S3 method for singleR vcovHC(   x,   type = c(\"HC3\", \"const\", \"HC\", \"HC0\", \"HC1\", \"HC2\", \"HC4\", \"HC4m\", \"HC5\"),   omega = NULL,   sandwich = TRUE,   ... )"},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — estfun.singleR","text":"x fitted singleR class object. ... vcovHC additional optional arguments passed following functions: estfun -- empirical estimating functions. hatvalues -- diagonal elements projection matrix. sandwich -- sandwich argument function call set TRUE. vcov -- calling bread internally. type character string specifying estimation type, sandwich::vcovHC.default. HC3 default value. omega vector function depending arguments residuals (.e. derivative log-likelihood respect linear predictor), diaghat (diagonal corresponding hat matrix) df (residual degrees freedom), sandwich::vcovHC.default. sandwich logical. sandwich estimator computed? set FALSE meat matrix returned. sandwich::vcovHC()","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — estfun.singleR","text":"Variance-covariance matrix estimation corrected heteroscedasticity regression errors.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — estfun.singleR","text":"Piotr Chlebicki, Maciej Beręsewicz","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/reference/vcovHC.singleR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Heteroscedasticity-Consistent Covariance Matrix Estimation for singleR class — estfun.singleR","text":"","code":"set.seed(1) N <- 10000 gender <- rbinom(N, 1, 0.2) eta <- -1 + 0.5*gender counts <- rpois(N, lambda = exp(eta)) df <- data.frame(gender, eta, counts) df2 <- subset(df, counts > 0) mod1 <-  estimatePopsize(   formula = counts ~ 1 + gender,    data = df2,    model = \"ztpoisson\",    method = \"optim\",    popVar = \"analytic\" ) require(sandwich) HC <- sandwich::vcovHC(mod1, type = \"HC4\") Fisher <- vcov(mod1, \"Fisher\") # variance covariance matrix obtained from  #Fisher (expected) information matrix HC #>             (Intercept)       gender #> (Intercept)  0.00201216 -0.002012160 #> gender      -0.00201216  0.004790297 Fisher #>              (Intercept)       gender #> (Intercept)  0.002022145 -0.002022145 #> gender      -0.002022145  0.004881858 # usual results summary(mod1) #>  #> Call: #> estimatePopsize(formula = counts ~ 1 + gender, data = df2, model = \"ztpoisson\",  #>     method = \"optim\", popVar = \"analytic\") #>  #> Pearson Residuals: #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #> -0.5503 -0.4267 -0.4267  0.0000 -0.4267  6.2261  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>             Estimate Std. Error z value  P(>|z|)     #> (Intercept) -1.01346    0.04497 -22.537  < 2e-16 *** #> gender       0.50288    0.06987   7.197 6.14e-13 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 3990.538 #> BIC: 4002.804 #> Residual deviance: 2386.29 #>  #> Log-likelihood: -1993.269 on 3403 Degrees of freedom  #> Number of calls to log-likelihood function: 31 #> ----------------------- #> Population size estimation results:  #> Point estimate 10146.02 #> Observed proportion: 33.6% (N obs = 3405) #> Std. Error 341.7288 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      9476.239   10815.79 #> logNormal   9508.827   10849.72 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      31.48175   35.93198 #> logNormal   31.38330   35.80883 # updated results summary(mod1, cov = HC, popSizeEst = redoPopEstimation(mod1, cov = HC)) #>  #> Call: #> estimatePopsize(formula = counts ~ 1 + gender, data = df2, model = \"ztpoisson\",  #>     method = \"optim\", popVar = \"analytic\") #>  #> Pearson Residuals: #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #> -0.5503 -0.4267 -0.4267  0.0000 -0.4267  6.2261  #>  #> Coefficients: #> ----------------------- #> For linear predictors associated with: lambda  #>             Estimate Std. Error z value  P(>|z|)     #> (Intercept) -1.01346    0.04486 -22.593  < 2e-16 *** #> gender       0.50288    0.06921   7.266 3.71e-13 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> AIC: 3990.538 #> BIC: 4002.804 #> Residual deviance: 2386.29 #>  #> Log-likelihood: -1993.269 on 3403 Degrees of freedom  #> Number of calls to log-likelihood function: 31 #> ----------------------- #> Population size estimation results:  #> Point estimate 10146.02 #> Observed proportion: 33.6% (N obs = 3405) #> Std. Error 340.7903 #> 95% CI for the population size: #>           lowerBound upperBound #> normal      9478.079   10813.95 #> logNormal   9510.490   10847.69 #> 95% CI for the share of observed population: #>           lowerBound upperBound #> normal      31.48710   35.92500 #> logNormal   31.38916   35.80257 # estimating equations mod1_sims <- sandwich::estfun(mod1) head(mod1_sims) #>   (Intercept)    gender #> 1  -0.1924342 0.0000000 #> 2   0.6700925 0.6700925 #> 3  -0.1924342 0.0000000 #> 4  -0.1924342 0.0000000 #> 5  -0.1924342 0.0000000 #> 6  -0.1924342 0.0000000 # bread method all(vcov(mod1, \"Fisher\") * nrow(df2) == sandwich::bread(mod1, type = \"Fisher\")) #> [1] TRUE"},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-020","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.2.0","title":"singleRcapture 0.2.0","text":"CRAN release: 2023-06-11","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"the-package-is-now-at-cran-0-2-0","dir":"Changelog","previous_headings":"","what":"The package is now at CRAN","title":"singleRcapture 0.2.0","text":"Added final Hurdleztnegbin model Vastly improved redoPopSize now handles bootstrap fitted model non standard covariance matrixes newdata argument user supplied coef etc. Added predict.singleR method offers standard error link, response well mean predictions unexpected warnings occur now main function using package correctly control arguments now verified passed Fitting now reliable Added information stats::optim error codes Added warnings functions computing deviance fixed bugs occurring using mathematical functions part formulas .e. setting formula something like: y ~ log(x) + (x ^ t) + (t ^ 2)","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-014","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.4","title":"singleRcapture 0.1.4","text":"Added ztoinegbin, oiztnegbin ztHurdlenegbin models Added optional arguments family-functions specify link function distribution parameters Updated standardised documentation Added warnings Added methods singleR class commonly used glm functions, particular texreg::screenreg work well now Changed default arguments Added option save logs IRLS fitting Fixed issues intercept models Fixed slight miscalculations information matrixes one inflated models making fitting much reliable better Rcmd tests","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-0132--ntts","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.3.2 – NTTS","title":"singleRcapture 0.1.3.2 – NTTS","text":"Added function implements population size estimates stratas warnings fitting options control functions Corrected/implemented deviance residuals models Now whole package uses cammelCase Performance upgrades Corrected miss calculated moments Change exported data factors actually factors just characters Removed unused dependency Added automated R-cmd check","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-0131","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.3.1","title":"singleRcapture 0.1.3.1","text":"Basically documentation redone now features important theory SSCR methods information (v)glms Added checks positivity working weights matrixes stabilise \"IRLS\" algorithm S3 method vcovHC implemented vcovCL work singleR class objects work \"HC0\" \"HC1\" type argument values Basic version function redoPopEstimation updating population size estimation post-hoc procedures implemented popSizeEst function extracting population size estimation results implemented Minor improvements memory usage made computation speed little Changed names mle robust fitting methods optim IRLS respectively bugfixes warnings messages estimate_popsize.fit","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-013","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.3","title":"singleRcapture 0.1.3","text":"Multiple new models IRLS generalised distributions multiple parameters bugfixes QOL improvements extended bootstrap methods new models","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-012","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.2","title":"singleRcapture 0.1.2","text":"control parameters model control parameters regression bootstrap sampling leave one diagnostics popsize regression parameters (dfbetas corrected) fixes Goodness fit tests zero one truncated models computational improvements IRLS small bugfixes","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-011","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.1","title":"singleRcapture 0.1.1","text":"tiny tests fixes marginal frequencies Deviance implemented dfbetas levarage matrix Parametric bootstraps work correctly part just polishing left ","code":""},{"path":"https://ncn-foreigners.github.io/singleRcapture/news/index.html","id":"singlercapture-010","dir":"Changelog","previous_headings":"","what":"singleRcapture 0.1.0","title":"singleRcapture 0.1.0","text":"first version package released","code":""}]
