---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# singleRcapture

<!-- badges: start -->
<!-- badges: end -->

The goal of singleRcapture is to automate single source capture-recapture estimation of population size.

## Funding

Work on this package is supported by the the National Science Center, OPUS 22 grant no. 2020/39/B/HS4/00941.

## Installation

You can install the development version of singleRcapture from [GitHub](https://github.com/ncn-foreigners/singleRcapture) with:

``` r
# install.packages("devtools")
devtools::install_github("ncn-foreigners/singleRcapture")
```

### Examples

This is a basic example of zero truncated poisson model and zelterman model with netherlands imigrant data with analytic variance:

```{r example}
library(singleRcapture)
ModelPo <- estimate_popsize(formula = capture ~ .,
                            data = netherlandsimmigrant,
                            pop.var = "analytic",
                            model = "ztpoisson",
                            method = "robust")
ModelZl <- estimate_popsize(formula = capture ~ .,
                            data = netherlandsimmigrant,
                            pop.var = "analytic",
                            model = "zelterman",
                            method = "robust")
summary(ModelPo)
```

```{r}
summary(ModelZl)
```

Marginal frequencies and Goodness of fit test:

```{r}
summary(marginalFreq(ModelPo), df = 2, dropl5 = "group")
```

Should goodness of fit tests prove insufficient in determining the best model graphical comparisons may also be made.
One such technique is a rootogram and it is implemented as a part of singleR method for `plot` function:

```{r plot, fig.show="hold", out.width="47%"}
plot(ModelPo, plotType = "rootogram", main = "Zero Truncated Poisson model")
plot(ModelZl, plotType = "rootogram", main = "Logistic regression based Zelterman model")
```

singleRcapture also includes bootstraps and models truncated at values 0 and 1 and non standard confidence levels

```{r boot}
set.seed(123)
zotgeomBoot <- estimate_popsize(
    formula = TOTAL_SUB ~ .,
    data = farmsubmission,
    pop.var = "bootstrap",
    model = "zotgeom",
    method = "robust",
    control.pop.var = control.pop.var(B = 1000, alpha = .01)
)
summary(zotgeomBoot)
```

```{r}
plot(zotgeomBoot, plotType = "bootHist", labels = TRUE, ylim = c(0, 425))
```
