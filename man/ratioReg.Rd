% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ratioReg.R
\name{ratioReg}
\alias{ratioReg}
\title{Estimate population size using ratio regression}
\usage{
ratioReg(data, formula, weights = NULL, useWeights = TRUE, ...)
}
\arguments{
\item{data}{A data frame containing capture counts (e.g., number of times an individual was observed).}

\item{formula}{A formula specifying the model structure (e.g., \code{observed ~ 1}).}

\item{weights}{Optional prior weights.}

\item{useWeights}{Logical; whether to apply optional weighting (TODO: Future feature).}

\item{...}{Additional arguments.

TODO: Handle optional weighting properly (not yet implemented).
TODO: Investigate warnings regarding object length in variance estimation.}
}
\value{
A list containing:
\itemize{
\item{\code{estimates} -- Estimated total population size.}
\item{\code{confidenceInterval} -- Confidence interval for the estimates.}
\item{\code{ratioModel} -- Linear model used for ratio estimation.}
\item{\code{formula} -- The formula used in the regression.}
\item{\code{call} -- The function call.}
}
}
\description{
Estimates population size using ratio regression, an alternative method
based on observed capture ratios. This method assumes an exponential
decay pattern in capture probabilities to infer missing individuals.
}
\details{
\strong{How the function works:}
\enumerate{
\item The function takes a dataset where the \code{observed} column represents
how many times an individual was captured.
\item It creates a frequency table (\code{counts}) to determine how often
each count appears in the dataset.
\item Using these frequencies, it calculates \strong{capture ratios}:
\deqn{r_k = \frac{f_{k+1}}{f_k}}
where \( f_k \) is the frequency of individuals captured exactly \( k \) times.
\item The function performs a \strong{linear regression} on the logarithm of these ratios:
\deqn{\log(r_k) = \beta_0 + \beta_1 k}
\item The estimated \strong{capture probability} from this regression is then used
to estimate the \strong{total population size} using:
\deqn{N = \frac{N_{obs}}{1 - P(Y = 0)}}
\item Confidence intervals are computed based on the \strong{variance} of the estimated missing cases.
}

\strong{Key assumptions:}
\itemize{
\item Capture probabilities follow an exponential decay pattern.
\item The number of missing individuals can be inferred from observed capture ratios.
}
}
\examples{
# Example 1: Small dataset
test_data <- data.frame(observed = c(1, 1, 2, 2, 2, 3, 3, 3, 4, 5))
result <- ratioReg(data = test_data, formula = observed ~ 1)
print(result$estimates)
print(result$confidenceInterval)
summary(result$ratioModel)

# Example 2: Larger dataset
set.seed(123)
large_data <- data.frame(observed = sample(1:10, 100, replace = TRUE))
result_large <- ratioReg(data = large_data, formula = observed ~ 1)
print(result_large$estimates)

}
\author{
Cyprian Jurkowski, Piotr Chlebicki
}
