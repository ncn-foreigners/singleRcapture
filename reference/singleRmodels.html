<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Family functions in singleRcapture package — chao • singleRcapture</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Family functions in singleRcapture package — chao"><meta name="description" content="Package singleRcapture utilizes various family type
functions that specify variable parts of population size estimation,
regression, diagnostics and other necessary information that depends
on the model. These functions are used as model argument in
estimatePopsize function."><meta property="og:description" content="Package singleRcapture utilizes various family type
functions that specify variable parts of population size estimation,
regression, diagnostics and other necessary information that depends
on the model. These functions are used as model argument in
estimatePopsize function."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">singleRcapture</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/singleRcapture.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncn-foreigners/singleRcapture/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Family functions in singleRcapture package</h1>
      <small class="dont-index">Source: <a href="https://github.com/ncn-foreigners/singleRcapture/blob/main/R/chao.R" class="external-link"><code>R/chao.R</code></a>, <a href="https://github.com/ncn-foreigners/singleRcapture/blob/main/R/documentationFiles.R" class="external-link"><code>R/documentationFiles.R</code></a>, <a href="https://github.com/ncn-foreigners/singleRcapture/blob/main/R/hurdleztgeom.R" class="external-link"><code>R/hurdleztgeom.R</code></a>, and 18 more</small>
      <div class="d-none name"><code>singleRmodels.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Package <code>singleRcapture</code> utilizes various family type
functions that specify variable parts of population size estimation,
regression, diagnostics and other necessary information that depends
on the model. These functions are used as <code>model</code> argument in
<code>estimatePopsize</code> function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">chao</span><span class="op">(</span>lambdaLink <span class="op">=</span> <span class="st">"loghalf"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Hurdleztgeom</span><span class="op">(</span></span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  piLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Hurdleztnegbin</span><span class="op">(</span></span>
<span>  nSim <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  epsSim <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  eimStep <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  alphaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  piLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Hurdleztpoisson</span><span class="op">(</span></span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  piLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">oiztgeom</span><span class="op">(</span></span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  omegaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">oiztnegbin</span><span class="op">(</span></span>
<span>  nSim <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  epsSim <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  eimStep <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  alphaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  omegaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">oiztpoisson</span><span class="op">(</span></span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  omegaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">zelterman</span><span class="op">(</span>lambdaLink <span class="op">=</span> <span class="st">"loghalf"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">zotgeom</span><span class="op">(</span>lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">zotnegbin</span><span class="op">(</span></span>
<span>  nSim <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  epsSim <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  eimStep <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  alphaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">zotpoisson</span><span class="op">(</span>lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ztHurdlegeom</span><span class="op">(</span></span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  piLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ztHurdlenegbin</span><span class="op">(</span></span>
<span>  nSim <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  epsSim <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  eimStep <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  alphaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  piLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ztHurdlepoisson</span><span class="op">(</span></span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  piLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ztgeom</span><span class="op">(</span>lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ztnegbin</span><span class="op">(</span></span>
<span>  nSim <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  epsSim <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  eimStep <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  alphaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ztoigeom</span><span class="op">(</span></span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  omegaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ztoinegbin</span><span class="op">(</span></span>
<span>  nSim <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  epsSim <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  eimStep <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  alphaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  omegaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ztoipoisson</span><span class="op">(</span></span>
<span>  lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>,</span>
<span>  omegaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ztpoisson</span><span class="op">(</span>lambdaLink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"neglog"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-lambdalink">lambdaLink<a class="anchor" aria-label="anchor" href="#arg-lambdalink"></a></dt>
<dd><p>a link for Poisson parameter, <code>"log"</code>
by default except for zelterman's and chao's models where only
(x2) is possible.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments, not used for now.</p></dd>


<dt id="arg-pilink">piLink<a class="anchor" aria-label="anchor" href="#arg-pilink"></a></dt>
<dd><p>a link for probability parameter,  <code>"logit"</code> by default</p></dd>


<dt id="arg-nsim-epssim">nSim, epsSim<a class="anchor" aria-label="anchor" href="#arg-nsim-epssim"></a></dt>
<dd><p>if working weights cannot be computed analytically these
arguments specify maximum number of simulations allowed and
precision level for finding them numerically respectively.</p></dd>


<dt id="arg-eimstep">eimStep<a class="anchor" aria-label="anchor" href="#arg-eimstep"></a></dt>
<dd><p>a non negative integer describing
how many values should be used at each step of approximation
of information matrixes when no analytic solution is available
(e.g. <code>"ztnegbin"</code>), default varies depending on a function.
Higher value usually means faster convergence but may potentially cause
issues with convergence.</p></dd>


<dt id="arg-alphalink">alphaLink<a class="anchor" aria-label="anchor" href="#arg-alphalink"></a></dt>
<dd><p>a link for dispersion parameter, <code>"log"</code> by default</p></dd>


<dt id="arg-omegalink">omegaLink<a class="anchor" aria-label="anchor" href="#arg-omegalink"></a></dt>
<dd><p>a link for inflation parameter, <code>"logit"</code> by default</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A object of class <code>family</code> containing objects:</p><ul><li><p><code>makeMinusLogLike</code> – A factory function for creating the following functions:
(), ,
^2^T
 functions from the
y vector and the
X_vlm matrix
(or just X if applied to model
with single linear predictor)which has the <code>deriv</code> argument with possible
values in <code>c(0, 1, 2)</code> that determine which derivative to return;
the default value is <code>0</code>, which represents the minus log-likelihood.</p></li>
<li><p><code>links</code> – A list with link functions.</p></li>
<li><p><code>mu.eta, variance</code> – Functions of linear predictors that
return expected value and variance. The <code>type</code> argument with 2 possible
values (<code>"trunc"</code> and <code>"nontrunc"</code>) that specifies whether
to return E(Y|Y&gt;0), var(Y|Y&gt;0) or
E(Y), var(Y) respectively; the <code>deriv</code> argument
with values in <code>c(0, 1, 2)</code> is used for indicating the derivative with
respect to the linear predictors, which is used for providing
standard errors in the <code>predict</code> method.</p></li>
<li><p><code>family</code> – A string that specifies name of the model.</p></li>
<li><p><code>valideta, validmu</code> – For now it only returns <code>TRUE</code>.
In the near future, it will be used to check whether applied linear
predictors are valid (i.e. are transformed into some elements of the
parameter space subjected to the inverse link function).</p></li>
<li><p><code>funcZ, Wfun</code> – Functions that create pseudo residuals and
working weights used in IRLS algorithm.</p></li>
<li><p><code>devResids</code> – A function that given the linear predictors
prior weights vector and response vector returns deviance residuals.
Not all family functions have these functions implemented yet.</p></li>
<li><p><code>pointEst, popVar</code> – Functions that given prior weights
linear predictors and in the latter case also estimate of
cov() and X_vlm
matrix return point estimate for population size and analytic estimation
of its variance.There is a additional boolean parameter <code>contr</code> in the
former function that if set to true returns contribution of each unit.</p></li>
<li><p><code>etaNames</code> – Names of linear predictors.</p></li>
<li><p><code>densityFunction</code> – A function that given linear predictors
returns value of PMF at values <code>x</code>. Additional argument <code>type</code>
specifies whether to return P(Y|Y&gt;0) or
P(Y).</p></li>
<li><p><code>simulate</code> – A function that generates values of a dependent
vector given linear predictors.</p></li>
<li><p><code>getStart</code> – An expression for generating starting points.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p></p>
<p>Most of these functions are based on some "base" distribution with
support N_0=N 0 that describe
distribution of Y before truncation. Currently they include:
P(Y=y|,)=
arraycc
^ye^-y!    &amp; Poisson distribution  <br>
(y+^-1)(^-1)y!
(^-1^-1+)^^-1
(^-1+)^y &amp;
negative binomial distribution <br>
^y(1+)^y+1 &amp;
geometric distribution
array
.
where  is the Poisson parameter and
 is the dispersion parameter. Geometric distribution
is a special case of negative binomial distribution when
=1 it is included because negative binomial
distribution is quite troublesome numerical regression in fitting.
It is important to know that PMF of negative binomial distribution
approaches the PMF of Poisson distribution when
 0^+.</p>
<p><strong>Note</strong> in literature on single source capture recapture models
the dispersion parameter which introduces greater variability
in negative binomial distribution compared to Poisson distribution is
generally interpreted as explaining the <em>unobserved</em> heterogeneity
i.e. presence of important unobserved independent variables.
All these methods for estimating population size are tied to Poisson
processes hence we use  as parameter symbol
instead of  to emphasize this connection.
Also will not be hard to see that <strong>all</strong> estimators derived from
modifying the "base" distribution are unbiased if assumptions
made by respective models are not violated.</p>
<p>The <strong>zero-truncated</strong> models corresponding to "base" distributions are
characterized by relation:
P(Y=y|Y&gt;0)=
arraycc
P(Y=y)1-P(Y=0) &amp; when y 0 <br>
0 &amp; when y=0
array.
which allows us to estimate parameter values using only observed part of
population. These models lead to the following estimates, respectively:

aligned
N &amp;= _k=1^N_obs11-(-_k) &amp;
 For Poisson distribution <br>
N &amp;= _k=1^N_obs11-(1+\alpha_k_k)^-_k^-1 &amp;
 For negative binomial distribution <br>
N &amp;= _k=1^N_obs1+_k_k &amp;
 For geometric distribution
aligned</p>
<p>One common way in which assumptions of zero-truncated models are violated is
presence of <strong>one-inflation</strong> the presence of which is somewhat similar in
single source capture-recapture models to zero-inflation in usual count data
analysis. There are two ways in which one-inflation may be understood,
they relate to whether P(Y=0) is
modified by inflation. The first approach is inflate
( parameter) zero-truncated distribution as:

P_new(Y=y|Y&gt;0) = arraycc
 + (1 - )P_old(Y=1|Y&gt;0)&amp; when:  y = 1 <br>
(1 - ) P_old(Y=y|Y&gt;0) &amp; when:  y  1
array.
which corresponds to:

P_new(Y=y) = arraycc
P_old(Y=0) &amp; when:  y = 0 <br>
(1 - P(Y=0)) + (1 - )P_old(Y=1) &amp; when:  y = 1 <br>
(1 - ) P_old(Y=y) &amp; when:  y &gt; 1
array.

before zero-truncation. Models that utilize this
approach are commonly referred to as <em>zero-truncated one-inflated models</em>.
Another way of accommodating one-inflation in SSCR is by putting inflation
parameter on base distribution as:

P_new(Y=y) = arraycc
 + (1 - )P_old(Y=1)&amp; when:  y = 1 <br>
(1 - ) P_old(Y=y) &amp; when:  y  1
array.

which then becomes:

P_new(Y=y|Y&gt;0) = arraycc
1 - (1-)P_old(Y=0) + (1 - )1 - (1-)P_old(Y=0)P_old(Y=1)&amp; when:  y = 1 <br>
(1 - )1 - (1-)P_old(Y=0)P_old(Y=y) &amp; when:  y &gt; 1
array.

after truncation.
It was shown by Böhning in 2022 paper that these approaches are equivalent
in terms of maximizing likelihoods if we do not put formula on
. They can however lead to different
population size estimates.</p>
<p>For <em>zero-truncated one-inflated models</em> the formula for population size
estimate N does not change since
P(y=0) remains the same but estimation of parameters
changes all calculations.</p>
<p>For <em>one-inflated zero-truncated models</em> population size estimates are
expressed, respectively by:

aligned
N &amp;= _k=1^N_obs11-(1-_k)(-_k) &amp; For base Poisson distribution <br>
N &amp;= _k=1^N_obs11-(1-_k)(1+\alpha_k_k)^-_k^-1 &amp; For base negative binomial distribution <br>
N &amp;= _k=1^N_obs1+_k_k + _k &amp; For base geometric distribution
aligned</p>
<p><strong>Zero-one-truncated</strong> models ignore one counts instead of accommodating
one-inflation by utilizing the identity

_ztoi=f_1f_1N_obs
+(N_obs-f_1)(1-f_1N_obs
) + _zot

where _zot is the log likelihood
of zero-one-truncated distribution characterized by probability mass function:
P(Y=y|Y&gt;1)=
arraycc
P(Y=y)1-P(Y=0)-P(Y=1) &amp; when y &gt; 1 <br>
0 &amp; when y 0, 1
array.
where P(Y) is the probability mass function of
the "base" distribution. The identity above justifies use of zero-one-truncated,
unfortunately it was only proven for intercept only models, however
numerical simulations seem to indicate that even if the theorem cannot be
extended for (non trivial) regression population size estimation is still
possible.</p>
<p>For <em>zero-one-truncated models</em> population size estimates are expressed by:

aligned
N &amp;= f_1 + _k=1^N_obs
1-_k(-_k)1-(-_k)-_k(-_k)
&amp; For base Poisson distribution <br>
N &amp;= f_1 + _k=1^N_obs
1-_k(1+_k_k)^-1-_k^-1
1-(1+_k_k)^-_k^-1-_k(1+_k_k)^-1-_k^-1
&amp; For base negative binomial distribution <br>
N &amp;= f_1 + _k=1^N_obs
_k^2+_k+1_k^2
&amp; For base geometric distribution
aligned</p>
<p>Pseudo hurdle models are experimental and not yet described in literature.</p>
<p>Lastly there are <strong>chao</strong> and <strong>zelterman</strong> models which are based on
logistic regression on the dummy variable

Z = arraycc
0     &amp; if Y = 1  <br>
1     &amp; if Y = 2
array.
based on the equation:

logit(p_k)=
(_k2)=
x_k=_k
where _k is the Poisson parameter.</p>
<p>The <em>zelterman</em> estimator of population size is expressed as:
N=_k=1^N_obs1-(-_k)
and <em>chao</em> estimator has the form:

N=N_obs+_k=1^f_1+f_2
1_k+ _k^22</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="estimatePopsize.html">estimatePopsize()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Piotr Chlebicki, Maciej Beręsewicz</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Piotr Chlebicki, Maciej Beręsewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

