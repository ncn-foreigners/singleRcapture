<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Regression diagnostics in singleRcapture — regDiagSingleR • singleRcapture</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Regression diagnostics in singleRcapture — regDiagSingleR"><meta name="description" content="List of some regression diagnostics implemented for
singleRStaticCountData class. Functions that either require no changes from
glm class or are not relevant to context of singleRcapture
are omitted."><meta property="og:description" content="List of some regression diagnostics implemented for
singleRStaticCountData class. Functions that either require no changes from
glm class or are not relevant to context of singleRcapture
are omitted."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">singleRcapture</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/singleRcapture.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncn-foreigners/singleRcapture/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Regression diagnostics in singleRcapture</h1>
      <small class="dont-index">Source: <a href="https://github.com/ncn-foreigners/singleRcapture/blob/main/R/bigDocumentation.R" class="external-link"><code>R/bigDocumentation.R</code></a>, <a href="https://github.com/ncn-foreigners/singleRcapture/blob/main/R/leave-one-out.R" class="external-link"><code>R/leave-one-out.R</code></a>, <a href="https://github.com/ncn-foreigners/singleRcapture/blob/main/R/miscDiagnostics.R" class="external-link"><code>R/miscDiagnostics.R</code></a>, and 1 more</small>
      <div class="d-none name"><code>regDiagSingleR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>List of some regression diagnostics implemented for
<code>singleRStaticCountData</code> class. Functions that either require no changes from
<code>glm</code> class or are not relevant to context of <code>singleRcapture</code>
are omitted.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dfpopsize</span><span class="op">(</span><span class="va">model</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'singleRStaticCountData'</span></span>
<span><span class="fu">dfpopsize</span><span class="op">(</span><span class="va">model</span>, dfbeta <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'singleRStaticCountData'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbeta</a></span><span class="op">(</span><span class="va">model</span>, maxitNew <span class="op">=</span> <span class="fl">1</span>, trace <span class="op">=</span> <span class="cn">FALSE</span>, cores <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'singleRStaticCountData'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">hatvalues</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'singleRStaticCountData'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, <span class="st">"pearsonSTD"</span>, <span class="st">"response"</span>, <span class="st">"working"</span>, <span class="st">"deviance"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'singleRStaticCountData'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">cooks.distance</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'singleRStaticCountData'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">sigma</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'singleRStaticCountData'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.influence.html" class="external-link">influence</a></span><span class="op">(</span><span class="va">model</span>, do.coef <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'singleRStaticCountData'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">rstudent</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'singleRStaticCountData'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">rstandard</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"pearson"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model-object">model, object<a class="anchor" aria-label="anchor" href="#arg-model-object"></a></dt>
<dd><p>an object of <code>singleRStaticCountData</code> class.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments passed to other methods.
Notably <code>dfpopsize.singleRStaticCountData</code> calls
<code>dfbeta.singleRStaticCountData</code> if no <code>dfbeta</code> argument was
provided and <code>controlMethod</code> is called in <code>dfbeta</code> method.</p></dd>


<dt id="arg-dfbeta">dfbeta<a class="anchor" aria-label="anchor" href="#arg-dfbeta"></a></dt>
<dd><p>if <code>dfbeta</code> was already obtained it is possible to pass
them into function so that they need not be computed for the second time.</p></dd>


<dt id="arg-maxitnew">maxitNew<a class="anchor" aria-label="anchor" href="#arg-maxitnew"></a></dt>
<dd><p>the maximal number of iterations for regressions with starting
points  on data
specified at call for <code>model</code> after the removal of k'th row. By default 1.</p></dd>


<dt id="arg-trace">trace<a class="anchor" aria-label="anchor" href="#arg-trace"></a></dt>
<dd><p>a logical value specifying whether to tracking results when
<code>cores &gt; 1</code> it will result in a progress bar being created.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>a number of processor cores to be used,
any number greater than 1 activates code designed with <code>doParallel</code>,
<code>foreach</code> and <code>parallel</code> packages. Note that for now using parallel
computing makes tracing impossible so <code>trace</code> parameter is ignored in this case.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>a type of residual to return.</p></dd>


<dt id="arg-do-coef">do.coef<a class="anchor" aria-label="anchor" href="#arg-do-coef"></a></dt>
<dd><p>logical indicating if <code>dfbeta</code> computation for influence
should be done. <code>FALSE</code> by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p>For <code>hatvalues</code> – A matrix with n rows and p columns where n is a
number of observations in the data and p is number of regression parameters.</p></li>
<li><p>For <code>dfpopsize</code> – A vector for which k'th element corresponds
to the difference between point estimate of population size estimation on
full data set and point estimate of population size estimation after the
removal of k'th unit from the data set.</p></li>
<li><p>For <code>dfbeta</code> – A matrix with n rows and p observations where p
is a number of units in data and p is the number of regression parameters.
K'th row of this matrix corresponds to
-_-k
where _-k is a vector of estimates for
regression parameters after the removal of k'th row from the data.</p></li>
<li><p><code>cooks.distance</code> – A matrix with a single columns with
values of cooks distance for every unit in <code>model.matrix</code></p></li>
<li><p><code>residuals.singleRStaticCountData</code> – A <code>data.frame</code>
with chosen residuals.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p></p>
<p><code>dfpopsize</code> and <code>dfbeta</code> are closely related. <code>dfbeta</code>
fits a regression after removing a specific row from the data and returns the
difference between regression coefficients estimated on full data set and
data set obtained after deletion of that row, and repeats procedure once
for every unit present in the data.<code>dfpopsize</code> does the same for
population size estimation utilizing coefficients computed by <code>dfbeta</code>.</p>
<p><code>cooks.distance</code> is implemented (for now) only for models with a single
linear predictor and works exactly like the method for <code>glm</code> class.</p>
<p><code>sigma</code> computes the standard errors of predicted means. Returns a matrix
with two columns first for truncated mean and the other for the non-truncated mean.</p>
<p><code>residuals.singleRStaticCountData</code> (can be abbreviated to <code>resid</code>)
works like <code>residuals.glm</code> with the exception that:</p><ul><li><p><code>"pearson"</code> – returns non standardized residuals.</p></li>
<li><p><code>"pearsonSTD"</code> – is currently defined only for single predictors
models but will be extended to all models in a near future, but for families
with more than one distribution parameter it will be a multivariate residual.</p></li>
<li><p><code>"response"</code> – returns both residuals computed with truncated
and non truncated fitted value.</p></li>
<li><p><code>"working"</code> – is possibly multivariate if more than one linear
predictor is present.</p></li>
<li><p><code>"deviance"</code> – is not yet defined for all families in
<code><a href="singleRmodels.html">singleRmodels()</a></code> e.g. negative binomial based methods.</p></li>
<li><p><code>"all"</code> – returns all available residual types.</p></li>
</ul><p><code>hatvalues.singleRStaticCountData</code> is method for <code>singleRStaticCountData</code>
class for extracting diagonal elements of projection matrix.</p>
<p>Since <code>singleRcapture</code> supports not only regular glm's but also vglm's the
<code>hatvalues</code> returns a matrix with number of columns corresponding to number
of linear predictors in a model, where kth column corresponds to elements of
the diagonal of projection matrix associated with kth linear predictor.
For glm's
W^12X
(X^TWX)^-1
X^TW^12
where: W=E(Diag
(^2^T
))
and X is a model (lm) matrix.
For vglm's present in the package it is instead :
X_vlm
(X_vlm^TWX_vlm)^-1
X_vlm^TW
where:

W = E(bmatrix
Diag(^2_1^T_1) &amp;
Diag(^2_1^T_2) &amp;
 &amp; Diag(^2_1^T_p)<br>
Diag(^2_2^T_1) &amp;
Diag(^2_2^T_2) &amp;
 &amp; Diag(^2_2^T_p)<br>
 &amp;  &amp;  &amp; <br>
Diag(^2_p^T_1) &amp;
Diag(^2_p^T_2) &amp;
 &amp; Diag(^2_p^T_p)
bmatrix)
is a block matrix constructed by taking the expected  value from diagonal
matrixes corresponding to second derivatives with respect to each linear
predictor (and mixed derivatives) and
X_vlm is a model (vlm)
matrix constructed using specifications in <code>controlModel</code> and
call to <code>estimatePopsize</code>.</p>
<p><code>influence</code> works like <code>glm</code> counterpart computing the most important
influence measures.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="estimatePopsize.html">estimatePopsize()</a></code> <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">stats::hatvalues()</a></code> <code><a href="controlMethod.html">controlMethod()</a></code> <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">stats::dfbeta()</a></code>
<code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">stats::cooks.distance()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Piotr Chlebicki, Maciej Beręsewicz</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># For singleRStaticCountData class</span></span></span>
<span class="r-in"><span><span class="co"># Get simple model</span></span></span>
<span class="r-in"><span><span class="va">Model</span> <span class="op">&lt;-</span> <span class="fu"><a href="estimatePopsize.html">estimatePopsize</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">capture</span> <span class="op">~</span> <span class="va">nation</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">gender</span>, </span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">netherlandsimmigrant</span>, </span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">ztpoisson</span>, </span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"IRLS"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Get dfbeta</span></span></span>
<span class="r-in"><span><span class="va">dfb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbeta</a></span><span class="op">(</span><span class="va">Model</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># The dfpopsize results are obtained via (It is also possible to not provide </span></span></span>
<span class="r-in"><span><span class="co"># dfbeta then they will be computed manually):</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">dfpopsize</span><span class="op">(</span><span class="va">Model</span>, dfbeta <span class="op">=</span> <span class="va">dfb</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4236.412     2.664     2.664     5.448    17.284   117.448 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="regDiagSingleR-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># see vaious types of residuals:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">Model</span>, <span class="st">"all"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       lambda truncatedResponse nontruncatedResponse    pearson pearsonSTD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -0.9328875       -0.25364898            0.5294668 -0.4864422 -0.4867283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.9328875       -0.25364898            0.5294668 -0.4864422 -0.4867283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.9328875       -0.25364898            0.5294668 -0.4864422 -0.4867283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -0.9791760       -0.06666172            0.8695135 -0.2554869 -0.2559964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.9791760       -0.06666172            0.8695135 -0.2554869 -0.2559964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2.7449807        0.74635102            1.5294668  1.4313347  1.4321768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     deviance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -0.6992491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.6992491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.6992491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -0.3631875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.3631875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1.0619767</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Piotr Chlebicki, Maciej Beręsewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

