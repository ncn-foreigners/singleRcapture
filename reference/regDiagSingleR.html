<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="List of some regression diagnostics implemented for
singleR class. Functions that either require no changes from
glm class or are not relevant to context of singleRcapture
are omitted."><title>Regression diagnostics in singleRcapture — dfpopsize • singleRcapture</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Regression diagnostics in singleRcapture — dfpopsize"><meta property="og:description" content="List of some regression diagnostics implemented for
singleR class. Functions that either require no changes from
glm class or are not relevant to context of singleRcapture
are omitted."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">singleRcapture</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ncn-foreigners/singleRcapture/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Regression diagnostics in <code>singleRcapture</code></h1>
      <small class="dont-index">Source: <a href="https://github.com/ncn-foreigners/singleRcapture/blob/HEAD/R/Methods.R" class="external-link"><code>R/Methods.R</code></a>, <a href="https://github.com/ncn-foreigners/singleRcapture/blob/HEAD/R/documentationFiles.R" class="external-link"><code>R/documentationFiles.R</code></a></small>
      <div class="d-none name"><code>regDiagSingleR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>List of some regression diagnostics implemented for
<code>singleR</code> class. Functions that either require no changes from
<code>glm</code> class or are not relevant to context of <code>singleRcapture</code>
are omitted.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dfpopsize</span><span class="op">(</span><span class="va">model</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for singleR</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">hatvalues</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for singleR</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbeta</a></span><span class="op">(</span><span class="va">model</span>, maxitNew <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for singleR</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, <span class="st">"pearsonSTD"</span>, <span class="st">"response"</span>, <span class="st">"working"</span>, <span class="st">"deviance"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for singleR</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">cooks.distance</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for singleR</span></span>
<span><span class="fu">dfpopsize</span><span class="op">(</span><span class="va">model</span>, dfbeta <span class="op">=</span> <span class="cn">NULL</span>, observedPop <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>model, object</dt>
<dd><p>object of <code>singleR</code> class.</p></dd>


<dt>...</dt>
<dd><p>arguments passed to other methods.
Notably <code>dfpopsize.singleR</code> calls <code>dfbeta.singleR</code> if no
<code>dfbeta</code> argument was provided and <code>controlMethod</code> is called in
<code>dfbeta</code> method.</p></dd>


<dt>maxitNew</dt>
<dd><p>maximal number of iterations for regressions with starting
points <em></em>\(\hat{\boldsymbol{\beta}}\) on data specified at call for
<code>model</code> after the removal of k'th row. By default 1.</p></dd>


<dt>type</dt>
<dd><p>a type of</p></dd>


<dt>dfbeta</dt>
<dd><p>if <code>dfbeta</code> was already obtained it is possible to pass
them into function so that they need not be computed for the second time.</p></dd>


<dt>observedPop</dt>
<dd><p>logical. For <code>singleR</code> class object if set to
<code>TRUE</code> indicates that 1 will be returned for units which do not
take part in population size estimation (e.g. 1's in zero one truncated
models or units with count =&gt; 3 for <code>zelterman</code> of basic <code>chao</code>
model) if set to <code>FALSE</code> (default) these units will not be included
in results.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<ul><li><p>For <code>hatvalues</code> -- A matrix with n rows and p columns where n is a
number of observations in the data and p is number of regression parameters.</p></li>
<li><p>For <code>dfpopsize</code> -- A vector for which k'th element corresponds
to the difference between point estimate of population size estimation on
full data set and point estimate of population size estimation after the
removal of k'th unit from the data set.</p></li>
<li><p>For <code>dfbeta</code> -- A matrix with n rows and p observations where p
is a number of units in data and p is the number of regression parameters.
K'th row of this matrix corresponds to
<em></em>\(\hat{\boldsymbol{\beta}}-\hat{\boldsymbol{\beta}}_{-k}\)
where <em></em>\(\hat{\boldsymbol{\beta}}_{-k}\) is a vector of estimates
for regression parameters after the removal of k'th row from the data.</p></li>
<li><p><code>cooks.distance</code> -- A matrix with a single columns with
values of cooks distance for every unit in <code>model.matrix</code></p></li>
<li><p><code>residuals.singleR</code> -- A <code>data.frame</code> with chosen residuals.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
<p><code>dfpopsize</code> and <code>dfbeta</code> are closely related. <code>dfbeta</code>
fits a regression after removing a specific row from the data and returns the
difference between regression coefficients estimated on full data set and
data set obtained after deletion of that row, and repeats procedure once
for every unit present in the data.<code>dfpopsize</code> does the same for
population size estimation utilising coefficients computed by <code>dfbeta</code>.</p>
<p><code>cooks.distance</code> is implemented (for now) only for models with a single
linear predictor and works exactly like the method for <code>glm</code> class.</p>
<p><code>residuals.singleR</code> (can be abbreviated to <code>resid</code>) works like
<code>residuals.glm</code> with the exception that:</p><ul><li><p><code>"pearson"</code> -- returns non standardised residuals.</p></li>
<li><p><code>"pearsonSTD"</code> -- is currently defined only for single predictors
models but will be extended to all models in a near future, but for families
with more than one distribution parameter it will be a multivariate residual.</p></li>
<li><p><code>"response"</code> -- returns both residuals computed with truncated
and non truncated fitted value.</p></li>
<li><p><code>"working"</code> -- is possibly multivariate if more than one linear
predictor is present.</p></li>
<li><p><code>"deviance"</code> -- is not yet defined for all families in
<code><a href="singleRmodels.html">singleRmodels()</a></code> e.g. negative binomial based methods.</p></li>
<li><p><code>"all"</code> -- returns all available residual types.</p></li>
</ul><p><code>hatvalues.singleR</code> is method for <code>singleR</code> class for extracting
diagonal elements of projection matrix.</p>
<p>Since <code>singleRcapture</code> supports
not only regular glm's but also vglm's the <code>hatvalues</code> returns a matrix
with number of columns corresponding to number of linear predictors in a model,
where kth column corresponds to elements of the diagonal of projection
matrix associated with kth linear predictor. For glm's
\[\boldsymbol{W}^{\frac{1}{2}}\boldsymbol{X}
\left(\boldsymbol{X}^{T}\boldsymbol{W}\boldsymbol{X}\right)^{-1}
\boldsymbol{X}^{T}\boldsymbol{W}^{\frac{1}{2}}\]
where: <em></em>\(\boldsymbol{W}=\mathbb{E}\left(\text{Diag}
\left(\frac{\partial^{2}\ell}{\partial\boldsymbol{\eta}^{T}
\partial\boldsymbol{\eta}}\right)\right)\)
and <em></em>\(\boldsymbol{X}\) is a model (lm) matrix.
For vglm's present in the package it is instead :
\[\boldsymbol{X}_{vlm}
\left(\boldsymbol{X}_{vlm}^{T}\boldsymbol{W}\boldsymbol{X}_{vlm}\right)^{-1}
\boldsymbol{X}_{vlm}^{T}\boldsymbol{W}\]
where:
\[
\boldsymbol{W} = \mathbb{E}\left(\begin{bmatrix}
\text{Diag}\left(\frac{\partial^{2}\ell}{\partial\eta_{1}^{T}\partial\eta_{1}}\right) &amp;
\text{Diag}\left(\frac{\partial^{2}\ell}{\partial\eta_{1}^{T}\partial\eta_{2}}\right) &amp;
\dotso &amp; \text{Diag}\left(\frac{\partial^{2}\ell}{\partial\eta_{1}^{T}\partial\eta_{p}}\right)\cr
\text{Diag}\left(\frac{\partial^{2}\ell}{\partial\eta_{2}^{T}\partial\eta_{1}}\right) &amp;
\text{Diag}\left(\frac{\partial^{2}\ell}{\partial\eta_{2}^{T}\partial\eta_{2}}\right) &amp;
\dotso &amp; \text{Diag}\left(\frac{\partial^{2}\ell}{\partial\eta_{2}^{T}\partial\eta_{p}}\right)\cr
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\cr
\text{Diag}\left(\frac{\partial^{2}\ell}{\partial\eta_{p}^{T}\partial\eta_{1}}\right) &amp;
\text{Diag}\left(\frac{\partial^{2}\ell}{\partial\eta_{p}^{T}\partial\eta_{2}}\right) &amp;
\dotso &amp; \text{Diag}\left(\frac{\partial^{2}\ell}{\partial\eta_{p}^{T}\partial\eta_{p}}\right)
\end{bmatrix}\right)\]
is a block matrix constructed by taking the expected  value from diagonal
matrixes corresponding to second derivatives with respect to each linear
predictor (and mixed derivatives) and
<em></em>\(\boldsymbol{X}_{vlm}\) is a model (vlm) matrix constructed using
specifications in <code>controlModel</code> and call to <code>estimatePopsize</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="estimatePopsize.html">estimatePopsize()</a></code> <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">stats::hatvalues()</a></code> <code><a href="controlMethod.html">controlMethod()</a></code> <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">stats::dfbeta()</a></code>
<code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">stats::cooks.distance()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Piotr Chlebicki, Maciej Beręsewicz</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># For singleR class</span></span></span>
<span class="r-in"><span><span class="co"># Get simple model</span></span></span>
<span class="r-in"><span><span class="va">Model</span> <span class="op">&lt;-</span> <span class="fu"><a href="estimatePopsize.html">estimatePopsize</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">capture</span> <span class="op">~</span> <span class="va">nation</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">gender</span>, </span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">netherlandsimmigrant</span>, </span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">ztpoisson</span>, </span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"IRLS"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Get df beta</span></span></span>
<span class="r-in"><span><span class="va">dfb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbeta</a></span><span class="op">(</span><span class="va">Model</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># The results</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">dfpopsize</span><span class="op">(</span><span class="va">Model</span>, dfbeta <span class="op">=</span> <span class="va">dfb</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4236.412     2.664     2.664     5.448    17.284   117.448 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="regDiagSingleR-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># It is also possible to not provide dfbeta then they will be</span></span></span>
<span class="r-in"><span><span class="co"># computed manually</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">dfpopsize</span><span class="op">(</span><span class="va">Model</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4236.412     2.664     2.664     5.448    17.284   117.448 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Piotr Chlebicki, Maciej Beręsewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

