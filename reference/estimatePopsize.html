<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Single-source capture-recapture models — estimatePopsize • singleRcapture</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Single-source capture-recapture models — estimatePopsize"><meta name="description" content="estimatePopsize first fits appropriate (v)glm model and
then estimates full (observed and unobserved) population size.
In this types of models it is assumed that the response vector
(i.e. the dependent variable) corresponds to the number of times a given unit
was observed in the source.
Population size is then usually estimated by Horvitz-Thompson type estimator:
N = _k=1^NI_kP(Y_k&amp;gt;0) =
_k=1^N_obs11-P(Y_k=0)
where I_k=I_Y_k &amp;gt; 0 are indicator
variables, with value 1 if kth unit was observed at least once and 0 otherwise."><meta property="og:description" content="estimatePopsize first fits appropriate (v)glm model and
then estimates full (observed and unobserved) population size.
In this types of models it is assumed that the response vector
(i.e. the dependent variable) corresponds to the number of times a given unit
was observed in the source.
Population size is then usually estimated by Horvitz-Thompson type estimator:
N = _k=1^NI_kP(Y_k&amp;gt;0) =
_k=1^N_obs11-P(Y_k=0)
where I_k=I_Y_k &amp;gt; 0 are indicator
variables, with value 1 if kth unit was observed at least once and 0 otherwise."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">singleRcapture</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/singleRcapture.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncn-foreigners/singleRcapture/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Single-source capture-recapture models</h1>
      <small class="dont-index">Source: <a href="https://github.com/ncn-foreigners/singleRcapture/blob/0.2.3/R/estimatePopsize.R" class="external-link"><code>R/estimatePopsize.R</code></a></small>
      <div class="d-none name"><code>estimatePopsize.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>estimatePopsize</code> first fits appropriate (v)glm model and
then estimates full (observed and unobserved) population size.
In this types of models it is assumed that the response vector
(i.e. the dependent variable) corresponds to the number of times a given unit
was observed in the source.
Population size is then usually estimated by Horvitz-Thompson type estimator:</p>
<p>N = _k=1^NI_kP(Y_k&gt;0) =
_k=1^N_obs11-P(Y_k=0)</p>
<p>where I_k=I_Y_k &gt; 0 are indicator
variables, with value 1 if kth unit was observed at least once and 0 otherwise.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimatePopsize</span><span class="op">(</span><span class="va">formula</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">estimatePopsize</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ztpoisson"</span>, <span class="st">"ztnegbin"</span>, <span class="st">"ztgeom"</span>, <span class="st">"zotpoisson"</span>, <span class="st">"ztoipoisson"</span>,</span>
<span>    <span class="st">"oiztpoisson"</span>, <span class="st">"ztHurdlepoisson"</span>, <span class="st">"Hurdleztpoisson"</span>, <span class="st">"zotnegbin"</span>, <span class="st">"ztoinegbin"</span>,</span>
<span>    <span class="st">"oiztnegbin"</span>, <span class="st">"ztHurdlenegbin"</span>, <span class="st">"Hurdleztnegbin"</span>, <span class="st">"zotgeom"</span>, <span class="st">"ztoigeom"</span>, <span class="st">"oiztgeom"</span>,</span>
<span>    <span class="st">"ztHurdlegeom"</span>, <span class="st">"ztHurdlegeom"</span>, <span class="st">"zelterman"</span>, <span class="st">"chao"</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  naAction <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"optim"</span>, <span class="st">"IRLS"</span><span class="op">)</span>,</span>
<span>  popVar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"analytic"</span>, <span class="st">"bootstrap"</span>, <span class="st">"noEst"</span><span class="op">)</span>,</span>
<span>  controlMethod <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  controlModel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  controlPopVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  modelFrame <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ratioReg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">offset</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a formula for the model to be fitted, only applied to the "main"
linear predictor. Only single response models are available.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional optional arguments passed to other methods eg.
<code>estimatePopsizeFit</code>.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame or object coercible to data.frame class containing
data for the regression and population size estimation.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>a model for regression and population estimate full description in <code><a href="singleRmodels.html">singleRmodels()</a></code>.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>an optional object of prior weights used in fitting the model.
Can be used to specify number of occurrences of rows in data see <code><a href="controlModel.html">controlModel()</a></code></p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>a logical vector indicating which observations should be used
in regression and population size estimation. It will be evaluated on <code>data</code> argument provided on call.</p></dd>


<dt id="arg-naaction">naAction<a class="anchor" aria-label="anchor" href="#arg-naaction"></a></dt>
<dd><p>Not yet implemented.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>a method for fitting values currently supported: iteratively
reweighted least squares (<code>IRLS</code>) and maximum likelihood (<code>optim</code>).</p></dd>


<dt id="arg-popvar">popVar<a class="anchor" aria-label="anchor" href="#arg-popvar"></a></dt>
<dd><p>a method of constructing confidence interval and estimating
the standard error either analytic or bootstrap.
Bootstrap confidence interval type may be specified in
<code>controlPopVar.</code> There is also the third possible value of <code>noEst</code>
which skips the population size estimate all together.</p></dd>


<dt id="arg-controlmethod">controlMethod<a class="anchor" aria-label="anchor" href="#arg-controlmethod"></a></dt>
<dd><p>a list indicating parameters to use in fitting the model
may be constructed with <code><a href="controlMethod.html">singleRcapture::controlMethod</a></code> function.
More information included in <code><a href="controlMethod.html">controlMethod()</a></code>.</p></dd>


<dt id="arg-controlmodel">controlModel<a class="anchor" aria-label="anchor" href="#arg-controlmodel"></a></dt>
<dd><p>a list indicating additional formulas for regression
(like formula for inflation parameter/dispersion parameter) may be
constructed with <code><a href="controlModel.html">singleRcapture::controlModel</a></code> function.
More information will eventually be included in <code><a href="controlModel.html">controlModel()</a></code>.</p></dd>


<dt id="arg-controlpopvar">controlPopVar<a class="anchor" aria-label="anchor" href="#arg-controlpopvar"></a></dt>
<dd><p>a list indicating parameters to use in estimating variance
of population size estimation may be constructed with
<code><a href="controlPopVar.html">singleRcapture::controlPopVar</a></code> function.
More information included in <code><a href="controlPopVar.html">controlPopVar()</a></code>.</p></dd>


<dt id="arg-modelframe-x-y">modelFrame, x, y<a class="anchor" aria-label="anchor" href="#arg-modelframe-x-y"></a></dt>
<dd><p>logical values indicating whether to return model matrix,
dependent vector and model matrix as a part of output.</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>not yet implemented.</p></dd>


<dt id="arg-ratioreg">ratioReg<a class="anchor" aria-label="anchor" href="#arg-ratioreg"></a></dt>
<dd><p>Not yet implemented</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>a matrix of offset values with the number of columns matching the
number of distribution parameters providing offset values to each of
linear predictors.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an object of class <code>c("singleRStaticCountData", "singleR", "glm", "lm")</code>
with type <code>list</code> containing:<br></p><ul><li><p><code>y</code> – Vector of dependent variable if specified at function call.</p></li>
<li><p><code>X</code> – Model matrix if specified at function call.</p></li>
<li><p><code>formula</code> – A list with formula provided on call and additional formulas specified in <code>controlModel</code>.</p></li>
<li><p><code>call</code> – Call matching original input.</p></li>
<li><p><code>coefficients</code> – A vector of fitted coefficients of regression.</p></li>
<li><p><code>control</code> – A list of control parameters for <code>controlMethod</code> and <code>controlModel</code>, <code>controlPopVar</code> is included in populationSize.</p></li>
<li><p><code>model</code> – Model which estimation of population size and regression was built, object of class family.</p></li>
<li><p><code>deviance</code> – Deviance for the model.</p></li>
<li><p><code>priorWeights</code> – Prior weight provided on call.</p></li>
<li><p><code>weights</code> – If <code>IRLS</code> method of estimation was chosen weights returned by <code>IRLS</code>, otherwise same as <code>priorWeights</code>.</p></li>
<li><p><code>residuals</code> – Vector of raw residuals.</p></li>
<li><p><code>logL</code> – Logarithm likelihood obtained at final iteration.</p></li>
<li><p><code>iter</code> – Numbers of iterations performed in fitting or if <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> was used number of call to loglikelihood function.</p></li>
<li><p><code>dfResiduals</code> – Residual degrees of freedom.</p></li>
<li><p><code>dfNull</code> – Null degrees of freedom.</p></li>
<li><p><code>fittValues</code> – Data frame of fitted values for both mu (the expected value) and lambda (Poisson parameter).</p></li>
<li><p><code>populationSize</code> – A list containing information of population size estimate.</p></li>
<li><p><code>modelFrame</code> – Model frame if specified at call.</p></li>
<li><p><code>linearPredictors</code> – Vector of fitted linear predictors.</p></li>
<li><p><code>sizeObserved</code> – Number of observations in original model frame.</p></li>
<li><p><code>terms</code> – terms attribute of model frame used.</p></li>
<li><p><code>contrasts</code> – contrasts specified in function call.</p></li>
<li><p><code>naAction</code> – naAction used.</p></li>
<li><p><code>which</code> – list indicating which observations were used in regression/population size estimation.</p></li>
<li><p><code>fittingLog</code> – log of fitting information for <code>"IRLS"</code> fitting if specified in <code>controlMethod</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The generalized linear model is characterized by equation
=X
where X is the (lm) model matrix.
The vector generalized linear model is similarly characterized by equations
_k=X_k_k
where X_k is a (lm) model
matrix constructed from appropriate formula
(specified in <code>controlModel</code> parameter).</p>
<p>The  is then a vector constructed as:</p>
<p>=pmatrix
_1 <br>
_2 <br><br>
_p
pmatrix^T</p>
<p>and in cases of models in our package the (vlm) model matrix
is constructed as a block matrix:</p>
<p>X_vlm=
pmatrix
X_1 &amp; 0 &amp; &amp;0<br>
0 &amp; X_2 &amp; &amp;0<br>
 &amp;  &amp;  &amp; <br>
0 &amp; 0 &amp; &amp;X_p
pmatrix</p>
<p>this differs from convention in <code>VGAM</code> package (if we only consider our
special cases of vglm models) but this is just a convention and does not
affect the model, this convention is taken because it makes fitting with
IRLS (explanation of algorithm in <code><a href="estimatePopsizeFit.html">estimatePopsizeFit()</a></code>) algorithm easier.
(If <code>constraints</code> matrixes in <code>vglm</code> match the ones we implicitly
use the <code>vglm</code> model matrix differs with respect to order of
<code>kronecker</code> multiplication of <code>X</code> and <code>constraints</code>.)
In this package we use observed likelihood to fit regression models.</p>
<p>As mentioned above usually the population size estimation is done via:
N = _k=1^NI_kP(Y_k&gt;0) =
_k=1^N_obs11-P(Y_k=0)</p>
<p>where I_k=I_Y_k &gt; 0 are indicator variables,
with value 1 if kth unit was observed at least once and 0 otherwise.
The P(Y_k&gt;0) are estimated by maximum likelihood.</p>
<p>The following assumptions are usually present when using
the method of estimation described above:</p><ol><li><p>The specified regression model is correct. This entails linear
relationship between independent variables and dependent ones and
dependent variable being generated by appropriate distribution.</p></li>
<li><p>No unobserved heterogeneity. If this assumption is broken there
are some possible (admittedly imperfect) workarounds see details in
<code><a href="singleRmodels.html">singleRmodels()</a></code>.</p></li>
<li><p>The population size is constant in relevant time frame.</p></li>
<li><p>Depending on confidence interval construction (asymptotic) normality
of N statistic is assumed.</p></li>
</ol><p>There are two ways of estimating variance of estimate N,
the first being <code>"analytic"</code> usually done by application of
law of total variance to N:</p>
<p>var(N)=E(var
(N|I_1,...,I_n))+
var(E(N|I_1,...,I_n))</p>
<p>and then by  method to
N|I_1,... I_N:</p>
<p>E(var
(N|I_1,...,I_n))=
.((N|I_1,...,I_N))^T
cov()
((N|I_1,...,I_N))
|_=</p>
<p>and the var(E(N|I_1,...,I_n))
term may be derived analytically (if we assume independence of
observations) since N|I_1,...,I_n
is just a constant.</p>
<p>In general this gives us:

aligned
var(E(N|I_1,...,I_n))&amp;=
var(_k=1^NI_kP(Y_k&gt;0))<br>
&amp;=_k=1^Nvar(I_kP(Y_k&gt;0))<br>
&amp;=_k=1^N1P(Y_k&gt;0)^2var(I_k)<br>
&amp;=_k=1^N1P(Y_k&gt;0)^2P(Y_k&gt;0)(1-P(Y_k&gt;0))<br>
&amp;=_k=1^N1P(Y_k&gt;0)(1-P(Y_k&gt;0))<br>
&amp;_k=1^NI_kP(Y_k&gt;0)^2(1-P(Y_k&gt;0))<br>
&amp;=_k=1^N_obs1-P(Y_k&gt;0)P(Y_k&gt;0)^2
aligned</p>
<p>Where the approximation on 6th line appears because in 5th line we sum over
all units, that includes unobserved units, since I_k are
independent and I_k b(P(Y_k&gt;0)) the 6th line
is an unbiased estimator of the 5th line.</p>
<p>The other method for estimating variance is <code>"bootstrap"</code>, but since
N_obs=_k=1^NI_k is also a random variable bootstrap
will not be as simple as just drawing N_obs units from data
with replacement and just computing N.</p>
<p>Method described above is referred to in literature as <code>"nonparametric"</code>
bootstrap (see <code><a href="controlPopVar.html">controlPopVar()</a></code>), due to ignoring variability in observed
sample size it is likely to underestimate variance.</p>
<p>A more sophisticated bootstrap procedure may be described as follows:</p><ol><li><p>Compute the probability distribution as:

f_0N,
f_1N,
...,
f_yN
where f_n denotes observed
marginal frequency of units being observed exactly n times.</p></li>
<li><p>Draw N units from the distribution above
(if N is not an integer than draw
N + b(N-N)),
where  is the floor function.</p></li>
<li><p>Truncated units with y=0.</p></li>
<li><p>If there are covariates draw them from original data with replacement from
uniform distribution. For example if unit drawn to new data has
y=2 choose one of covariate vectors from original data that
was associated with unit for which was observed 2 times.</p></li>
<li><p>Regress y_new on X_vlm new
and obtain _new, with starting point
 to make it slightly faster, use them
to compute N_new.</p></li>
<li><p>Repeat 2-5 unit there are at least <code>B</code> statistics are obtained.</p></li>
<li><p>Compute confidence intervals based on <code>alpha</code> and <code>confType</code>
specified in <code><a href="controlPopVar.html">controlPopVar()</a></code>.</p></li>
</ol><p>To do step 1 in procedure above it is convenient to first draw binary vector of length
N + b(N-N) with probability
1-f_0N, sum elements in that vector to
determine the sample size and then draw sample of this size uniformly from the data.</p>
<p>This procedure is known in literature as <code>"semiparametric"</code> bootstrap
it is necessary to assume that the have a correct estimate
N in order to use this type of bootstrap.</p>
<p>Lastly there is <code>"paramteric"</code> bootstrap where we assume that the
probabilistic model used to obtain N is correct the
bootstrap procedure may then be described as:</p><ol><li><p>Draw N + b(N-N)
covariate information vectors with replacement from data according to
probability distribution that is proportional to: N_k,
where N_k is the contribution of kth unit i.e.
1P(Y_k&gt;0).</p></li>
<li><p>Determine  matrix using estimate
.</p></li>
<li><p>Generate y (dependent variable)
vector using  and
probability mass function associated with chosen model.</p></li>
<li><p>Truncated units with y=0 and construct
y_new and X_vlm new.</p></li>
<li><p>Regress y_new on X_vlm new
and obtain _new
use them to compute N_new.</p></li>
<li><p>Repeat 1-5 unit there are at least <code>B</code> statistics are obtained.</p></li>
<li><p>Compute confidence intervals based on <code>alpha</code> and <code>confType</code>
specified in <code><a href="controlPopVar.html">controlPopVar()</a></code></p></li>
</ol><p>It is also worth noting that in the <code>"analytic"</code> method <code>estimatePopsize</code>
only uses "standard" covariance matrix estimation. It is possible that improper
covariance matrix estimate is the only part of estimation that has its assumptions
violated. In such cases post-hoc procedures are implemented in this package
to address this issue.</p>
<p>Lastly confidence intervals for N are computed
(in analytic case) either by assuming that it follows a normal distribution
or that variable (N-N)
follows a normal distribution.</p>
<p>These estimates may be found using either <code>summary.singleRStaticCountData</code>
method or <code>popSizeEst.singleRStaticCountData</code> function. They're labelled as
<code>normal</code> and <code>logNormal</code> respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>General single source capture recapture literature:</p>
<p>Zelterman, Daniel (1988). ‘Robust estimation in truncated discrete distributions
with application to capture-recapture experiments’. In: Journal of statistical
planning and inference 18.2, pp. 225–237.</p>
<p>Heijden, Peter GM van der et al. (2003). ‘Point and interval estimation of the
population size using the truncated Poisson regression model’.
In: Statistical Modelling 3.4, pp. 305–322. doi: 10.1191/1471082X03st057oa.</p>
<p>Cruyff, Maarten J. L. F. and Peter G. M. van der Heijden (2008). ‘Point and
Interval Estimation of the Population Size Using a Zero-Truncated Negative
Binomial Regression Model’. In: Biometrical Journal 50.6, pp. 1035–1050.
doi: 10.1002/bimj.200810455</p>
<p>Böhning, Dankmar and Peter G. M. van der Heijden (2009). ‘A covariate adjustment
for zero-truncated approaches to estimating the size of hidden and
elusive populations’. In: The Annals of Applied Statistics 3.2, pp. 595–610.
doi: 10.1214/08-AOAS214.</p>
<p>Böhning, Dankmar, Alberto Vidal-Diez et al. (2013). ‘A Generalization of
Chao’s Estimator for Covariate Information’. In: Biometrics 69.4, pp. 1033–
1042. doi: 10.1111/biom.12082</p>
<p>Böhning, Dankmar and Peter G. M. van der Heijden (2019). ‘The identity of the
zero-truncated, one-inflated likelihood and the zero-one-truncated likelihood
for general count densities with an application to drink-driving in Britain’.
In: The Annals of Applied Statistics 13.2, pp. 1198–1211.
doi: 10.1214/18-AOAS1232.</p>
<p>Navaratna WC, Del Rio Vilas VJ, Böhning D. Extending Zelterman's approach for
robust estimation of population size to zero-truncated clustered Data.
Biom J. 2008 Aug;50(4):584-96. doi: 10.1002/bimj.200710441.</p>
<p>Böhning D. On the equivalence of one-inflated zero-truncated and zero-truncated
one-inflated count data likelihoods. Biom J. 2022 Aug 15. doi: 10.1002/bimj.202100343.</p>
<p>Böhning, D., Friedl, H. Population size estimation based upon zero-truncated,
one-inflated and sparse count data. Stat Methods Appl 30, 1197–1217 (2021).
doi: 10.1007/s10260-021-00556-8</p>
<p>Bootstrap:</p>
<p>Zwane, PGM EN and Van der Heijden, Implementing the parametric bootstrap in capture-recapture
models with continuous covariates 2003 Statistics &amp; probability letters 65.2 pp 121-125</p>
<p>Norris, James L and Pollock, Kenneth H Including model uncertainty in estimating variances
in multiple capture studies 1996 in Environmental and Ecological Statistics 3.3 pp 235-244</p>
<p>Vector generalized linear models:</p>
<p>Yee, T. W. (2015). Vector Generalized Linear and Additive Models:
With an Implementation in R. New York, USA: Springer. ISBN 978-1-4939-2817-0.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code> – For more information on generalized linear models.</p>
<p><code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim()</a></code> – For more information on <code>optim</code> function used in
<code>optim</code> method of fitting regression.</p>
<p><code><a href="controlMethod.html">controlMethod()</a></code> – For control parameters related to regression.</p>
<p><code><a href="controlPopVar.html">controlPopVar()</a></code> – For control parameters related to population size estimation.</p>
<p><code><a href="controlModel.html">controlModel()</a></code> – For control parameters related to model specification.</p>
<p><code><a href="estimatePopsizeFit.html">estimatePopsizeFit()</a></code> – For more information on fitting procedure in
<code>esitmate_popsize</code>.</p>
<p><code><a href="popSizeEst.html">popSizeEst()</a></code> <code><a href="redoPopEstimation.html">redoPopEstimation()</a></code> – For extracting population size
estimation results are applying post-hoc procedures.</p>
<p><code><a href="summary.singleRStaticCountData.html">summary.singleRStaticCountData()</a></code> – For summarizing important information about the
model and population size estimation results.</p>
<p><code><a href="marginalFreq.html">marginalFreq()</a></code> – For information on marginal frequencies and comparison
between observed and fitted quantities.</p>
<p><code><a href="https://rdrr.io/pkg/VGAM/man/vglm.html" class="external-link">VGAM::vglm()</a></code> – For more information on vector generalized linear models.</p>
<p><code><a href="singleRmodels.html">singleRmodels()</a></code> – For description of various models.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Piotr Chlebicki, Maciej Beręsewicz</p>
<p></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Model from 2003 publication </span></span></span>
<span class="r-in"><span><span class="co"># Point and interval estimation of the</span></span></span>
<span class="r-in"><span><span class="co"># population size using the truncated Poisson regression mode</span></span></span>
<span class="r-in"><span><span class="co"># Heijden, Peter GM van der et al. (2003)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">estimatePopsize</span><span class="op">(</span></span></span>
<span class="r-in"><span>   formula <span class="op">=</span> <span class="va">capture</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">nation</span>, </span></span>
<span class="r-in"><span>   data <span class="op">=</span> <span class="va">netherlandsimmigrant</span>, </span></span>
<span class="r-in"><span>   model <span class="op">=</span> <span class="va">ztpoisson</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimatePopsize.default(formula = capture ~ gender + age + nation, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = netherlandsimmigrant, model = ztpoisson)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pearson Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.486442 -0.486442 -0.298080  0.002093 -0.209444 13.910844 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For linear predictors associated with: lambda </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)           -1.3411     0.2149  -6.241 4.35e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gendermale             0.3972     0.1630   2.436 0.014832 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age&gt;40yrs             -0.9746     0.4082  -2.387 0.016972 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nationAsia            -1.0926     0.3016  -3.622 0.000292 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nationNorth Africa     0.1900     0.1940   0.979 0.327398    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nationRest of Africa  -0.9106     0.3008  -3.027 0.002468 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nationSurinam         -2.3364     1.0136  -2.305 0.021159 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nationTurkey          -1.6754     0.6028  -2.779 0.005445 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 1712.901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: 1757.213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance: 1128.553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: -848.4504 on 1872 Degrees of freedom </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of iterations: 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population size estimation results: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Point estimate 12690.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed proportion: 14.8% (N obs = 1880)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Std. Error 2808.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% CI for the population size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lowerBound upperBound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> normal      7186.444   18194.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logNormal   8431.275   19718.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% CI for the share of observed population:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lowerBound upperBound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> normal     10.332927   26.16037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logNormal   9.534281   22.29793</span>
<span class="r-in"><span><span class="co"># Graphical presentation of model fit</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"rootogram"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="estimatePopsize-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Statistical test</span></span></span>
<span class="r-in"><span><span class="co"># see documentation for summary.singleRmargin</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="marginalFreq.html">marginalFreq</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">1</span>, <span class="st">"group"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Goodness of fit of a regression model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Test statistics df P(&gt;X^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-squared test           50.06  1 1.5e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G-test                     34.31  1 4.7e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cells with fitted frequencies of &lt; 5 have been grouped </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cells used in calculating test(s) statistic: 1 2 3  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We currently support 2 methods of numerical fitting</span></span></span>
<span class="r-in"><span><span class="co"># (generalized) IRLS algorithm and via stats::optim</span></span></span>
<span class="r-in"><span><span class="co"># the latter one is faster when fitting negative binomial models </span></span></span>
<span class="r-in"><span><span class="co"># (and only then) due to IRLS having to numerically compute</span></span></span>
<span class="r-in"><span><span class="co"># (expected) information matrixes, optim is also less reliable when</span></span></span>
<span class="r-in"><span><span class="co"># using alphaFormula argument in controlModel</span></span></span>
<span class="r-in"><span><span class="va">modelNegBin</span> <span class="op">&lt;-</span> <span class="fu">estimatePopsize</span><span class="op">(</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">TOTAL_SUB</span> <span class="op">~</span> <span class="va">.</span>, </span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">farmsubmission</span>, </span></span>
<span class="r-in"><span>    model <span class="op">=</span> <span class="va">ztnegbin</span>, </span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"optim"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modelNegBin</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimatePopsize.default(formula = TOTAL_SUB ~ ., data = farmsubmission, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     model = ztnegbin, method = "optim")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pearson Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.71322 -0.33627 -0.14256  0.00001  0.14745  7.01427 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For linear predictors associated with: lambda </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  -3.17536    0.25947 -12.238  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_size      0.63932    0.01771  36.102  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_distance -0.07935    0.02228  -3.561 0.000369 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C_TYPEDairy   0.65919    0.03412  19.317  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For linear predictors associated with: alpha </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  0.58238    0.07299   7.979 1.48e-15 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 34538.73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: 34575.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance: 17730.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: -17264.37 on 24067 Degrees of freedom </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of calls to log-likelihood function: 654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population size estimation results: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Point estimate 41019.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed proportion: 29.3% (N obs = 12036)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Std. Error 1888.039</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% CI for the population size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lowerBound upperBound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> normal      37318.59   44719.56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logNormal   37548.53   44961.73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% CI for the share of observed population:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lowerBound upperBound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> normal      26.91440   32.25203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logNormal   26.76943   32.05452</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="marginalFreq.html">marginalFreq</a></span><span class="op">(</span><span class="va">modelNegBin</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Goodness of fit of a regression model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Test statistics df P(&gt;X^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-squared test           30.93 26    0.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G-test                     19.12 26    0.83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cells with fitted frequencies of &lt; 5 have been dropped </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cells used in calculating test(s) statistic: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># More advanced call that specifies additional formula and shows</span></span></span>
<span class="r-in"><span><span class="co"># in depth information about fitting procedure</span></span></span>
<span class="r-in"><span><span class="va">pseudoHurdleModel</span> <span class="op">&lt;-</span> <span class="fu">estimatePopsize</span><span class="op">(</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">capture</span> <span class="op">~</span> <span class="va">nation</span> <span class="op">+</span> <span class="va">age</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">netherlandsimmigrant</span>,</span></span>
<span class="r-in"><span>    model <span class="op">=</span> <span class="va">Hurdleztgeom</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"IRLS"</span>,</span></span>
<span class="r-in"><span>    controlMethod <span class="op">=</span> <span class="fu"><a href="controlMethod.html">controlMethod</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    controlModel <span class="op">=</span> <span class="fu"><a href="controlModel.html">controlModel</a></span><span class="op">(</span>piFormula <span class="op">=</span> <span class="op">~</span> <span class="va">gender</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration number 1 log-likelihood: -846.77533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter vector:  -1.52435898 -0.62008047  0.16074142 -0.49971856 -0.85750609 -0.78860226 -0.42067526 -0.44312806 -0.70241852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-likelihood reduction:  Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of gradient at current step:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  142.04204576   8.81177229 108.34506498   9.81769037  -0.39315787   1.30854693   2.40548998 -74.87532567 -61.35856914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm will terminate if one of following conditions will be met:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At current step the highest change was: 1.524359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration number 2 log-likelihood: -828.37292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter vector:  -1.11072318 -0.66579168  0.16032836 -0.51705318 -1.27720523 -0.93384649 -0.55851513 -0.52578104 -0.41829231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-likelihood reduction:  18.402407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of gradient at current step:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -30.198518684  -2.367348700 -20.882807839  -2.990134863  -0.033406007  -0.236178150  -0.291286777  12.908733472   8.061651997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm will terminate if one of following conditions will be met:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At current step the highest change was: 0.41969914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration number 3 log-likelihood: -827.03041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter vector:  -1.26212005 -0.65481997  0.16367571 -0.51638838 -1.22088469 -0.89969898 -0.52141633 -0.61358371 -0.51802941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-likelihood reduction:  1.3425075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of gradient at current step:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.399477106 -0.125534668 -0.025207083 -0.124263770 -0.012272383 -0.001036293 -0.037255028 -0.402440790 -0.559697165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm will terminate if one of following conditions will be met:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At current step the highest change was: 0.15139687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration number 4 log-likelihood: -827.01868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter vector:  -1.28179260 -0.65559457  0.16445074 -0.51702724 -1.22154349 -0.89783555 -0.52232876 -0.64032726 -0.52639838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-likelihood reduction:  0.011729135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of gradient at current step:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.01965800195 -0.00376668640  0.02342526604  0.00085753707 -0.00131148043  0.00040402353 -0.00468611749 -0.01113423867 -0.00978879207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm will terminate if one of following conditions will be met:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At current step the highest change was: 0.026743552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration number 5 log-likelihood: -827.01868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter vector:  -1.28177518 -0.65568959  0.16449297 -0.51701807 -1.22190483 -0.89779857 -0.52262758 -0.64032669 -0.52640250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-likelihood reduction:  0.0000018094989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of gradient at current step:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.0001561899387  0.0000207886459 -0.0000413107753 -0.0000259493362  0.0000040518562 -0.0000068413444 -0.0000222504320  0.0000011784080  0.0000010016067</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm will terminate if one of following conditions will be met:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At current step the highest change was: 0.00036133989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration number 6 log-likelihood: -827.01868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter vector:  -1.28177959 -0.65568717  0.16449471 -0.51701668 -1.22190170 -0.89779724 -0.52262830 -0.64033172 -0.52640214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-likelihood reduction:  0.00000000032207481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of gradient at current step:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.00000138172839925 -0.00000029541573543  0.00000194942825438  0.00000005064943620 -0.00000001912655101  0.00000005032669892 -0.00000167462238743 -0.00000000020190338 -0.00000000017657165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm will terminate if one of following conditions will be met:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The increase to minus log-likelihood will be bellow chosen value of epsilon 1e-08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum change to the vector of regression parameters will be bellow the chosen value of epsilon.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> At current step the highest change was: 0.0000050277134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of analytically computed hessian at fitted regression coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]       [,2]       [,3]        [,4]      [,5]       [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] -600.647579 -45.430239 -437.78550 -46.3057511 -3.648625 -9.9715730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  -45.430239 -45.430239    0.00000   0.0000000  0.000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -437.785496   0.000000 -437.78550   0.0000000  0.000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  -46.305751   0.000000    0.00000 -46.3057511  0.000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]   -3.648625   0.000000    0.00000   0.0000000 -3.648625  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]   -9.971573   0.000000    0.00000   0.0000000  0.000000 -9.9715730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  -17.976683  -2.320732  -11.24212  -0.6903141 -2.003224 -0.2486649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  328.022454  23.801161  241.35686  24.3769265  1.870670  5.1505625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  280.048801  20.260808  211.90055  19.7419682  1.462128  4.6637718</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,7]        [,8]        [,9]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] -17.9766828  328.022454  280.048801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  -2.3207316   23.801161   20.260808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -11.2421165  241.356859  211.900549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  -0.6903141   24.376927   19.741968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  -2.0032237    1.870670    1.462128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  -0.2486649    5.150563    4.663772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -17.9766828    9.477666    8.492258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]   9.4776658 -197.098079 -168.419176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]   8.4922579 -168.419176 -168.419176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix above has the following eigen values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -3.121074 -6.868861 -9.331036 -16.61098 -18.10422 -33.99724 -45.94396 -112.7247 -1280.581 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pseudoHurdleModel</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimatePopsize.default(formula = capture ~ nation + age, data = netherlandsimmigrant, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     model = Hurdleztgeom, method = "IRLS", controlMethod = controlMethod(verbose = 5), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     controlModel = controlModel(piFormula = ~gender))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pearson Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.428461 -0.428461 -0.288574  0.004918 -0.181672 13.696149 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For linear predictors associated with: lambda </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)           -1.2818     0.1858  -6.899 5.22e-12 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nationAsia            -0.6557     0.1994  -3.289  0.00101 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nationNorth Africa     0.1645     0.1417   1.161  0.24561    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nationRest of Africa  -0.5170     0.1979  -2.612  0.00900 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nationSurinam         -1.2219     0.5552  -2.201  0.02775 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nationTurkey          -0.8978     0.3439  -2.611  0.00903 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age&gt;40yrs             -0.5226     0.2469  -2.117  0.03429 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For linear predictors associated with: pi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value P(&gt;|z|)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  -0.6403     0.2945  -2.174 0.02969 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gendermale   -0.5264     0.2043  -2.577 0.00996 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 1672.037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: 1721.889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance: 1492.301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: -827.0187 on 3751 Degrees of freedom </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of iterations: 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population size estimation results: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Point estimate 6446.833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed proportion: 29.2% (N obs = 1880)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Std. Error 1126.716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% CI for the population size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lowerBound upperBound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> normal      4238.511   8655.156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logNormal   4715.983   9234.051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% CI for the share of observed population:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lowerBound upperBound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> normal      21.72116   44.35520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logNormal   20.35943   39.86443</span>
<span class="r-in"><span><span class="co"># Assessing model fit</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pseudoHurdleModel</span>, <span class="st">"rootogram"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="estimatePopsize-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="marginalFreq.html">marginalFreq</a></span><span class="op">(</span><span class="va">pseudoHurdleModel</span><span class="op">)</span>, <span class="st">"group"</span>, df <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Goodness of fit of a regression model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Test statistics df P(&gt;X^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-squared test            1.89  1    0.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G-test                      2.13  1    0.14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cells with fitted frequencies of &lt; 5 have been grouped </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cells used in calculating test(s) statistic: 1 2 3 4  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A advanced input with additional information for fitting procedure and</span></span></span>
<span class="r-in"><span><span class="co"># additional formula specification and different link for inflation parameter.</span></span></span>
<span class="r-in"><span><span class="va">Model</span> <span class="op">&lt;-</span> <span class="fu">estimatePopsize</span><span class="op">(</span></span></span>
<span class="r-in"><span> formula <span class="op">=</span> <span class="va">TOTAL_SUB</span> <span class="op">~</span> <span class="va">.</span>, </span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="va">farmsubmission</span>, </span></span>
<span class="r-in"><span> model <span class="op">=</span> <span class="fu"><a href="singleRmodels.html">oiztgeom</a></span><span class="op">(</span>omegaLink <span class="op">=</span> <span class="st">"cloglog"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span> method <span class="op">=</span> <span class="st">"IRLS"</span>, </span></span>
<span class="r-in"><span> controlMethod <span class="op">=</span> <span class="fu"><a href="controlMethod.html">controlMethod</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   stepsize <span class="op">=</span> <span class="fl">.85</span>, </span></span>
<span class="r-in"><span>   momentumFactor <span class="op">=</span> <span class="fl">1.2</span>,</span></span>
<span class="r-in"><span>   epsilon <span class="op">=</span> <span class="fl">1e-10</span>, </span></span>
<span class="r-in"><span>   silent <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span> <span class="op">)</span>,</span></span>
<span class="r-in"><span> controlModel <span class="op">=</span> <span class="fu"><a href="controlModel.html">controlModel</a></span><span class="op">(</span>omegaFormula <span class="op">=</span> <span class="op">~</span> <span class="va">C_TYPE</span> <span class="op">+</span> <span class="va">log_size</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="marginalFreq.html">marginalFreq</a></span><span class="op">(</span><span class="va">Model</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">18</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Model</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Goodness of fit of a regression model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Test statistics df P(&gt;X^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-squared test           54.98 11 7.8e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G-test                     23.06 11 1.7e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cells with fitted frequencies of &lt; 5 have been dropped </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cells used in calculating test(s) statistic: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimatePopsize.default(formula = TOTAL_SUB ~ ., data = farmsubmission, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     model = oiztgeom(omegaLink = "cloglog"), method = "IRLS", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     controlMethod = controlMethod(stepsize = 0.85, momentumFactor = 1.2, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         epsilon = 1e-10, silent = TRUE), controlModel = controlModel(omegaFormula = ~C_TYPE + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         log_size))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pearson Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.891103 -0.644972 -0.443066  0.005967  0.295374 20.809832 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For linear predictors associated with: lambda </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  -2.76388    0.23858 -11.585  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_size      0.62734    0.01787  35.110  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_distance -0.07200    0.02004  -3.593 0.000327 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C_TYPEDairy   0.50965    0.04032  12.640  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For linear predictors associated with: omega </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  -5.0973     0.8268  -6.165 7.03e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C_TYPEDairy  -1.4002     0.3700  -3.784 0.000154 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_size      0.4461     0.1330   3.354 0.000795 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 34579.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: 34631.68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance: 12327.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: -17282.96 on 24065 Degrees of freedom </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of iterations: 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population size estimation results: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Point estimate 27249.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed proportion: 44.2% (N obs = 12036)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Std. Error 972.0123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% CI for the population size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lowerBound upperBound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> normal      25343.92   29154.13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logNormal   25460.09   29276.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% CI for the share of observed population:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lowerBound upperBound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> normal      41.28402   47.49069</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logNormal   41.11166   47.27399</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Piotr Chlebicki, Maciej Beręsewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

